['/home/lizhuoqun/SE_type_code', '/home/lizhuoqun/anconda/envs/py38/lib/python38.zip', '/home/lizhuoqun/anconda/envs/py38/lib/python3.8', '/home/lizhuoqun/anconda/envs/py38/lib/python3.8/lib-dynload', '/home/lizhuoqun/anconda/envs/py38/lib/python3.8/site-packages', '/home/lizhuoqun/SE_type_code/data', '/home/lizhuoqun/SE_type_code/tools', '/home/lizhuoqun/SE_type_code/models', '/home/lizhuoqun/SE_type_code/pre_train']
sentence level BiLSTM
paragraph level BiLSTM
Namespace(BATCH_SIZE=128, DROPOUT=0.5, EPOCHs=30, EX_LOSS=0, FREEZE=0, IF_USE_EX_INITIAL_1=0, IF_USE_EX_INITIAL_2=0, LEARN_RATE=0.001, METHOD=1)


time= 1230
use 343 from author
Loading Data...
len(test_X):  981
len(train_X):  3803
AuthorModel


epoch 0/30
Accuracy:  0.6459619503590778
Confusion Metric: 
 [[3037  287   17  201    0    1    1]
 [ 538 1147   21   27    0    0    0]
 [  67  127  128    1    0    0    0]
 [ 701   80    0  792    0    5    0]
 [ 205   61    1   49    0    0    0]
 [ 138    3   35   10    0   21    0]
 [ 111   32   26   56    0    9    2]]
Macro Precision/Recall/F-score:  (0.5431463628214254, 0.36098702584561215, 0.3753044627184606, None)


epoch 1/30
Accuracy:  0.6193775985888875
Confusion Metric: 
 [[2014  163    6 1337    0   12   12]
 [ 369 1077   33  251    0    3    0]
 [  32   52  229    8    0    2    0]
 [ 196   31    0 1340    0    4    7]
 [ 105   42    1  165    0    1    2]
 [  32    0    1   13    0  150   11]
 [  39    8    0   79    0    4  106]]
Macro Precision/Recall/F-score:  (0.6278941951902979, 0.5602421164184742, 0.5734195303373539, None)


epoch 2/30
Accuracy:  0.7181554743605897
Confusion Metric: 
 [[2589  218    3  685    0   18   31]
 [ 319 1265   24  118    0    4    3]
 [  27   45  246    2    0    2    1]
 [ 246   34    0 1281    0    2   15]
 [ 128   58    1  124    0    2    3]
 [  16    0    1    6    0  181    3]
 [  25    6    0   64    0    3  138]]
Macro Precision/Recall/F-score:  (0.6531885645175943, 0.6418596311883193, 0.6424182376751465, None)


epoch 3/30
Accuracy:  0.7378102557641426
Confusion Metric: 
 [[2721  192    5  545    0   19   62]
 [ 323 1275   35   79    0    4   17]
 [  23   36  260    1    0    2    1]
 [ 288   30    0 1230    0    2   28]
 [ 153   54    1   92    0    1   15]
 [  15    0    1    2    0  186    3]
 [  22    3    0   25    0    2  184]]
Macro Precision/Recall/F-score:  (0.6440190986446392, 0.6808754162363976, 0.6590057083644548, None)


epoch 4/30
Accuracy:  0.76401663096888
Confusion Metric: 
 [[3010  197    4  292    0   13   28]
 [ 295 1362   25   41    1    4    5]
 [  24   40  258    0    0    1    0]
 [ 440   46    0 1070    1    3   18]
 [ 182   62    1   65    1    1    4]
 [  15    0    1    1    0  186    4]
 [  36    3    0   19    0    1  177]]
Macro Precision/Recall/F-score:  (0.7333886054376799, 0.6805419386684017, 0.6829370833774607, None)


epoch 5/30
Accuracy:  0.7526773340052917
Confusion Metric: 
 [[2672  209    4  595    6   25   33]
 [ 237 1368   21   94    2    6    5]
 [  27   45  249    0    0    2    0]
 [ 229   35    0 1299    1    4   10]
 [ 123   67    1  111    6    3    5]
 [   5    0    1    1    0  195    5]
 [  17    3    0   30    0    1  185]]
Macro Precision/Recall/F-score:  (0.7284281363583679, 0.6974770419576547, 0.6845046525084237, None)


epoch 6/30
Accuracy:  0.7745999748015623
Confusion Metric: 
 [[2983  189    4  327   12   11   18]
 [ 260 1386   22   47   13    3    2]
 [  26   41  254    0    0    2    0]
 [ 379   40    0 1143    7    1    8]
 [ 153   67    1   66   23    1    5]
 [  20    0    1    2    0  181    3]
 [  31    2    0   25    0    0  178]]
Macro Precision/Recall/F-score:  (0.7640047906166887, 0.693372002655387, 0.7102472906154721, None)


epoch 7/30
Accuracy:  0.7670404434925034
Confusion Metric: 
 [[2791  233    4  471   15   18   12]
 [ 199 1446   10   69    5    4    0]
 [  24   58  238    1    0    2    0]
 [ 273   45    0 1247    4    4    5]
 [ 114   78    1   94   26    1    2]
 [  14    1    0    2    0  188    2]
 [  27    5    0   49    2    1  152]]
Macro Precision/Recall/F-score:  (0.7732294451782403, 0.6833658857446603, 0.7012282150893064, None)


epoch 8/30
Accuracy:  0.7709462013355172
Confusion Metric: 
 [[2805  203    4  465   23   18   26]
 [ 214 1370   24   98   20    4    3]
 [  22   39  258    1    1    2    0]
 [ 265   25    0 1269    9    4    6]
 [ 122   58    1   90   39    1    5]
 [   6    1    0    1    0  195    4]
 [  21    3    0   29    0    0  183]]
Macro Precision/Recall/F-score:  (0.7525091411078872, 0.7179756788884594, 0.7215907409265603, None)


epoch 9/30
Accuracy:  0.7715761622779388
Confusion Metric: 
 [[2733  209    8  526   25   17   26]
 [ 190 1402   24   88   21    4    4]
 [  20   36  263    2    0    2    0]
 [ 224   27    0 1307   13    4    3]
 [ 111   61    1   91   46    1    5]
 [   6    1    0    2    0  195    3]
 [  16    3    0   39    0    0  178]]
Macro Precision/Recall/F-score:  (0.7548908025638376, 0.7235007520177895, 0.7262077587962986, None)


epoch 10/30
Accuracy:  0.7856872873881819
Confusion Metric: 
 [[2896  201    4  382   21   15   25]
 [ 207 1418   21   63   17    4    3]
 [  22   40  258    1    0    2    0]
 [ 295   30    0 1232   10    4    7]
 [ 130   57    2   78   43    1    5]
 [   6    1    0    0    0  197    3]
 [  20    2    0   22    0    0  192]]
Macro Precision/Recall/F-score:  (0.7702465377813253, 0.7308875489036285, 0.7362452987991333, None)


epoch 11/30
Accuracy:  0.7927428499433035
Confusion Metric: 
 [[3000  249    3  220   36   16   20]
 [ 164 1494   14   35   20    4    2]
 [  19   45  256    1    0    2    0]
 [ 403   59    0 1080   22    4   10]
 [ 120   68    2   50   71    1    4]
 [   7    1    0    0    0  196    3]
 [  26    5    0   10    0    0  195]]
Macro Precision/Recall/F-score:  (0.7819126763799943, 0.7404835616953969, 0.7529776643137229, None)


epoch 12/30
Accuracy:  0.7666624669270505
Confusion Metric: 
 [[2635  176    5  656   33   18   21]
 [ 189 1397   16  103   20    4    4]
 [  22   41  256    2    0    2    0]
 [ 171   27    0 1365    7    4    4]
 [  99   53    2  110   48    1    3]
 [   5    1    0    1    0  197    3]
 [  12    2    0   35    0    0  187]]
Macro Precision/Recall/F-score:  (0.7630125060974596, 0.729025403789913, 0.7309118322016402, None)


epoch 13/30
Accuracy:  0.7945067405820839
Confusion Metric: 
 [[3003  239    7  208   55   10   22]
 [ 165 1488   20   26   26    4    4]
 [  17   42  262    0    0    2    0]
 [ 393   59    0 1085   33    4    4]
 [ 115   62    3   44   88    1    3]
 [  18    1    0    1    0  184    3]
 [  25    4    0   10    1    0  196]]
Macro Precision/Recall/F-score:  (0.7788338163907201, 0.7432253414177435, 0.7574769188351809, None)


epoch 14/30
Accuracy:  0.7963966234093486
Confusion Metric: 
 [[2933  245    5  285   32   17   27]
 [ 152 1489   18   44   21    4    5]
 [  17   43  261    0    0    2    0]
 [ 327   40    0 1182   16    4    9]
 [ 125   66    2   63   56    1    3]
 [   4    1    0    0    0  199    3]
 [  19    4    0   12    0    0  201]]
Macro Precision/Recall/F-score:  (0.7716600719354788, 0.7477373367437808, 0.7502973237759145, None)


epoch 15/30
Accuracy:  0.7936247952626937
Confusion Metric: 
 [[2977  226    7  224   63   20   27]
 [ 166 1471   16   32   39    4    5]
 [  16   42  263    0    0    2    0]
 [ 392   45    0 1090   39    4    8]
 [ 110   54    2   48   98    1    3]
 [   4    1    0    0    0  199    3]
 [  28    3    0    4    0    0  201]]
Macro Precision/Recall/F-score:  (0.7695160428951638, 0.7595702556425205, 0.7621815393609033, None)


epoch 16/30
Accuracy:  0.7982865062366133
Confusion Metric: 
 [[2963  201    7  276   33   14   50]
 [ 191 1434   25   47   22    4   10]
 [  17   33  271    0    0    2    0]
 [ 328   30    0 1190   17    4    9]
 [ 122   57    2   58   67    1    9]
 [   4    1    0    0    0  199    3]
 [  14    3    0    7    0    0  212]]
Macro Precision/Recall/F-score:  (0.7665815816232383, 0.7611913218436027, 0.7547053488435302, None)


epoch 17/30
Accuracy:  0.7884591155348368
Confusion Metric: 
 [[2842  208    3  370   59   14   48]
 [ 173 1404   24   70   44    4   14]
 [  19   40  262    0    0    2    0]
 [ 261   25    0 1256   22    4   10]
 [ 105   51    1   67   86    1    5]
 [   4    1    0    1    0  198    3]
 [  16    1    0    9    0    0  210]]
Macro Precision/Recall/F-score:  (0.7534314575660833, 0.7625240607807846, 0.7538970903041893, None)


epoch 18/30
Accuracy:  0.7942547562051153
Confusion Metric: 
 [[2815  281    7  337   76    8   20]
 [ 123 1524   14   36   28    4    4]
 [  13   51  257    0    0    2    0]
 [ 262   52    0 1228   28    3    5]
 [  90   63    1   66   93    1    2]
 [   6    1    0    1    0  196    3]
 [  22    5    0   15    3    0  191]]
Macro Precision/Recall/F-score:  (0.7770606251598834, 0.7568645333193534, 0.7641568283904733, None)


epoch 19/30
Accuracy:  0.7948847171475368
Confusion Metric: 
 [[2848  211    4  389   54    9   29]
 [ 160 1450   20   63   30    4    6]
 [  17   43  260    1    0    2    0]
 [ 241   29    0 1282   16    3    7]
 [ 103   60    1   77   71    1    3]
 [  11    1    0    1    0  191    3]
 [  17    3    0    9    0    0  207]]
Macro Precision/Recall/F-score:  (0.7710976414184056, 0.7545989931384461, 0.7574810039300469, None)


epoch 20/30
Accuracy:  0.7996724203099408
Confusion Metric: 
 [[3041  191    5  202   47    8   50]
 [ 189 1419   34   48   27    4   12]
 [  16   27  278    0    0    2    0]
 [ 380   30    1 1129   23    4   11]
 [ 122   54    2   56   77    1    4]
 [  12    1    0    1    0  190    3]
 [  14    2    0    7    0    0  213]]
Macro Precision/Recall/F-score:  (0.7655131565609148, 0.759587523976778, 0.7567451463959439, None)


epoch 21/30
Accuracy:  0.7975305531057074
Confusion Metric: 
 [[2957  234    4  237   73    8   31]
 [ 154 1482   21   30   39    3    4]
 [  15   40  265    1    0    2    0]
 [ 348   52    0 1136   30    3    9]
 [ 104   52    2   61   94    1    2]
 [  12    1    0    1    0  190    3]
 [  20    4    0    6    0    0  206]]
Macro Precision/Recall/F-score:  (0.7738639483226216, 0.7597269356267538, 0.7649608593984739, None)


epoch 22/30
Accuracy:  0.7997984124984251
Confusion Metric: 
 [[2885  213    3  337   66    8   32]
 [ 152 1458   23   53   36    4    7]
 [  14   41  265    1    0    2    0]
 [ 270   35    0 1243   18    4    8]
 [  96   55    1   66   93    1    4]
 [   9    0    0    1    0  194    3]
 [  15    2    0    8    1    0  210]]
Macro Precision/Recall/F-score:  (0.7746164757565518, 0.7692627604820397, 0.7690482285648403, None)


epoch 23/30
Accuracy:  0.7918609046239133
Confusion Metric: 
 [[2855  200    3  351   68    9   58]
 [ 171 1415   32   52   44    4   15]
 [  15   31  274    1    0    2    0]
 [ 255   35    0 1246   25    4   13]
 [ 109   50    2   65   85    1    4]
 [   8    0    0    1    0  195    3]
 [  13    2    0    6    0    0  215]]
Macro Precision/Recall/F-score:  (0.748907750974367, 0.7688610955403682, 0.755118596416214, None)


epoch 24/30
Accuracy:  0.8000503968753937
Confusion Metric: 
 [[2988  184    3  312   21    8   28]
 [ 201 1421   27   57   15    4    8]
 [  20   34  266    1    0    2    0]
 [ 306   28    0 1228    7    3    6]
 [ 128   55    1   77   51    1    3]
 [   9    0    0    1    0  194    3]
 [  23    2    0    9    0    0  202]]
Macro Precision/Recall/F-score:  (0.7896229962413123, 0.7456189776352715, 0.7523903141377742, None)


epoch 25/30
Accuracy:  0.7850573264457603
Confusion Metric: 
 [[2747  200    3  494   55    8   37]
 [ 170 1396   27   74   51    3   12]
 [  14   37  268    1    1    2    0]
 [ 201   25    0 1327   13    3    9]
 [  95   47    1   81   87    1    4]
 [   8    0    0    1    0  195    3]
 [  17    2    0    6    0    0  211]]
Macro Precision/Recall/F-score:  (0.7617551107030031, 0.7661035556804193, 0.7592243301511453, None)


epoch 26/30
Accuracy:  0.7926168577548192
Confusion Metric: 
 [[2841  184    4  409   35    9   62]
 [ 181 1415   32   58   29    4   14]
 [  14   34  272    1    0    2    0]
 [ 240   26    0 1288    7    3   14]
 [ 110   54    1   75   68    1    7]
 [   7    0    0    1    0  196    3]
 [  13    3    0    9    0    0  211]]
Macro Precision/Recall/F-score:  (0.7596971633222405, 0.7617979494681532, 0.7502242389967203, None)


epoch 27/30
Accuracy:  0.7996724203099408
Confusion Metric: 
 [[2908  270    3  273   27   10   53]
 [ 135 1519   21   31   11    4   12]
 [  12   40  268    1    0    2    0]
 [ 305   57    0 1188    9    4   15]
 [ 107   76    1   68   57    1    6]
 [   5    1    0    1    0  197    3]
 [  17    2    0    7    0    0  210]]
Macro Precision/Recall/F-score:  (0.7760626222381033, 0.7573615178446103, 0.7510217904092205, None)


epoch 28/30
Accuracy:  0.8030742093990173
Confusion Metric: 
 [[2966  228    4  260   46    9   31]
 [ 153 1486   26   29   32    3    4]
 [  10   39  271    1    0    2    0]
 [ 322   54    0 1172   21    2    7]
 [ 102   66    1   57   85    1    4]
 [  11    0    1    1    0  191    3]
 [  20    3    0    8    2    0  203]]
Macro Precision/Recall/F-score:  (0.780271002553276, 0.7611376813384031, 0.7667550645443818, None)


epoch 29/30
Accuracy:  0.8028222250220486
Confusion Metric: 
 [[2928  217    3  320   34    8   34]
 [ 178 1461   21   45   19    4    5]
 [  13   38  270    0    0    2    0]
 [ 275   39    0 1242   11    3    8]
 [ 121   56    1   64   70    1    3]
 [   8    0    0    1    0  195    3]
 [  18    3    0    9    0    0  206]]
Macro Precision/Recall/F-score:  (0.7885193516348087, 0.7612352465940726, 0.7654741231148966, None)

best_epoch:  22 0.7690482285648403 0.7997984124984251


time= 1231
use 343 from author
Loading Data...
len(test_X):  981
len(train_X):  3803
AuthorModel


epoch 0/30
Accuracy:  0.6402923018772836
Confusion Metric: 
 [[2977  339   14  191    0   23    0]
 [ 434 1229   23   42    0    5    0]
 [  51  133  139    0    0    0    0]
 [ 841   80    0  646    0    9    2]
 [ 187   66    1   55    0    7    0]
 [  97    4   13    7    0   86    0]
 [ 105   29   16   48    0   33    5]]
Macro Precision/Recall/F-score:  (0.5511490037029861, 0.4036501462655268, 0.41972757821576373, None)


epoch 1/30
Accuracy:  0.7152576540254504
Confusion Metric: 
 [[2900  300    4  263    0   16   61]
 [ 308 1322   25   54    0    5   19]
 [  26   52  241    0    0    1    3]
 [ 570   88    0  886    0    2   32]
 [ 168   67    1   59    0    1   20]
 [  24    0    1    0    0  174    8]
 [  47    9    0   26    0    0  154]]
Macro Precision/Recall/F-score:  (0.6290510279074669, 0.6259779659041887, 0.6240351082709622, None)


epoch 2/30
Accuracy:  0.739952122968376
Confusion Metric: 
 [[2865  241    2  379    0   17   40]
 [ 322 1292   30   74    0    5   10]
 [  25   46  249    0    0    1    2]
 [ 402   37    0 1113    0    2   24]
 [ 177   60    1   65    0    2   11]
 [  20    0    1    2    0  179    5]
 [  29    4    0   27    0    1  175]]
Macro Precision/Recall/F-score:  (0.6550924235899533, 0.6623453305726708, 0.657558610894356, None)


epoch 3/30
Accuracy:  0.7495275292931838
Confusion Metric: 
 [[2977  298    8  214    0   18   29]
 [ 245 1388   49   41    0    4    6]
 [  18   37  267    0    0    1    0]
 [ 547   55    1  960    0    2   13]
 [ 177   81    1   48    0    2    7]
 [  21    0    1    0    0  183    2]
 [  38    6    1   16    0    1  174]]
Macro Precision/Recall/F-score:  (0.6670552958328422, 0.6710387219671076, 0.6673525038425835, None)


epoch 4/30
Accuracy:  0.7587249590525388
Confusion Metric: 
 [[2948  260    2  286    0   18   30]
 [ 255 1392   24   50    1    3    8]
 [  26   43  253    0    0    1    0]
 [ 456   42    0 1056    2    2   20]
 [ 178   65    1   60    1    1   10]
 [  18    0    1    0    0  185    3]
 [  33    3    0   13    0    0  187]]
Macro Precision/Recall/F-score:  (0.7144740523602895, 0.6824000475471275, 0.6799815961146399, None)


epoch 5/30
Accuracy:  0.7650245684767545
Confusion Metric: 
 [[2974  276    8  237    6   19   24]
 [ 220 1432   29   41    4    4    3]
 [  21   36  265    0    0    1    0]
 [ 494   54    0 1012    3    2   13]
 [ 166   78    1   53   12    1    5]
 [  13    0    1    0    0  190    3]
 [  32    3    0   14    0    0  187]]
Macro Precision/Recall/F-score:  (0.7556535613252657, 0.6964930085401871, 0.6979100489075866, None)


epoch 6/30
Accuracy:  0.7688043341312839
Confusion Metric: 
 [[2999  255    4  230   20   18   18]
 [ 220 1417   19   53   20    4    0]
 [  19   46  256    0    0    2    0]
 [ 488   40    0 1024   11    2   13]
 [ 161   67    1   48   34    1    4]
 [  13    1    0    0    0  191    2]
 [  35    4    0   16    0    0  181]]
Macro Precision/Recall/F-score:  (0.757722776307963, 0.7003739932930954, 0.7152418607651393, None)


epoch 7/30
Accuracy:  0.7724581075973289
Confusion Metric: 
 [[3014  228    5  244   14   17   22]
 [ 237 1397   22   47   19    4    7]
 [  19   39  262    1    0    2    0]
 [ 476   34    0 1050    8    2    8]
 [ 165   56    1   56   33    1    4]
 [  14    1    0    0    0  188    4]
 [  29    3    0   17    0    0  187]]
Macro Precision/Recall/F-score:  (0.7618431317006319, 0.7054469428592279, 0.7174612455959192, None)


epoch 8/30
Accuracy:  0.7782537482676074
Confusion Metric: 
 [[3001  221    5  248   24   19   26]
 [ 226 1419   19   42   18    4    5]
 [  18   46  257    0    0    2    0]
 [ 442   43    0 1062   14    3   14]
 [ 150   59    1   51   49    1    5]
 [  10    1    0    0    0  193    3]
 [  23    3    0   14    0    0  196]]
Macro Precision/Recall/F-score:  (0.7644725336959093, 0.7217432797155142, 0.7306025786523984, None)


epoch 9/30
Accuracy:  0.7814035529797153
Confusion Metric: 
 [[3066  225    4  172   42   11   24]
 [ 213 1417   26   38   29    4    6]
 [  18   39  264    1    0    1    0]
 [ 509   33    0  994   30    3    9]
 [ 138   55    1   39   77    1    5]
 [  12    1    0    0    0  191    3]
 [  26    3    0   10    4    0  193]]
Macro Precision/Recall/F-score:  (0.7698872586679555, 0.7306004209904203, 0.7447838962136293, None)


epoch 10/30
Accuracy:  0.7883331233463525
Confusion Metric: 
 [[2994  251    4  216   43   16   20]
 [ 186 1453   21   38   26    4    5]
 [  17   40  262    2    0    2    0]
 [ 424   39    0 1081   24    3    7]
 [ 127   54    2   45   82    1    5]
 [  11    1    0    0    0  192    3]
 [  26    3    0   13    1    0  193]]
Macro Precision/Recall/F-score:  (0.7766737362082734, 0.7406078539333218, 0.7533477143784876, None)


epoch 11/30
Accuracy:  0.7885851077233211
Confusion Metric: 
 [[2972  281    4  210   42   14   21]
 [ 165 1487   19   38   17    4    3]
 [  17   41  262    1    0    2    0]
 [ 416   51    0 1080   22    3    6]
 [ 118   65    2   55   71    1    4]
 [  11    1    0    0    0  192    3]
 [  25    3    0    9    4    0  195]]
Macro Precision/Recall/F-score:  (0.7773805352817186, 0.7386710280353456, 0.7511403788881915, None)


epoch 12/30
Accuracy:  0.7895930452311957
Confusion Metric: 
 [[2971  270    3  188   70   19   23]
 [ 152 1483   21   33   33    4    7]
 [  13   42  265    1    0    2    0]
 [ 425   50    0 1058   34    4    7]
 [ 108   58    2   45   98    1    4]
 [   8    0    0    0    0  196    3]
 [  26    3    0    8    3    0  196]]
Macro Precision/Recall/F-score:  (0.7686330073619446, 0.7532081597109437, 0.758243789709031, None)


epoch 13/30
Accuracy:  0.78971903741968
Confusion Metric: 
 [[3006  240    4  226   35   16   17]
 [ 185 1458   24   40   18    4    4]
 [  17   37  266    1    0    2    0]
 [ 414   44    0 1096   15    3    6]
 [ 127   62    2   57   63    1    4]
 [  12    0    0    1    0  191    3]
 [  29    2    0   16    1    0  188]]
Macro Precision/Recall/F-score:  (0.7785562758351782, 0.7323245451132816, 0.7464023188992103, None)


epoch 14/30
Accuracy:  0.791356935869976
Confusion Metric: 
 [[3030  282    4  175   33    8   12]
 [ 159 1506   22   29   12    3    2]
 [  14   43  264    0    0    2    0]
 [ 465   45    0 1048   14    3    3]
 [ 133   68    2   42   68    1    2]
 [  17    1    0    1    0  185    3]
 [  41    3    0   12    0    0  180]]
Macro Precision/Recall/F-score:  (0.8009411060539682, 0.7252957471495386, 0.7507795779304925, None)


epoch 15/30
Accuracy:  0.7969005921632859
Confusion Metric: 
 [[3065  227    5  175   45    9   18]
 [ 199 1440   27   35   25    4    3]
 [  14   34  272    1    0    2    0]
 [ 432   30    0 1086   23    3    4]
 [ 129   53    2   45   84    1    2]
 [  10    1    0    1    0  192    3]
 [  39    3    0    7    1    0  186]]
Macro Precision/Recall/F-score:  (0.7899999051747619, 0.7439405445853599, 0.7615970462051276, None)


epoch 16/30
Accuracy:  0.7933728108857251
Confusion Metric: 
 [[2986  262    8  170   74   15   29]
 [ 158 1461   29   32   41    4    8]
 [  12   32  277    0    0    2    0]
 [ 427   41    1 1065   35    3    6]
 [ 107   52    2   39  113    1    2]
 [   9    1    0    1    0  193    3]
 [  22    2    0    8    2    0  202]]
Macro Precision/Recall/F-score:  (0.7707449563677615, 0.7662831288524538, 0.7668134342804752, None)


epoch 17/30
Accuracy:  0.7956406702784428
Confusion Metric: 
 [[2994  278    4  190   48   16   14]
 [ 150 1512   17   24   24    4    2]
 [  17   40  263    1    0    2    0]
 [ 415   56    0 1071   30    3    3]
 [ 109   68    1   44   93    1    0]
 [   9    0    0    0    0  195    3]
 [  32    3    0    9    5    0  187]]
Macro Precision/Recall/F-score:  (0.7915573211764011, 0.7484197110283096, 0.7649640331515984, None)


epoch 18/30
Accuracy:  0.7975305531057074
Confusion Metric: 
 [[3062  226    4  162   53   12   25]
 [ 199 1451   19   26   25    4    9]
 [  20   37  264    0    0    2    0]
 [ 437   41    0 1062   30    3    5]
 [ 118   56    2   38   99    1    2]
 [   8    1    0    0    0  195    3]
 [  26    2    0    8    3    0  197]]
Macro Precision/Recall/F-score:  (0.7873595628107781, 0.7545255765251669, 0.766882684487501, None)


epoch 19/30
Accuracy:  0.7855612951996976
Confusion Metric: 
 [[2950  232    5  271   45   12   29]
 [ 177 1460   15   54   18    4    5]
 [  19   38  261    2    0    2    1]
 [ 402   51    0 1095   19    3    8]
 [ 109   65    1   58   77    1    5]
 [   9    1    0    0    0  193    4]
 [  25    2    0   10    0    0  199]]
Macro Precision/Recall/F-score:  (0.7748669262606416, 0.7422981060667706, 0.7519211822007345, None)


epoch 20/30
Accuracy:  0.8013103187602368
Confusion Metric: 
 [[3078  197    4  210   31   14   10]
 [ 207 1436   19   43   21    4    3]
 [  18   35  267    1    0    2    0]
 [ 403   28    0 1126   15    3    3]
 [ 132   48    1   56   76    1    2]
 [   7    0    0    0    0  197    3]
 [  42    2    0   11    0    1  180]]
Macro Precision/Recall/F-score:  (0.803483921188546, 0.7417467026621546, 0.7630691333489656, None)


epoch 21/30
Accuracy:  0.7966486077863173
Confusion Metric: 
 [[2936  226    3  305   47   14   13]
 [ 170 1469   16   46   25    4    3]
 [  17   41  262    1    0    2    0]
 [ 328   34    0 1192   17    3    4]
 [ 108   53    2   65   85    1    2]
 [  10    1    0    1    0  192    3]
 [  31    1    0   15    1    1  187]]
Macro Precision/Recall/F-score:  (0.7903432801553393, 0.7473619973087883, 0.7633422798808994, None)


epoch 22/30
Accuracy:  0.7991684515560036
Confusion Metric: 
 [[2944  244    4  273   40   11   28]
 [ 156 1484   23   38   21    6    5]
 [  11   35  274    1    0    2    0]
 [ 343   36    0 1175   15    3    6]
 [ 117   59    2   56   78    1    3]
 [  11    1    0    1    0  191    3]
 [  24    2    0   12    1    0  197]]
Macro Precision/Recall/F-score:  (0.7832954855870026, 0.7548879235955007, 0.7624855043425613, None)


epoch 23/30
Accuracy:  0.8033261937759859
Confusion Metric: 
 [[2964  224    5  240   76   13   22]
 [ 157 1476   15   35   40    5    5]
 [  11   42  267    1    0    1    1]
 [ 343   36    0 1167   24    3    5]
 [ 104   49    1   50  110    1    1]
 [   5    0    0    1    0  198    3]
 [  25    3    1   10    3    0  194]]
Macro Precision/Recall/F-score:  (0.7854544062817486, 0.7686959117211256, 0.7756885644301602, None)


epoch 24/30
Accuracy:  0.8011843265717525
Confusion Metric: 
 [[3007  228    3  217   53   17   19]
 [ 152 1473   22   40   36    4    6]
 [  10   35  275    1    0    2    0]
 [ 392   26    0 1127   25    3    5]
 [ 117   53    2   51   90    1    2]
 [   4    0    0    1    0  199    3]
 [  33    2    0   10    3    0  188]]
Macro Precision/Recall/F-score:  (0.7811299914339852, 0.7581155388537434, 0.7665686941402786, None)


epoch 25/30
Accuracy:  0.8035781781529545
Confusion Metric: 
 [[2986  219    3  256   35   12   33]
 [ 182 1463   21   38   15    5    9]
 [  13   31  278    0    0    1    0]
 [ 348   31    0 1175   14    3    7]
 [ 117   58    2   58   78    1    2]
 [   8    0    0    1    0  195    3]
 [  25    1    0    6    0    1  203]]
Macro Precision/Recall/F-score:  (0.7910254935996008, 0.7630114381806593, 0.7682833611492356, None)


epoch 26/30
Accuracy:  0.8024442484565957
Confusion Metric: 
 [[3000  222    2  229   51   10   30]
 [ 164 1474   19   36   28    5    7]
 [  12   35  273    1    0    2    0]
 [ 375   28    0 1143   22    3    7]
 [ 112   56    1   61   83    1    2]
 [   9    0    0    1    0  194    3]
 [  20    2    0   11    0    1  202]]
Macro Precision/Recall/F-score:  (0.7820699689179876, 0.7603390927188943, 0.7669986246342113, None)


epoch 27/30
Accuracy:  0.8068539750535467
Confusion Metric: 
 [[3014  194    3  270   40    9   14]
 [ 185 1446   20   44   30    4    4]
 [  11   33  276    1    0    2    0]
 [ 331   31    0 1196   14    4    2]
 [ 111   56    1   64   81    1    2]
 [   7    0    0    1    0  196    3]
 [  25    2    0   14    0    0  195]]
Macro Precision/Recall/F-score:  (0.7993817428637602, 0.7609590691003678, 0.7744725775091635, None)


epoch 28/30
Accuracy:  0.8052160766032506
Confusion Metric: 
 [[3011  187    2  280   35   11   18]
 [ 187 1435   16   57   25    7    6]
 [  13   34  273    1    0    2    0]
 [ 326   27    0 1210    7    3    5]
 [ 109   55    1   74   74    1    2]
 [   8    0    0    1    0  195    3]
 [  26    2    0   13    1    1  193]]
Macro Precision/Recall/F-score:  (0.7964528764952563, 0.7548066113375772, 0.7672760188720342, None)


epoch 29/30
Accuracy:  0.8014363109487211
Confusion Metric: 
 [[2941  215    3  285   70    9   21]
 [ 155 1452   16   50   50    6    4]
 [  11   42  265    1    2    1    1]
 [ 301   31    0 1212   26    3    5]
 [  97   50    2   57  108    1    1]
 [   8    0    0    1    0  195    3]
 [  32    2    0   12    1    1  188]]
Macro Precision/Recall/F-score:  (0.7830848519103414, 0.7623731837745972, 0.7714877834513522, None)

best_epoch:  23 0.7756885644301602 0.8033261937759859


time= 1232
use 343 from author
Loading Data...
len(test_X):  981
len(train_X):  3803
AuthorModel


epoch 0/30
Accuracy:  0.6479778253748267
Confusion Metric: 
 [[2508  390   21  607    0   15    3]
 [ 388 1250   15   77    0    3    0]
 [  48  154  115    5    0    1    0]
 [ 336   61    0 1166    0   13    2]
 [ 141   77    4   93    0    1    0]
 [  78    1   23   16    0   89    0]
 [  46   33   29   89    0   24   15]]
Macro Precision/Recall/F-score:  (0.5466254293077035, 0.43106081100851756, 0.44015426102776617, None)


epoch 1/30
Accuracy:  0.7153836462139347
Confusion Metric: 
 [[2670  321    6  488    0   12   47]
 [ 314 1330   22   60    0    3    4]
 [  33   77  212    0    0    1    0]
 [ 337   48    0 1172    0    2   19]
 [ 142   77    3   85    0    1    8]
 [  25    0    1    8    0  170    3]
 [  29   10    2   71    0    0  124]]
Macro Precision/Recall/F-score:  (0.6363190328149473, 0.6095114421580264, 0.6193765666519528, None)


epoch 2/30
Accuracy:  0.7433539120574525
Confusion Metric: 
 [[2944  248    3  298    0   16   35]
 [ 355 1316   20   37    0    3    2]
 [  29   49  244    0    0    1    0]
 [ 461   44    0 1045    0    2   26]
 [ 170   79    1   60    0    1    5]
 [  20    0    1    1    0  183    2]
 [  36    8    0   22    0    2  168]]
Macro Precision/Recall/F-score:  (0.6706966319794875, 0.657663940526376, 0.6626143048615907, None)


epoch 3/30
Accuracy:  0.7582209902986015
Confusion Metric: 
 [[2886  264    3  341    0   10   40]
 [ 274 1391   18   43    0    3    4]
 [  27   50  245    0    0    1    0]
 [ 371   49    0 1130    1    2   25]
 [ 158   85    1   62    1    1    8]
 [  19    0    1    2    0  181    4]
 [  26    6    0   20    0    0  184]]
Macro Precision/Recall/F-score:  (0.750153243890303, 0.6784029154160839, 0.6775729438023713, None)


epoch 4/30
Accuracy:  0.7630086934610054
Confusion Metric: 
 [[2990  235    3  270    7   12   27]
 [ 287 1385   20   28    4    3    6]
 [  26   48  248    0    0    1    0]
 [ 441   52    0 1060    1    2   22]
 [ 166   83    1   54    5    1    6]
 [  18    0    1    2    0  183    3]
 [  27    4    0   19    0    1  185]]
Macro Precision/Recall/F-score:  (0.7298811418707022, 0.6808841291755998, 0.6859749822589986, None)


epoch 5/30
Accuracy:  0.7715761622779388
Confusion Metric: 
 [[2942  247    4  296   18   13   24]
 [ 229 1430   19   36   11    3    5]
 [  25   46  251    0    0    1    0]
 [ 395   51    0 1096   10    4   22]
 [ 146   82    1   54   28    1    4]
 [  14    1    0    1    0  187    4]
 [  25    6    0   15    0    0  190]]
Macro Precision/Recall/F-score:  (0.7523970700462377, 0.7034297077725075, 0.7114270944950251, None)


epoch 6/30
Accuracy:  0.7810255764142623
Confusion Metric: 
 [[2988  232    5  251   38   11   19]
 [ 216 1445   14   35   17    3    3]
 [  23   45  253    0    0    2    0]
 [ 409   51    0 1086   19    3   10]
 [ 139   71    1   48   52    1    4]
 [  13    1    0    1    0  188    4]
 [  29    3    0   16    1    0  187]]
Macro Precision/Recall/F-score:  (0.7691863868675658, 0.7162237692087875, 0.7338338727986219, None)


epoch 7/30
Accuracy:  0.7796396623409348
Confusion Metric: 
 [[2953  234    5  302   25    7   18]
 [ 206 1441   23   40   16    3    4]
 [  18   51  252    1    0    1    0]
 [ 373   47    0 1136   13    2    7]
 [ 141   69    1   56   44    1    4]
 [  23    1    0    2    0  178    3]
 [  27    4    0   21    0    0  184]]
Macro Precision/Recall/F-score:  (0.7725584076027431, 0.706233515110674, 0.7266386076854744, None)


epoch 8/30
Accuracy:  0.7851833186342447
Confusion Metric: 
 [[3039  215    3  235   22   11   19]
 [ 223 1444   17   30   11    4    4]
 [  24   43  254    0    0    2    0]
 [ 434   49    0 1068   15    4    8]
 [ 145   74    1   49   43    1    3]
 [  13    1    0    1    0  188    4]
 [  24    5    0   11    0    0  196]]
Macro Precision/Recall/F-score:  (0.7803744039291668, 0.7183890830416725, 0.7345474804156902, None)


epoch 9/30
Accuracy:  0.7835454201839486
Confusion Metric: 
 [[2886  220    4  384   15   10   25]
 [ 190 1454   24   52    6    3    4]
 [  19   44  258    0    0    2    0]
 [ 307   43    0 1210    7    3    8]
 [ 127   79    1   71   35    1    2]
 [  16    1    0    2    0  184    4]
 [  20    3    0   21    0    0  192]]
Macro Precision/Recall/F-score:  (0.7816254566311205, 0.7188720444430172, 0.7282430210807094, None)


epoch 10/30
Accuracy:  0.7922388811893663
Confusion Metric: 
 [[2979  203    4  310   18   10   20]
 [ 204 1454   21   41    6    4    3]
 [  22   45  254    0    0    2    0]
 [ 332   50    0 1173   10    4    9]
 [ 138   73    1   59   42    1    2]
 [  15    1    0    1    0  187    3]
 [  19    5    0   13    0    0  199]]
Macro Precision/Recall/F-score:  (0.7905454946543892, 0.7269743160990231, 0.7396361780125061, None)


epoch 11/30
Accuracy:  0.7951367015245054
Confusion Metric: 
 [[3037  215    4  227   27   11   23]
 [ 209 1452   22   30   11    4    5]
 [  22   44  255    0    0    2    0]
 [ 385   51    0 1112   15    4   11]
 [ 137   67    1   47   61    1    2]
 [  12    1    0    1    0  190    3]
 [  21    3    0    8    0    0  204]]
Macro Precision/Recall/F-score:  (0.7892924719913648, 0.7377538653789829, 0.7508615326769139, None)


epoch 12/30
Accuracy:  0.7927428499433035
Confusion Metric: 
 [[3015  200    2  282   18    6   21]
 [ 224 1449   17   32    4    3    4]
 [  23   52  246    0    0    2    0]
 [ 357   43    0 1156    8    3   11]
 [ 139   74    1   58   41    1    2]
 [  15    1    0    1    0  187    3]
 [  24    2    0   12    0    0  198]]
Macro Precision/Recall/F-score:  (0.7994854400020645, 0.7218786112159913, 0.7390580689428433, None)


epoch 13/30
Accuracy:  0.7850573264457603
Confusion Metric: 
 [[2944  196    3  350   17   13   21]
 [ 212 1428   23   43   16    4    7]
 [  21   45  255    0    0    2    0]
 [ 346   43    0 1172    5    4    8]
 [ 123   60    1   78   48    1    5]
 [  14    1    0    0    0  189    3]
 [  17    4    1   19    0    0  195]]
Macro Precision/Recall/F-score:  (0.7816931287249597, 0.7254433953815868, 0.7362820418705428, None)


epoch 14/30
Accuracy:  0.7916089202469447
Confusion Metric: 
 [[3001  200    3  291   18   11   20]
 [ 238 1422   23   32    9    4    5]
 [  21   44  256    0    0    2    0]
 [ 349   44    0 1168    8    4    5]
 [ 138   68    1   58   48    1    2]
 [  12    1    0    1    0  190    3]
 [  22    2    0   14    0    0  198]]
Macro Precision/Recall/F-score:  (0.7954078575620205, 0.7298327125876062, 0.7441360234967037, None)


epoch 15/30
Accuracy:  0.7877031624039309
Confusion Metric: 
 [[2889  241    4  360   17    7   26]
 [ 191 1462   21   41    9    3    6]
 [  20   45  256    0    0    2    0]
 [ 306   43    0 1210    6    2   11]
 [ 120   74    1   71   46    1    3]
 [  14    1    0    1    0  188    3]
 [  17    3    1   14    0    0  201]]
Macro Precision/Recall/F-score:  (0.7902723383946505, 0.7319492179179521, 0.7410016342739226, None)


epoch 16/30
Accuracy:  0.7966486077863173
Confusion Metric: 
 [[3000  180    7  287   36    8   26]
 [ 217 1399   25   51   29    4    8]
 [  14   42  264    1    0    2    0]
 [ 325   32    0 1192   17    2   10]
 [ 120   59    2   54   78    1    2]
 [  16    1    0    0    0  187    3]
 [  21    2    1    9    0    0  203]]
Macro Precision/Recall/F-score:  (0.7805978660814278, 0.7481260516119376, 0.7583425304245522, None)


epoch 17/30
Accuracy:  0.7965226155978329
Confusion Metric: 
 [[3016  188    5  267   44    9   15]
 [ 223 1395   25   45   37    3    5]
 [  18   39  264    0    0    2    0]
 [ 343   33    0 1179   14    2    7]
 [ 116   55    2   55   85    1    2]
 [  14    1    1    0    0  188    3]
 [  23    0    1   15    2    0  195]]
Macro Precision/Recall/F-score:  (0.7861806484289335, 0.7462764475734962, 0.7620716061895256, None)


epoch 18/30
Accuracy:  0.8024442484565957
Confusion Metric: 
 [[3016  237    8  220   34    7   22]
 [ 169 1467   36   25   22    2   12]
 [  16   35  271    0    0    1    0]
 [ 354   56    0 1146   15    2    5]
 [ 114   63    2   51   82    1    3]
 [  15    1    1    1    0  186    3]
 [  21    4    1    9    0    0  201]]
Macro Precision/Recall/F-score:  (0.7897078471630598, 0.7532155836472368, 0.764093566494992, None)


epoch 19/30
Accuracy:  0.79614463903238
Confusion Metric: 
 [[2942  205    3  318   45    8   23]
 [ 188 1449   12   44   27    3   10]
 [  15   52  254    0    0    2    0]
 [ 316   34    0 1201   18    2    7]
 [ 111   61    1   57   83    1    2]
 [  16    1    1    0    0  186    3]
 [  22    2    0    8    0    0  204]]
Macro Precision/Recall/F-score:  (0.7875708372194745, 0.7484773142641407, 0.7623564705823114, None)


epoch 20/30
Accuracy:  0.8015623031372054
Confusion Metric: 
 [[3006  227    4  237   43   10   17]
 [ 184 1463   20   30   26    4    6]
 [  12   46  263    0    0    2    0]
 [ 350   40    0 1161   21    2    4]
 [ 113   66    1   47   86    1    2]
 [  16    1    1    0    0  186    3]
 [  27    2    1    8    1    0  197]]
Macro Precision/Recall/F-score:  (0.7924082052376348, 0.7496894651131322, 0.7660782114190025, None)


epoch 21/30
Accuracy:  0.8006803578178153
Confusion Metric: 
 [[2993  212    3  258   51    8   19]
 [ 205 1437   20   36   27    2    6]
 [  18   41  262    0    0    2    0]
 [ 325   38    0 1188   22    2    3]
 [ 109   59    2   49   93    1    3]
 [  17    1    0    1    0  185    3]
 [  22    0    1   13    3    0  197]]
Macro Precision/Recall/F-score:  (0.7922828812805264, 0.7514986386930594, 0.7683305371762935, None)


epoch 22/30
Accuracy:  0.8043341312838604
Confusion Metric: 
 [[3025  233    3  214   42   10   17]
 [ 179 1475   21   28   20    4    6]
 [  15   40  266    0    0    2    0]
 [ 367   50    1 1134   20    2    4]
 [ 114   68    2   39   90    1    2]
 [  15    0    0    1    0  188    3]
 [  23    0    0    6    1    0  206]]
Macro Precision/Recall/F-score:  (0.7998607631711872, 0.7589635935001512, 0.7736618909836651, None)


epoch 23/30
Accuracy:  0.8035781781529545
Confusion Metric: 
 [[3032  212    3  231   45    9   12]
 [ 201 1458   12   24   28    4    6]
 [  18   48  255    0    0    2    0]
 [ 351   45    0 1156   21    2    3]
 [ 120   54    1   42   96    1    2]
 [  15    1    0    1    0  187    3]
 [  26    3    0   10    3    0  194]]
Macro Precision/Recall/F-score:  (0.804056943670517, 0.7497293831578487, 0.7721199522262289, None)


epoch 24/30
Accuracy:  0.8023182562681114
Confusion Metric: 
 [[2972  205    3  306   29   11   18]
 [ 194 1467   16   32   14    4    6]
 [  25   38  258    0    0    2    0]
 [ 305   45    0 1209   12    3    4]
 [ 116   62    1   62   71    1    3]
 [  11    2    0    1    0  190    3]
 [  24    1    0   10    0    0  201]]
Macro Precision/Recall/F-score:  (0.8020856174276394, 0.7491833652732681, 0.7644139280495382, None)


epoch 25/30
Accuracy:  0.8004283734408467
Confusion Metric: 
 [[3003  209    4  249   44    9   26]
 [ 202 1445   25   31   22    3    5]
 [  13   38  270    0    0    2    0]
 [ 346   45    0 1162   20    2    3]
 [ 117   65    2   46   83    1    2]
 [  15    2    0    1    0  186    3]
 [  20    1    0   11    0    0  204]]
Macro Precision/Recall/F-score:  (0.7896063227419748, 0.7541522897290049, 0.7665569143359084, None)


epoch 26/30
Accuracy:  0.8003023812523623
Confusion Metric: 
 [[3035  199    3  238   31   12   26]
 [ 218 1433   25   30   17    4    6]
 [  17   33  271    0    0    2    0]
 [ 354   46    1 1147   18    3    9]
 [ 126   66    2   49   68    1    4]
 [  13    1    0    1    0  189    3]
 [  17    1    1    8    0    0  209]]
Macro Precision/Recall/F-score:  (0.7854168600382303, 0.7518531538023302, 0.7595627515934735, None)


epoch 27/30
Accuracy:  0.8026962328335643
Confusion Metric: 
 [[3054  187    5  230   40    6   22]
 [ 227 1413   28   33   24    2    6]
 [  14   32  275    0    0    2    0]
 [ 350   43    1 1161   15    2    6]
 [ 126   58    3   46   79    1    3]
 [  17    1    0    1    0  185    3]
 [  22    1    0    8    1    0  204]]
Macro Precision/Recall/F-score:  (0.7928069276428467, 0.7531926392467343, 0.7667670075929044, None)


epoch 28/30
Accuracy:  0.8039561547184074
Confusion Metric: 
 [[3058  209    3  207   38    8   21]
 [ 208 1452   21   25   20    1    6]
 [  16   34  271    0    0    2    0]
 [ 366   48    0 1137   18    2    7]
 [ 124   71    1   40   76    1    3]
 [  17    1    0    1    0  185    3]
 [  27    2    0    5    0    0  202]]
Macro Precision/Recall/F-score:  (0.79770217221699, 0.7500600281560992, 0.7665271010699083, None)


epoch 29/30
Accuracy:  0.8038301625299231
Confusion Metric: 
 [[3109  172    2  201   28   11   21]
 [ 228 1420   16   31   27    4    7]
 [  20   44  257    0    0    2    0]
 [ 382   34    0 1133   18    2    9]
 [ 135   59    0   50   69    1    2]
 [  15    1    0    1    0  187    3]
 [  24    1    0    6    0    0  205]]
Macro Precision/Recall/F-score:  (0.7950619057879769, 0.7429555601092165, 0.7603038427594042, None)

best_epoch:  22 0.7736618909836651 0.8043341312838604


valid f1:  0.772799561326222 [0.7690482285648403, 0.7756885644301602, 0.7736618909836651]
valid acc: 0.8024862458527572 [0.7997984124984251, 0.8033261937759859, 0.8043341312838604]
