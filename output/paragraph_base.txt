['/home/lizhuoqun/SE_type_code', '/home/lizhuoqun/anconda/envs/py38/lib/python38.zip', '/home/lizhuoqun/anconda/envs/py38/lib/python3.8', '/home/lizhuoqun/anconda/envs/py38/lib/python3.8/lib-dynload', '/home/lizhuoqun/anconda/envs/py38/lib/python3.8/site-packages', '/home/lizhuoqun/SE_type_code/data', '/home/lizhuoqun/SE_type_code/tools', '/home/lizhuoqun/SE_type_code/models', '/home/lizhuoqun/SE_type_code/pre_train']
sentence level BiLSTM
paragraph level BiLSTM
Namespace(BATCH_SIZE=128, DROPOUT=0.5, EPOCHs=30, EX_LOSS=0, FREEZE=1, IF_USE_EX_INITIAL_1=0, IF_USE_EX_INITIAL_2=0, LEARN_RATE=0.001, METHOD=0)


time= 1230
use 343 from author
Loading Data...
len(test_X):  981
len(train_X):  3803
MyModel


epoch 0/30
Accuracy:  0.6487337785057327
Confusion Metric: 
 [[2231  537   12  752    0   12    0]
 [ 245 1392   19   73    0    4    0]
 [  31  131  156    4    0    1    0]
 [ 294   80    0 1198    0    6    0]
 [ 129   83    2  101    0    1    0]
 [  34    2    2   12    0  157    0]
 [  54   25   30  105    0    7   15]]
Macro Precision/Recall/F-score:  (0.6332167101587959, 0.4995600677880856, 0.4990953153678599, None)


epoch 1/30
Accuracy:  0.6958548569988661
Confusion Metric: 
 [[2402  271   22  769    0   21   59]
 [ 298 1228   59  121    0    6   21]
 [  24   39  252    4    0    4    0]
 [ 223   44    1 1283    0    3   24]
 [ 110   62    2  122    0    2   18]
 [  12    0    1    2    0  188    4]
 [  20    4    3   37    0    2  170]]
Macro Precision/Recall/F-score:  (0.6026946264003102, 0.6583078350869264, 0.6247956130383493, None)


epoch 2/30
Accuracy:  0.7388181932720171
Confusion Metric: 
 [[2815  275   12  375    0   14   53]
 [ 291 1307   38   81    1    4   11]
 [  21   47  254    0    0    1    0]
 [ 374   38    0 1138    0    3   25]
 [ 159   67    1   70    0    2   17]
 [  18    1    0    1    0  182    5]
 [  29    4    1   34    0    0  168]]
Macro Precision/Recall/F-score:  (0.6423531909206283, 0.6638741320587341, 0.6521823966870613, None)


epoch 3/30
Accuracy:  0.6900592163285876
Confusion Metric: 
 [[2112  260   12 1091    1   24   44]
 [ 136 1335   43  201    0    5   13]
 [  14   43  255    9    0    2    0]
 [ 111   29    0 1431    0    4    3]
 [  91   65    1  147    0    2   10]
 [   7    1    0    1    0  195    3]
 [  12    4    1   69    0    1  149]]
Macro Precision/Recall/F-score:  (0.6328269195301307, 0.6622828504362841, 0.6346676665204806, None)


epoch 4/30
Accuracy:  0.7320146150938642
Confusion Metric: 
 [[2480  269   11  701    3   21   59]
 [ 157 1387   33  135    1    5   15]
 [  15   43  256    6    0    3    0]
 [ 205   40    0 1320    2    5    6]
 [ 106   79    1  107    4    2   17]
 [   8    1    0    1    0  194    3]
 [  12    5    1   49    0    0  169]]
Macro Precision/Recall/F-score:  (0.697202644167828, 0.6850214339674726, 0.6597362654068126, None)


epoch 5/30
Accuracy:  0.7577170215446642
Confusion Metric: 
 [[2690  259    8  514    4   14   55]
 [ 162 1424   35   93    2    4   13]
 [  21   43  254    3    0    2    0]
 [ 260   39    1 1260    3    5   10]
 [ 116   76    1   98    8    1   16]
 [  10    1    0    0    0  193    3]
 [  10    5    1   35    0    0  185]]
Macro Precision/Recall/F-score:  (0.7253542582332221, 0.7010235046335697, 0.6818225635096723, None)


epoch 6/30
Accuracy:  0.7677963966234094
Confusion Metric: 
 [[2798  246    8  401    7   13   71]
 [ 187 1416   33   69    7    4   17]
 [  22   39  259    2    0    1    0]
 [ 290   41    0 1211    6    4   26]
 [ 132   63    1   75   22    1   22]
 [  10    1    0    1    0  191    4]
 [  13    5    0   21    0    0  197]]
Macro Precision/Recall/F-score:  (0.733448269628267, 0.7147056616718005, 0.6954644427543454, None)


epoch 7/30
Accuracy:  0.7560791230943682
Confusion Metric: 
 [[2661  236    2  484    5   12  144]
 [ 170 1407   30   86    4    4   32]
 [  18   44  256    3    0    2    0]
 [ 226   41    0 1265    7    4   35]
 [ 107   65    1   86   12    1   44]
 [  10    1    0    1    0  191    4]
 [   9    3    0   15    0    0  209]]
Macro Precision/Recall/F-score:  (0.7028321901948431, 0.7147462764359059, 0.673262404491414, None)


epoch 8/30
Accuracy:  0.7835454201839486
Confusion Metric: 
 [[2964  226    9  265   15   13   52]
 [ 195 1435   30   40   17    4   12]
 [  18   42  262    0    0    1    0]
 [ 367   48    0 1125   15    4   19]
 [ 135   64    1   59   43    1   13]
 [   9    1    0    0    0  193    4]
 [  21    2    0   15    1    0  197]]
Macro Precision/Recall/F-score:  (0.7476238298596831, 0.727378442719841, 0.7224327432478425, None)


epoch 9/30
Accuracy:  0.7516693964974172
Confusion Metric: 
 [[2813  297    3  376    0   23   32]
 [ 126 1502   13   77    0    6    9]
 [  12   66  239    4    0    2    0]
 [ 470   69    0 1032    1    5    1]
 [  94   95    1  116    0    1    9]
 [   6    1    0    0    0  197    3]
 [  11    4    0   38    0    0  183]]
Macro Precision/Recall/F-score:  (0.6729463302404685, 0.6830694361790103, 0.6751568583529084, None)


epoch 10/30
Accuracy:  0.7790097013985133
Confusion Metric: 
 [[3110  268   10   86   16   11   43]
 [ 156 1509   34   13    5    4   12]
 [  13   39  270    0    0    1    0]
 [ 597   89    1  855   20    3   13]
 [ 144   84    1   31   47    1    8]
 [  14    1    0    0    0  189    3]
 [  23    5    0    5    0    0  203]]
Macro Precision/Recall/F-score:  (0.7713270419913201, 0.721138490293726, 0.7234188437583547, None)


epoch 11/30
Accuracy:  0.7868212170845408
Confusion Metric: 
 [[2965  266    8  216   29   14   46]
 [ 156 1490   24   31   15    4   13]
 [  15   48  259    0    0    1    0]
 [ 405   60    0 1070   23    4   16]
 [ 123   68    1   52   65    1    6]
 [   8    1    0    0    0  194    4]
 [  19    2    0   11    1    1  202]]
Macro Precision/Recall/F-score:  (0.759154157613379, 0.7393090826709593, 0.7386562619414815, None)


epoch 12/30
Accuracy:  0.7870732014615094
Confusion Metric: 
 [[2900  225    5  344   20   12   38]
 [ 164 1445   27   67   13    4   13]
 [  17   50  254    1    0    1    0]
 [ 317   30    0 1203   19    3    6]
 [ 122   62    1   71   55    1    4]
 [  12    1    0    1    0  190    3]
 [  14    1    0   21    0    0  200]]
Macro Precision/Recall/F-score:  (0.7679747707243594, 0.7343166284298628, 0.7381355600235704, None)


epoch 13/30
Accuracy:  0.7916089202469447
Confusion Metric: 
 [[2989  255    9  207   27   12   45]
 [ 150 1495   28   28   17    4   11]
 [  16   51  255    0    0    1    0]
 [ 417   55    0 1071   25    3    7]
 [ 119   70    1   47   73    1    5]
 [  10    1    0    0    0  193    3]
 [  18    1    0    9    1    0  207]]
Macro Precision/Recall/F-score:  (0.7703913397367174, 0.7449632212976506, 0.7480972831549597, None)


epoch 14/30
Accuracy:  0.7908529671160388
Confusion Metric: 
 [[3021  157    2  281   37   13   33]
 [ 233 1375   22   51   35    4   13]
 [  21   43  257    1    0    1    0]
 [ 365   26    0 1156   24    3    4]
 [ 130   47    1   58   77    1    2]
 [  10    1    0    1    0  192    3]
 [  20    0    0   16    1    0  199]]
Macro Precision/Recall/F-score:  (0.7717866009816982, 0.7412163453047571, 0.7514155992225885, None)


epoch 15/30
Accuracy:  0.7851833186342447
Confusion Metric: 
 [[2787  222    6  460   26   11   32]
 [ 142 1454   31   69   22    4   11]
 [  15   43  261    3    0    1    0]
 [ 236   38    0 1283   16    3    2]
 [ 113   59    1   81   57    1    4]
 [   9    1    0    1    0  192    4]
 [  15    2    0   21    0    0  198]]
Macro Precision/Recall/F-score:  (0.7638532004369842, 0.741915730644611, 0.7421143895956187, None)


epoch 16/30
Accuracy:  0.7932468186972408
Confusion Metric: 
 [[2950  209    8  290   31   13   43]
 [ 166 1449   33   49   21    4   11]
 [  18   41  263    0    0    1    0]
 [ 336   45    0 1170   17    3    7]
 [ 119   61    1   66   66    1    2]
 [   8    1    0    1    0  193    4]
 [  16    1    0   14    0    0  205]]
Macro Precision/Recall/F-score:  (0.7652516392904498, 0.7477247768254631, 0.7476698978927374, None)


epoch 17/30
Accuracy:  0.7931208265087565
Confusion Metric: 
 [[2960  209    6  254   43   14   58]
 [ 166 1445   29   40   30    4   19]
 [  20   41  261    0    0    1    0]
 [ 350   45    0 1144   26    3   10]
 [ 111   59    1   52   85    1    7]
 [  10    1    0    1    0  191    4]
 [  13    1    0   12    1    0  209]]
Macro Precision/Recall/F-score:  (0.7557794106576858, 0.7541903382909344, 0.7491437239806054, None)


epoch 18/30
Accuracy:  0.7957666624669271
Confusion Metric: 
 [[2991  231    3  229   40   12   38]
 [ 152 1474   31   36   23    4   13]
 [  16   44  262    0    0    1    0]
 [ 381   54    0 1108   26    2    7]
 [ 108   64    1   57   77    1    8]
 [   9    1    0    1    0  192    4]
 [  14    2    0    8    0    0  212]]
Macro Precision/Recall/F-score:  (0.7680603637905453, 0.7539031638965153, 0.7544973596291896, None)


epoch 19/30
Accuracy:  0.7962706312208643
Confusion Metric: 
 [[2968  223    3  279   35    8   28]
 [ 166 1461   28   42   24    4    8]
 [  14   45  263    0    0    1    0]
 [ 334   47    1 1166   25    2    3]
 [ 115   64    1   58   75    1    2]
 [  13    1    0    1    0  188    4]
 [  18    1    0   17    1    0  199]]
Macro Precision/Recall/F-score:  (0.778806912545564, 0.7460635276167374, 0.7566195350631622, None)


epoch 20/30
Accuracy:  0.7926168577548192
Confusion Metric: 
 [[2954  224    6  273   44   14   29]
 [ 162 1451   40   40   27    4    9]
 [  10   36  276    0    0    1    0]
 [ 351   51    2 1145   25    3    1]
 [ 117   61    1   57   77    1    2]
 [   8    1    0    1    0  193    4]
 [  18    2    0   21    0    0  195]]
Macro Precision/Recall/F-score:  (0.7651355542841507, 0.7504568940354263, 0.7534095115698641, None)


epoch 21/30
Accuracy:  0.7986644828020663
Confusion Metric: 
 [[3110  186    1  176   22   10   39]
 [ 219 1423   28   33   15    3   12]
 [  14   47  261    0    0    1    0]
 [ 432   35    1 1078   20    3    9]
 [ 139   54    1   46   67    1    8]
 [  10    1    0    1    0  191    4]
 [  19    2    0    6    0    0  209]]
Macro Precision/Recall/F-score:  (0.7855852020099953, 0.7443107935866099, 0.7524746487317026, None)


epoch 22/30
Accuracy:  0.7942547562051153
Confusion Metric: 
 [[2931  220    4  297   44   11   37]
 [ 175 1440   31   36   37    3   11]
 [  15   43  263    0    1    1    0]
 [ 307   40    0 1192   29    2    8]
 [ 115   53    1   56   84    1    6]
 [  10    1    0    1    0  191    4]
 [  14    2    0   16    1    0  203]]
Macro Precision/Recall/F-score:  (0.7635383632389319, 0.7537551813152984, 0.7552003118279051, None)


epoch 23/30
Accuracy:  0.7979085296711604
Confusion Metric: 
 [[2927  240    6  265   53   13   40]
 [ 147 1462   34   40   34    4   12]
 [   9   40  271    1    1    1    0]
 [ 314   42    0 1177   37    3    5]
 [ 100   60    1   53   97    1    4]
 [   9    1    0    1    0  192    4]
 [  15    2    0   11    1    0  207]]
Macro Precision/Recall/F-score:  (0.7635686729560636, 0.7665762513406216, 0.7627048846825994, None)


epoch 24/30
Accuracy:  0.7966486077863173
Confusion Metric: 
 [[3000  179    2  304   22    8   29]
 [ 208 1406   30   51   25    4    9]
 [   9   41  270    1    1    1    0]
 [ 327   36    1 1192   12    3    7]
 [ 129   55    1   68   59    1    3]
 [  10    1    0    1    0  191    4]
 [  21    0    0   10    0    0  205]]
Macro Precision/Recall/F-score:  (0.7801223221745973, 0.7467384452117288, 0.753017417011425, None)


epoch 25/30
Accuracy:  0.7902230061736172
Confusion Metric: 
 [[2798  240    4  400   57   15   30]
 [ 136 1455   36   52   41    3   10]
 [   6   40  274    1    1    1    0]
 [ 252   45    1 1256   22    2    0]
 [  90   55    1   73   93    1    3]
 [   8    1    0    1    0  193    4]
 [  17    1    0   15    0    0  203]]
Macro Precision/Recall/F-score:  (0.7640046767869327, 0.7657385438676032, 0.7620904590722024, None)


epoch 26/30
Accuracy:  0.7999244046869094
Confusion Metric: 
 [[3011  215    3  257   20   15   23]
 [ 184 1464   22   34   19    4    6]
 [  11   55  256    0    0    1    0]
 [ 351   44    0 1164   16    2    1]
 [ 126   58    1   62   65    1    3]
 [   9    1    0    1    0  192    4]
 [  29    1    0    9    0    0  197]]
Macro Precision/Recall/F-score:  (0.7931942418793029, 0.7417961785934643, 0.7558998810512064, None)


epoch 27/30
Accuracy:  0.7928688421317879
Confusion Metric: 
 [[2907  220    4  332   46   11   24]
 [ 188 1453   23   28   30    3    8]
 [  13   46  262    1    0    1    0]
 [ 305   47    2 1194   26    2    2]
 [ 107   59    1   58   87    1    3]
 [   9    2    0    1    0  191    4]
 [  17    2    0   18    0    0  199]]
Macro Precision/Recall/F-score:  (0.778065397497586, 0.7525330961424715, 0.7615397005637604, None)


epoch 28/30
Accuracy:  0.7963966234093486
Confusion Metric: 
 [[2907  246    9  275   55   14   38]
 [ 141 1483   32   31   31    3   12]
 [   6   43  273    0    0    1    0]
 [ 331   50    1 1158   31    2    5]
 [  98   63    1   51   99    1    3]
 [  10    2    0    1    0  190    4]
 [  14    3    0    8    0    0  211]]
Macro Precision/Recall/F-score:  (0.7670053280313031, 0.7686108509979769, 0.7649493748390623, None)


epoch 29/30
Accuracy:  0.7991684515560036
Confusion Metric: 
 [[3003  195    6  239   34    9   58]
 [ 197 1422   34   36   24    4   16]
 [   8   37  277    0    0    1    0]
 [ 345   36    2 1154   26    2   13]
 [ 118   56    1   51   79    1   10]
 [   9    1    0    0    0  193    4]
 [  13    2    0    6    0    0  215]]
Macro Precision/Recall/F-score:  (0.7646417746137139, 0.7643092471379512, 0.7565746752553298, None)

best_epoch:  28 0.7649493748390623 0.7963966234093486
best model save done


time= 1231
use 343 from author
Loading Data...
len(test_X):  981
len(train_X):  3803
MyModel


epoch 0/30
Accuracy:  0.661710973919617
Confusion Metric: 
 [[2782  362   16  354    0   29    1]
 [ 355 1251   38   80    0    9    0]
 [  26   84  210    1    0    2    0]
 [ 617  108    1  842    0   10    0]
 [ 153   78    3   75    0    7    0]
 [  35    2   10    3    0  157    0]
 [  66   23   22   56    0   59   10]]
Macro Precision/Recall/F-score:  (0.5894601198102257, 0.4987752726828241, 0.484871325879956, None)


epoch 1/30
Accuracy:  0.7253370291041955
Confusion Metric: 
 [[2749  291   10  438    0   18   38]
 [ 297 1274   36  104    0    5   17]
 [  25   51  244    1    0    1    1]
 [ 360   46    1 1154    0    3   14]
 [ 149   63    2   86    0    2   14]
 [  18    1    0    2    0  181    5]
 [  26    5    0   50    0    0  155]]
Macro Precision/Recall/F-score:  (0.6361918347320313, 0.6469596824456553, 0.6407100663049395, None)


epoch 2/30
Accuracy:  0.7454957792616858
Confusion Metric: 
 [[2926  240    4  304    0   17   53]
 [ 313 1302   35   62    0    5   16]
 [  26   46  247    1    0    2    1]
 [ 438   47    1 1060    0    3   29]
 [ 172   68    1   55    0    3   17]
 [  11    1    0    1    0  190    4]
 [  25    2    0   17    0    0  192]]
Macro Precision/Recall/F-score:  (0.6506659334764618, 0.67782786711088, 0.6614432324915275, None)


epoch 3/30
Accuracy:  0.7516693964974172
Confusion Metric: 
 [[2988  255    4  227    0   19   51]
 [ 271 1353   39   49    1    4   16]
 [  17   51  254    0    0    1    0]
 [ 521   48    0  979    0    3   27]
 [ 174   71    1   52    0    3   15]
 [   9    1    0    0    0  193    4]
 [  25    2    0   10    0    0  199]]
Macro Precision/Recall/F-score:  (0.6578213508769342, 0.6866018516356264, 0.6685737670282367, None)


epoch 4/30
Accuracy:  0.75759102935618
Confusion Metric: 
 [[2935  274    5  267    1   17   45]
 [ 218 1405   38   51    2    3   16]
 [  19   43  259    1    0    1    0]
 [ 467   56    0 1020    2    3   30]
 [ 167   76    1   56    3    1   12]
 [   9    1    0    0    0  193    4]
 [  25    2    0   11    0    0  198]]
Macro Precision/Recall/F-score:  (0.7158098270988736, 0.6954260562069212, 0.6782208096595158, None)


epoch 5/30
Accuracy:  0.7654025450422074
Confusion Metric: 
 [[2983  251    3  252    3   12   40]
 [ 208 1423   36   48    4    3   11]
 [  18   41  262    1    0    1    0]
 [ 502   48    0 1012    3    2   11]
 [ 165   75    1   52   13    1    9]
 [  16    1    0    1    0  185    4]
 [  25    3    0   11    0    0  197]]
Macro Precision/Recall/F-score:  (0.7618439411102141, 0.6978417400016597, 0.6959399192838026, None)


epoch 6/30
Accuracy:  0.7685523497543152
Confusion Metric: 
 [[2977  284    5  200    5   16   57]
 [ 189 1450   25   41    5    4   19]
 [  17   47  258    0    0    1    0]
 [ 510   52    0  994    6    3   13]
 [ 158   75    1   50   20    1   11]
 [   6    1    0    0    0  197    3]
 [  25    2    0    5    0    0  204]]
Macro Precision/Recall/F-score:  (0.7566217210155367, 0.7121103260157634, 0.7024774313889932, None)


epoch 7/30
Accuracy:  0.7715761622779388
Confusion Metric: 
 [[2959  275    5  236   10   16   43]
 [ 176 1474   24   38    6    3   12]
 [  18   49  254    1    0    1    0]
 [ 478   66    0 1019    6    4    5]
 [ 147   77    1   54   27    1    9]
 [   6    1    0    0    0  197    3]
 [  21    3    0   18    0    0  194]]
Macro Precision/Recall/F-score:  (0.763367505150937, 0.710968578272107, 0.710746988909104, None)


epoch 8/30
Accuracy:  0.7754819201209525
Confusion Metric: 
 [[2897  291    4  262   19   13   58]
 [ 156 1475   25   46   11    4   16]
 [  14   48  260    0    0    1    0]
 [ 414   50    0 1084   12    4   14]
 [ 126   75    1   57   45    1   11]
 [   7    1    0    0    0  195    4]
 [  16    3    0   18    0    0  199]]
Macro Precision/Recall/F-score:  (0.7519084098191074, 0.7268737983464284, 0.7215949234914362, None)


epoch 9/30
Accuracy:  0.7806475998488094
Confusion Metric: 
 [[3017  234    7  197   34   14   41]
 [ 191 1440   32   34   23    3   10]
 [  17   41  263    0    0    2    0]
 [ 481   51    0 1009   20    4   13]
 [ 126   71    2   46   66    1    4]
 [   7    1    0    0    0  195    4]
 [  18    3    0    9    0    0  206]]
Macro Precision/Recall/F-score:  (0.7573766463909696, 0.7370937948192049, 0.7381518940942129, None)


epoch 10/30
Accuracy:  0.7866952248960565
Confusion Metric: 
 [[3021  240   10  203   21   14   35]
 [ 190 1455   28   32   15    4    9]
 [  15   41  266    0    0    1    0]
 [ 447   50    0 1060   14    4    3]
 [ 135   71    2   49   54    1    4]
 [   7    1    0    0    0  196    3]
 [  19    3    0   21    0    1  192]]
Macro Precision/Recall/F-score:  (0.7717459811256129, 0.7312260371920694, 0.7377793530545154, None)


epoch 11/30
Accuracy:  0.7851833186342447
Confusion Metric: 
 [[2910  291    4  244   40   13   42]
 [ 144 1495   27   31   22    4   10]
 [  13   46  263    0    0    1    0]
 [ 385   70    0 1090   23    4    6]
 [ 105   78    2   51   74    1    5]
 [   6    1    0    0    0  197    3]
 [  15    3    0   15    0    0  203]]
Macro Precision/Recall/F-score:  (0.7617943646861144, 0.7478283983054356, 0.74772931083084, None)


epoch 12/30
Accuracy:  0.7914829280584603
Confusion Metric: 
 [[2993  215    4  247   25   14   46]
 [ 196 1444   26   37   15    4   11]
 [  18   39  264    0    0    2    0]
 [ 382   41    0 1125   15    4   11]
 [ 127   71    2   48   60    1    7]
 [   8    1    0    0    0  195    3]
 [  18    2    0   15    0    0  201]]
Macro Precision/Recall/F-score:  (0.7687143811184333, 0.7416608081139641, 0.7427231117760004, None)


epoch 13/30
Accuracy:  0.7877031624039309
Confusion Metric: 
 [[2852  303    7  288   36   15   43]
 [ 133 1508   25   39   15    3   10]
 [  12   41  268    0    0    2    0]
 [ 336   59    0 1160   14    4    5]
 [ 109   72    1   55   72    1    6]
 [   6    1    0    0    0  197    3]
 [  16    4    0   21    0    0  195]]
Macro Precision/Recall/F-score:  (0.7673735058937999, 0.7493638498129551, 0.7487832313940518, None)


epoch 14/30
Accuracy:  0.7958926546554114
Confusion Metric: 
 [[2987  271    3  193   40   14   36]
 [ 144 1493   27   37   20    3    9]
 [  12   44  265    0    0    2    0]
 [ 390   56    0 1100   23    4    5]
 [ 116   75    1   46   73    1    4]
 [   8    1    0    0    0  195    3]
 [  17    6    0    9    0    0  204]]
Macro Precision/Recall/F-score:  (0.7728125873970803, 0.7513302234077698, 0.754819665517641, None)


epoch 15/30
Accuracy:  0.794128764016631
Confusion Metric: 
 [[2970  255    6  233   34   12   34]
 [ 157 1471   27   41   24    3   10]
 [  15   35  270    1    0    2    0]
 [ 376   47    0 1127   19    4    5]
 [ 117   69    1   60   65    1    3]
 [   6    1    0    0    0  197    3]
 [  19    2    0   12    0    0  203]]
Macro Precision/Recall/F-score:  (0.7701111194981606, 0.7506454584818231, 0.7527410832487641, None)


epoch 16/30
Accuracy:  0.7947587249590525
Confusion Metric: 
 [[2942  266    3  249   29   13   42]
 [ 156 1492   21   34   17    3   10]
 [  12   46  263    0    0    2    0]
 [ 354   56    0 1139   17    4    8]
 [ 114   70    1   56   70    1    4]
 [   6    1    0    0    0  197    3]
 [  15    4    0   11    0    1  205]]
Macro Precision/Recall/F-score:  (0.7768630081629642, 0.7527093349015155, 0.7543352003145652, None)


epoch 17/30
Accuracy:  0.7945067405820839
Confusion Metric: 
 [[2937  263    6  249   45   12   32]
 [ 163 1465   27   40   24    4   10]
 [   8   38  274    1    0    2    0]
 [ 344   47    0 1156   23    4    4]
 [ 114   65    2   53   78    1    3]
 [   6    1    0    0    0  198    2]
 [  19    3    0   14    1    1  198]]
Macro Precision/Recall/F-score:  (0.7700420763674195, 0.7567556863716496, 0.7583920382136278, None)


epoch 18/30
Accuracy:  0.8035781781529545
Confusion Metric: 
 [[3080  208    3  172   40   13   28]
 [ 191 1448   25   33   24    3    9]
 [  15   37  269    0    0    2    0]
 [ 394   48    1 1096   26    4    9]
 [ 127   60    1   43   80    1    4]
 [   6    1    0    0    0  197    3]
 [  20    3    0    5    0    0  208]]
Macro Precision/Recall/F-score:  (0.7829801527108052, 0.7597426429322809, 0.7651953745702519, None)


epoch 19/30
Accuracy:  0.7926168577548192
Confusion Metric: 
 [[2954  238    3  273   30   13   33]
 [ 159 1469   23   49   20    3   10]
 [  12   46  260    3    0    2    0]
 [ 362   45    0 1139   23    4    5]
 [ 115   69    1   57   69    1    4]
 [   7    1    0    0    0  195    4]
 [  17    2    0   12    0    0  205]]
Macro Precision/Recall/F-score:  (0.7735708259679515, 0.7481378924832385, 0.752575240203148, None)


epoch 20/30
Accuracy:  0.8026962328335643
Confusion Metric: 
 [[3068  195    3  202   37   11   28]
 [ 198 1429   30   31   33    3    9]
 [  12   36  273    0    0    2    0]
 [ 377   40    1 1127   23    4    6]
 [ 129   54    2   49   78    1    3]
 [  12    1    0    0    0  192    2]
 [  23    0    0    7    0    2  204]]
Macro Precision/Recall/F-score:  (0.7793833133760336, 0.7554921449502991, 0.7622637839240415, None)


epoch 21/30
Accuracy:  0.800176389063878
Confusion Metric: 
 [[2969  266    6  200   64   12   27]
 [ 150 1475   34   32   30    3    9]
 [   7   39  273    2    0    2    0]
 [ 359   53    2 1127   30    4    3]
 [  98   57    3   44  110    1    3]
 [   8    1    0    1    0  195    2]
 [  19    1    0   11    1    2  202]]
Macro Precision/Recall/F-score:  (0.7765004424159574, 0.7706197205161792, 0.7715916086899293, None)


epoch 22/30
Accuracy:  0.8044601234723447
Confusion Metric: 
 [[2995  220    2  257   29    9   32]
 [ 175 1471   25   38   14    3    7]
 [  11   41  267    2    0    2    0]
 [ 316   39    1 1197   18    3    4]
 [ 118   65    2   66   61    1    3]
 [  10    1    0    1    0  192    3]
 [  21    3    0    9    0    1  202]]
Macro Precision/Recall/F-score:  (0.7852926354847786, 0.7507991862422345, 0.7578628988732037, None)


epoch 23/30
Accuracy:  0.8026962328335643
Confusion Metric: 
 [[3055  207    2  213   32   10   25]
 [ 202 1446   22   37   17    3    6]
 [  14   41  267    0    0    1    0]
 [ 370   38    1 1145   16    4    4]
 [ 124   63    1   63   61    1    3]
 [   8    1    0    1    0  194    3]
 [  24    1    0    7    0    1  203]]
Macro Precision/Recall/F-score:  (0.7891704156411957, 0.7484349276902461, 0.75917492681365, None)


epoch 24/30
Accuracy:  0.8010583343832682
Confusion Metric: 
 [[3010  216    4  225   43   11   35]
 [ 186 1440   35   35   24    4    9]
 [   9   36  276    1    0    1    0]
 [ 339   51    3 1150   22    4    9]
 [ 117   55    4   58   77    1    4]
 [   6    1    0    1    0  197    2]
 [  18    0    0    7    0    3  208]]
Macro Precision/Recall/F-score:  (0.7696145927913024, 0.7628898890317632, 0.760562527999148, None)


epoch 25/30
Accuracy:  0.802948217210533
Confusion Metric: 
 [[3076  198    3  204   30    8   25]
 [ 212 1432   26   29   22    2   10]
 [  12   38  271    0    0    2    0]
 [ 368   43    2 1137   19    4    5]
 [ 127   60    3   56   66    1    3]
 [  14    1    0    1    0  189    2]
 [  26    2    0    6    0    0  202]]
Macro Precision/Recall/F-score:  (0.7869010893437158, 0.7473766606916945, 0.758820249951632, None)


epoch 26/30
Accuracy:  0.7986644828020663
Confusion Metric: 
 [[2986  208    5  254   59   11   21]
 [ 181 1436   23   45   39    3    6]
 [   9   43  268    1    0    2    0]
 [ 329   38    1 1182   23    3    2]
 [ 113   54    1   55   89    2    2]
 [  12    1    0    1    0  192    1]
 [  26    1    0   21    2    0  186]]
Macro Precision/Recall/F-score:  (0.7792808810235925, 0.7496085521873852, 0.7620352961279708, None)


epoch 27/30
Accuracy:  0.7976565452941917
Confusion Metric: 
 [[2885  231    6  304   67   12   39]
 [ 150 1433   31   55   48    3   13]
 [  10   36  272    2    1    2    0]
 [ 276   31    1 1226   31    4    9]
 [  86   52    3   58  109    1    7]
 [   6    1    0    0    0  196    4]
 [  17    1    0    8    0    0  210]]
Macro Precision/Recall/F-score:  (0.7605921481982296, 0.7773724164958075, 0.7672218435402313, None)


epoch 28/30
Accuracy:  0.7972785687287388
Confusion Metric: 
 [[2885  278    6  272   66    9   28]
 [ 144 1479   29   32   40    3    6]
 [   8   40  271    2    0    2    0]
 [ 299   48    2 1189   31    4    5]
 [  91   53    3   60  104    2    3]
 [   6    1    0    1    0  197    2]
 [  21    1    0    8    1    2  203]]
Macro Precision/Recall/F-score:  (0.770922160608133, 0.7715648886642245, 0.7698112843988097, None)


epoch 29/30
Accuracy:  0.7982865062366133
Confusion Metric: 
 [[2942  217    7  291   51    9   27]
 [ 173 1420   40   58   32    2    8]
 [   7   37  276    1    0    2    0]
 [ 292   37    1 1224   16    4    4]
 [ 106   51    3   68   83    1    4]
 [   9    1    0    1    0  194    2]
 [  26    1    0   11    0    1  197]]
Macro Precision/Recall/F-score:  (0.7710725736251812, 0.7591829150874178, 0.7612915661930206, None)

best_epoch:  21 0.7715916086899293 0.800176389063878
best model save done


time= 1232
use 343 from author
Loading Data...
len(test_X):  981
len(train_X):  3803
MyModel


epoch 0/30
Accuracy:  0.6532694972911679
Confusion Metric: 
 [[2518  314   14  673    0   23    2]
 [ 445 1165   28   91    0    4    0]
 [  35  130  148   10    0    0    0]
 [ 332   42    0 1191    0   13    0]
 [ 145   68    2   99    0    1    1]
 [  42    1    6    7    0  151    0]
 [  39   22   30  107    0   26   12]]
Macro Precision/Recall/F-score:  (0.5807836897151647, 0.48228778845255077, 0.4796279317326934, None)


epoch 1/30
Accuracy:  0.7117298727478897
Confusion Metric: 
 [[2537  405    9  534    0   12   47]
 [ 240 1399   22   56    0    4   12]
 [  22   79  221    0    0    1    0]
 [ 318   65    0 1184    0    4    7]
 [ 122   94    1   85    0    1   13]
 [  22    1    0    4    0  176    4]
 [  19    8    4   73    0    0  132]]
Macro Precision/Recall/F-score:  (0.6328452433648731, 0.6238884828094345, 0.6247754129726407, None)


epoch 2/30
Accuracy:  0.73919616983747
Confusion Metric: 
 [[2814  390    4  275    0   12   49]
 [ 211 1472   18   20    0    3    9]
 [  22   70  230    0    0    1    0]
 [ 432  105    0 1019    0    2   20]
 [ 140  112    1   50    0    1   12]
 [  21    1    0    2    0  177    6]
 [  23    8    2   48    0    0  155]]
Macro Precision/Recall/F-score:  (0.6562197659502621, 0.6447275314674676, 0.6470692841835213, None)


epoch 3/30
Accuracy:  0.755197177774978
Confusion Metric: 
 [[2909  315    4  240    0   14   62]
 [ 205 1465   23   23    0    3   14]
 [  25   52  245    0    0    1    0]
 [ 467   75    0 1011    0    2   23]
 [ 151  100    1   46    1    1   16]
 [  16    1    0    1    0  184    5]
 [  21    4    1   31    0    0  179]]
Macro Precision/Recall/F-score:  (0.8047189996864933, 0.6737007383371358, 0.6649686300398804, None)


epoch 4/30
Accuracy:  0.7657805216076603
Confusion Metric: 
 [[2919  273    5  269    4   14   60]
 [ 209 1447   28   29    2    5   13]
 [  22   51  249    0    0    1    0]
 [ 408   69    0 1081    2    3   15]
 [ 148   88    1   58    7    1   13]
 [  11    1    0    0    0  192    3]
 [  14    6    0   33    0    0  183]]
Macro Precision/Recall/F-score:  (0.7340838027910186, 0.6913811305028702, 0.6817808714313014, None)


epoch 5/30
Accuracy:  0.7713241779009702
Confusion Metric: 
 [[3031  214    3  252    6   10   28]
 [ 256 1418   22   25    4    3    5]
 [  24   46  252    0    0    1    0]
 [ 455   59    0 1051    3    2    8]
 [ 165   77    1   54   14    1    4]
 [  17    1    0    0    0  186    3]
 [  24    3    0   37    2    0  170]]
Macro Precision/Recall/F-score:  (0.7670054556939352, 0.6832706856565753, 0.6975056913207898, None)


epoch 6/30
Accuracy:  0.7769938263827643
Confusion Metric: 
 [[2934  250    3  286    9   10   52]
 [ 190 1455   23   47    2    3   13]
 [  20   48  253    1    0    1    0]
 [ 381   49    0 1114    6    2   26]
 [ 137   80    1   57   31    1    9]
 [  20    1    0    0    0  182    4]
 [  19    5    0   14    0    0  198]]
Macro Precision/Recall/F-score:  (0.7737713543825483, 0.7104303786227649, 0.7107239551150835, None)


epoch 7/30
Accuracy:  0.7767418420057957
Confusion Metric: 
 [[2943  205    4  314   10   10   58]
 [ 229 1417   23   46    3    4   11]
 [  21   47  253    1    0    1    0]
 [ 344   48    0 1147    6    3   30]
 [ 141   70    1   66   25    1   12]
 [  19    1    0    0    0  183    4]
 [  19    1    0   19    0    0  197]]
Macro Precision/Recall/F-score:  (0.7585652685039441, 0.7080205279328855, 0.7041874574669152, None)


epoch 8/30
Accuracy:  0.7863172483306035
Confusion Metric: 
 [[2939  231    5  277   25   12   55]
 [ 171 1468   31   36   11    4   12]
 [  14   44  264    0    0    1    0]
 [ 342   53    0 1142   15    4   22]
 [ 122   77    1   58   50    1    7]
 [  20    1    0    0    0  182    4]
 [  19    3    0   18    0    0  196]]
Macro Precision/Recall/F-score:  (0.7521104698876366, 0.7264823773487935, 0.7251538651673431, None)


epoch 9/30
Accuracy:  0.7859392717651505
Confusion Metric: 
 [[3017  238    6  213   26   12   32]
 [ 174 1499   22   19    8    4    7]
 [  15   50  257    0    0    1    0]
 [ 425   80    0 1049   19    2    3]
 [ 134   75    1   46   55    1    4]
 [  21    1    0    0    0  182    3]
 [  21    2    0   32    2    0  179]]
Macro Precision/Recall/F-score:  (0.7742502748130756, 0.7126364892635885, 0.730577396134282, None)


epoch 10/30
Accuracy:  0.7834194279954643
Confusion Metric: 
 [[2879  208    5  377   22   12   41]
 [ 186 1437   26   56   12    4   12]
 [  14   44  262    2    0    1    0]
 [ 305   36    0 1212   13    3    9]
 [ 124   59    1   75   51    1    5]
 [  16    1    0    0    0  187    3]
 [  17    2    0   27    0    0  190]]
Macro Precision/Recall/F-score:  (0.7645039869131391, 0.7272317114045554, 0.7315351148555028, None)


epoch 11/30
Accuracy:  0.7874511780269623
Confusion Metric: 
 [[2956  197    2  318   26   12   33]
 [ 205 1441   23   40   11    4    9]
 [  19   44  259    0    0    1    0]
 [ 341   41    0 1169   16    3    8]
 [ 125   61    1   68   55    1    5]
 [  15    1    0    0    0  188    3]
 [  22    2    0   29    1    0  182]]
Macro Precision/Recall/F-score:  (0.7714325019980056, 0.7231014585874778, 0.7351873346569925, None)


epoch 12/30
Accuracy:  0.7831674436184957
Confusion Metric: 
 [[2946  237    2  297    9   16   37]
 [ 171 1492   26   27    2    5   10]
 [  15   44  263    0    0    1    0]
 [ 411   68    0 1082   10    3    4]
 [ 109   76    1   75   48    1    6]
 [   9    1    0    0    0  194    3]
 [  13    3    1   28    0    0  191]]
Macro Precision/Recall/F-score:  (0.7902283222673603, 0.7272196141131877, 0.732891745940213, None)


epoch 13/30
Accuracy:  0.7916089202469447
Confusion Metric: 
 [[2919  236    5  311   26   10   37]
 [ 158 1484   23   39   14    4   11]
 [  14   46  262    0    0    1    0]
 [ 324   47    0 1183   17    3    4]
 [ 121   68    1   64   58    1    3]
 [  16    1    0    0    0  187    3]
 [  17    2    0   26    1    0  190]]
Macro Precision/Recall/F-score:  (0.7726712428602891, 0.7332576381592016, 0.7418708537865737, None)


epoch 14/30
Accuracy:  0.7911049514930074
Confusion Metric: 
 [[2905  224    3  341   12   12   47]
 [ 160 1476   24   47    8    3   15]
 [  16   45  261    0    0    1    0]
 [ 312   43    1 1197   13    3    9]
 [ 117   68    1   68   53    1    8]
 [  12    1    0    0    0  191    3]
 [  14    1    0   25    0    0  196]]
Macro Precision/Recall/F-score:  (0.7794042705113589, 0.7369910694690418, 0.7385267788362511, None)


epoch 15/30
Accuracy:  0.7969005921632859
Confusion Metric: 
 [[2969  245    4  277   17   11   21]
 [ 160 1500   25   33    8    4    3]
 [  11   45  266    0    0    1    0]
 [ 341   56    0 1157   16    3    5]
 [ 114   81    1   64   53    1    2]
 [  15    1    0    0    0  188    3]
 [  22    2    0   20    0    0  192]]
Macro Precision/Recall/F-score:  (0.7937872104633124, 0.7356477745207203, 0.7487421352393617, None)


epoch 16/30
Accuracy:  0.7989164671790349
Confusion Metric: 
 [[2980  253    5  249   18    8   31]
 [ 153 1497   30   32   11    3    7]
 [  12   44  266    0    0    1    0]
 [ 336   57    0 1154   19    3    9]
 [ 113   79    0   58   61    1    4]
 [  19    1    0    0    0  183    4]
 [  19    2    1   14    0    0  200]]
Macro Precision/Recall/F-score:  (0.7864325262482466, 0.740580883958051, 0.7499681370671273, None)


epoch 17/30
Accuracy:  0.7979085296711604
Confusion Metric: 
 [[2980  224    5  275   13    9   38]
 [ 182 1464   25   40   10    3    9]
 [  13   43  266    0    0    1    0]
 [ 324   43    0 1178   16    3   14]
 [ 115   75    1   59   57    1    8]
 [  18    1    0    1    0  185    2]
 [  18    2    0   13    0    0  203]]
Macro Precision/Recall/F-score:  (0.7864657860325625, 0.7414212374291181, 0.747150841525177, None)


epoch 18/30
Accuracy:  0.8019402797026585
Confusion Metric: 
 [[3052  213    5  206   29    9   30]
 [ 183 1465   31   25   14    2   13]
 [  14   34  274    0    0    1    0]
 [ 380   50    0 1123   20    2    3]
 [ 121   70    1   51   69    1    3]
 [  18    1    0    1    0  184    3]
 [  17    2    1   17    1    0  198]]
Macro Precision/Recall/F-score:  (0.7867869958995313, 0.7446732291579338, 0.7562888373000446, None)


epoch 19/30
Accuracy:  0.8003023812523623
Confusion Metric: 
 [[2998  229    3  256   18    8   32]
 [ 163 1503   24   26    9    2    6]
 [  15   43  264    0    0    1    0]
 [ 356   52    0 1142   21    2    5]
 [ 117   77    1   52   64    1    4]
 [  17    1    0    1    0  184    4]
 [  17    2    0   19    1    0  197]]
Macro Precision/Recall/F-score:  (0.7942367521579669, 0.7400605157000103, 0.7540132865004685, None)


epoch 20/30
Accuracy:  0.7989164671790349
Confusion Metric: 
 [[3006  242    2  235   14    9   36]
 [ 167 1500   27   19    9    3    8]
 [  12   45  266    0    0    0    0]
 [ 359   66    1 1123   18    2    9]
 [ 125   78    1   48   59    1    4]
 [  18    1    0    1    0  183    4]
 [  16    1    0   14    1    0  204]]
Macro Precision/Recall/F-score:  (0.7916380380047412, 0.740586935881322, 0.7501756882320416, None)


epoch 21/30
Accuracy:  0.7987904749905506
Confusion Metric: 
 [[2912  238    5  315   28    8   38]
 [ 149 1497   28   34   11    2   12]
 [  12   38  272    0    0    1    0]
 [ 300   52    0 1195   20    2    9]
 [ 102   75    1   58   74    1    5]
 [  14    1    0    1    0  187    4]
 [  18    1    0   13    1    0  203]]
Macro Precision/Recall/F-score:  (0.7824913156820404, 0.7546588160877199, 0.7584469140881108, None)


epoch 22/30
Accuracy:  0.8008063500062996
Confusion Metric: 
 [[3002  231    4  229   19   13   46]
 [ 169 1484   25   26   11    2   16]
 [  12   43  268    0    0    0    0]
 [ 356   54    1 1137   21    2    7]
 [ 108   79    0   53   69    1    6]
 [  14    1    0    1    0  187    4]
 [  15    1    0   10    1    0  209]]
Macro Precision/Recall/F-score:  (0.7841374740589879, 0.7515667086283341, 0.7548582500376787, None)


epoch 23/30
Accuracy:  0.7956406702784428
Confusion Metric: 
 [[2903  237    4  315   38    9   38]
 [ 154 1467   34   44   23    2    9]
 [  12   41  270    0    0    0    0]
 [ 298   47    1 1204   21    2    5]
 [ 102   69    1   58   82    1    3]
 [  19    1    0    2    0  181    4]
 [  17    1    0    9    1    0  208]]
Macro Precision/Recall/F-score:  (0.7755141228100869, 0.7542557212277717, 0.7587567789248632, None)


epoch 24/30
Accuracy:  0.788963084288774
Confusion Metric: 
 [[2827  278    4  347   14   12   62]
 [ 134 1508   38   31    7    3   12]
 [   9   38  274    1    0    1    0]
 [ 291   55    1 1200   13    3   15]
 [  96   89    1   63   52    1   14]
 [  10    1    0    1    0  191    4]
 [  12    1    1   12    0    0  210]]
Macro Precision/Recall/F-score:  (0.7654935701194117, 0.7505285488596376, 0.7370250823242268, None)


epoch 25/30
Accuracy:  0.7991684515560036
Confusion Metric: 
 [[2968  226    4  278   15   11   42]
 [ 163 1480   27   37   12    2   12]
 [  11   45  266    1    0    0    0]
 [ 320   52    1 1174   21    2    8]
 [ 106   81    0   56   63    1    9]
 [  19    1    0    1    0  182    4]
 [  13    2    0   11    0    0  210]]
Macro Precision/Recall/F-score:  (0.7826439112146186, 0.7467737075802183, 0.7505690437521803, None)


epoch 26/30
Accuracy:  0.7971525765402545
Confusion Metric: 
 [[2975  200    2  296   23   13   35]
 [ 190 1442   31   41   16    2   11]
 [  11   44  266    1    0    1    0]
 [ 323   37    1 1193   17    2    5]
 [ 114   68    0   66   62    1    5]
 [  17    2    0    1    0  183    4]
 [  15    2    0   12    1    0  206]]
Macro Precision/Recall/F-score:  (0.7783678169206507, 0.7434602278127652, 0.7497311440013412, None)


epoch 27/30
Accuracy:  0.8011843265717525
Confusion Metric: 
 [[2917  224    3  318   35   10   37]
 [ 153 1484   30   37   18    2    9]
 [  11   40  270    1    0    1    0]
 [ 290   44    0 1214   21    2    7]
 [ 101   72    1   55   80    1    6]
 [  14    1    0    0    0  189    3]
 [  17    1    0   13    0    0  205]]
Macro Precision/Recall/F-score:  (0.78093235470463, 0.7599276380341488, 0.7631104690793286, None)


epoch 28/30
Accuracy:  0.7979085296711604
Confusion Metric: 
 [[2961  207    3  316   13   12   32]
 [ 184 1457   34   41    8    2    7]
 [  12   42  267    1    0    1    0]
 [ 297   41    1 1213   16    2    8]
 [ 120   73    0   65   48    1    9]
 [  17    1    0    1    0  184    4]
 [  17    1    0   15    0    0  203]]
Macro Precision/Recall/F-score:  (0.7824969133001599, 0.7389303241749856, 0.743128146505786, None)


epoch 29/30
Accuracy:  0.7997984124984251
Confusion Metric: 
 [[2922  224    6  300   40   13   39]
 [ 140 1478   39   37   25    1   13]
 [   9   30  283    1    0    0    0]
 [ 291   49    3 1197   27    2    9]
 [ 105   63    1   59   81    1    6]
 [  21    1    0    1    1  179    4]
 [  11    1    1   15    0    0  208]]
Macro Precision/Recall/F-score:  (0.7647680238992104, 0.7592119838974091, 0.7565930981384955, None)

best_epoch:  27 0.7631104690793286 0.8011843265717525
best model save done


valid f1:  0.7665504842027734 [0.7649493748390623, 0.7715916086899293, 0.7631104690793286]
valid acc: 0.7992524463483264 [0.7963966234093486, 0.800176389063878, 0.8011843265717525]
