['/home/lizhuoqun/SE_type_code', '/home/lizhuoqun/anconda/envs/py38/lib/python38.zip', '/home/lizhuoqun/anconda/envs/py38/lib/python3.8', '/home/lizhuoqun/anconda/envs/py38/lib/python3.8/lib-dynload', '/home/lizhuoqun/anconda/envs/py38/lib/python3.8/site-packages', '/home/lizhuoqun/SE_type_code/data', '/home/lizhuoqun/SE_type_code/models', '/home/lizhuoqun/SE_type_code/tools', '/home/lizhuoqun/SE_type_code/resource', '/home/lizhuoqun/SE_type_code/pre_train']
sentence level BiLSTM extra
___________****************************************** 300 ********************************************************************************
paragraph level BiLSTM label embedding MLP pre
Namespace(BATCH_SIZE=128, DROPOUT=0.5, EPOCHs=40, LEARN_RATE=0.001, WEIGHT_DECAY=0.0001, cheat='False', fold_num=0, mask_p=2.0)




time= 0
self.BiLSTM_1_require_grad:  True
self.cheat:  False
self.mask_p:  2.0
self.threshold:  0.8
start to get stanford
already get stanford
start get bert_tokenizer
get bert tokenizer
if_do_embedding:  True
start read data catalogue
start get train data
already deal 10 file
already deal 20 file
already deal 30 file
already deal 40 file
already deal 50 file
already deal 60 file
already deal 70 file
already deal 80 file
already deal 90 file
already deal 100 file
already deal 110 file
already deal 120 file
already deal 130 file
already deal 140 file
already deal 150 file
already deal 160 file
already deal 170 file
already deal 180 file
already deal 190 file
already deal 200 file
already deal 210 file
already deal 220 file
already deal 230 file
already deal 240 file
already deal 250 file
already deal 260 file
already deal 270 file
already deal 280 file
len(train_valid_data_list):  3368
already deal 10 file
already deal 20 file
already deal 30 file
already deal 40 file
already deal 50 file
already deal 60 file
already deal 70 file
already deal 80 file
complete get data, len(test_data_list):  919


start sentence level BiLSTM  extra


epoch 0/4


epoch 1/4


epoch 2/4


epoch 3/4
sentence level BiLSTM  extra best_epoch:  3 -1 -1
sentence level BiLSTM  extra end

********************************************


epoch 0/40
model.reset
self.reset_num:  0
self.cheat:  False
self.mask_p:  2.0
self.valid_flag:  False
self.BiLSTM_1_require_grad:  True
Accuracy:  0.7158061116965226
Confusion Metric: 
 [[3940  134    6  169    0  104   23]
 [ 619 1394   27   67    0   18   14]
 [  19   28  234    0    0    0    3]
 [ 877   38    0  828    0   27   11]
 [ 250   31    0   93    0    1    9]
 [  35    5    2    3    0  125    8]
 [  36    2    0   21    0   17  272]]
Micro Precision/Recall/F-score:  (0.7158061116965226, 0.7158061116965226, 0.7158061116965228, None)
Macro Precision/Recall/F-score:  (0.619338722905555, 0.6178256341969622, 0.6062164842009131, None)


epoch 1/40
model.reset
self.reset_num:  1
self.cheat:  False
self.mask_p:  2.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.6676501580611169
ex_Confusion Metric: 
 [[3282  241   49  102    9  584  109]
 [ 285 1595   94   27    8   60   70]
 [   8   11  262    0    0    0    3]
 [ 649  104   10  663   29  251   75]
 [ 132   59    9   34   78   38   34]
 [  11    3    4    0    1  141   18]
 [   9    0    1    2    0   21  315]]
used_ex_acc:  0.8600552134211085
used_ex_Confusion Metric: 
 [[2174   59    6   11    0  111   21]
 [  63 1041   27    2    0   15   13]
 [   0    1  234    0    0    0    2]
 [ 216   15    0  224    0   24   10]
 [  30    9    0    0    4    1    7]
 [   1    0    2    0    0  117    7]
 [   1    0    0    0    0    5  256]]
np.mean(reliability_np):  0.7739786307954417
np.median(reliability_np):  0.8287965953350067
np.mean(c_reliability_np):  0.8170225244824483
np.median(c_reliability_np):  0.8870789408683777
np.mean(w_reliability_np):  0.6220262544105608
np.median(w_reliability_np):  0.6068606376647949
self.threshold:  0.8870789408683777
Accuracy:  0.7581664910432033
Confusion Metric: 
 [[3613  127    4  505    3  107   17]
 [ 511 1438   26  137    8   11    8]
 [  18   28  228    4    0    2    4]
 [ 260   14    0 1493    1   11    2]
 [ 175   34    0  135   32    6    2]
 [  27    6    2    3    0  133    7]
 [  27    3    0   13    1   46  258]]
Micro Precision/Recall/F-score:  (0.7581664910432033, 0.7581664910432033, 0.7581664910432033, None)
Macro Precision/Recall/F-score:  (0.7397641943813458, 0.6729900383830304, 0.6599182197675372, None)


epoch 2/40
model.reset
self.reset_num:  2
self.cheat:  False
self.mask_p:  2.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.7077976817702845
ex_Confusion Metric: 
 [[2892  250   51  771   50  297   65]
 [ 190 1587  108  162   37   25   30]
 [   2   11  268    0    0    0    3]
 [ 218   67    9 1372   45   44   26]
 [  56   42    6  105  154    5   16]
 [  10    4    3    6    2  141   12]
 [  15    1    1   10    0   18  303]]
used_ex_acc:  0.911587982832618
used_ex_Confusion Metric: 
 [[1160   28    4  129    0   24    7]
 [  13  764   19   23    0    4    2]
 [   0    1  216    0    0    0    1]
 [  14    5    0  733    0    2    0]
 [   7    5    0   13    7    1    0]
 [   0    0    1    1    0   98    4]
 [   0    0    0    1    0    0  208]]
np.mean(reliability_np):  0.7692478915453538
np.median(reliability_np):  0.8254948258399963
np.mean(c_reliability_np):  0.8075738342098134
np.median(c_reliability_np):  0.874737560749054
np.mean(w_reliability_np):  0.6210969143875918
np.median(w_reliability_np):  0.5977079272270203
self.threshold:  0.874737560749054
Accuracy:  0.7708113804004215
Confusion Metric: 
 [[3748  126    4  344   52   91   11]
 [ 514 1421   19   99   76    5    5]
 [  23   28  228    0    1    1    3]
 [ 309   20    0 1390   47   14    1]
 [ 131   16    0   78  157    2    0]
 [  26    6    2    3    1  135    5]
 [  37    1    0   12    2   60  236]]
Micro Precision/Recall/F-score:  (0.7708113804004215, 0.7708113804004215, 0.7708113804004215, None)
Macro Precision/Recall/F-score:  (0.7276731414772903, 0.707076920045641, 0.7057486171667825, None)


epoch 3/40
model.reset
self.reset_num:  3
self.cheat:  False
self.mask_p:  2.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.7173867228661749
ex_Confusion Metric: 
 [[2996  256   53  703   76  242   50]
 [ 202 1599   96  156   47   18   21]
 [   2   13  267    0    0    0    2]
 [ 246   74    6 1345   52   37   21]
 [  56   43    5  101  163    5   11]
 [   8    3    3    8    3  145    8]
 [  14    2    2   14    3   20  293]]
used_ex_acc:  0.9115417017691659
used_ex_Confusion Metric: 
 [[1233   25    4  133    0   25    5]
 [  15  767   16   23    0    2    2]
 [   0    1  216    0    0    0    1]
 [  26    5    0  715    0    1    0]
 [   7    3    0   15   14    0    0]
 [   0    0    1    0    0  102    4]
 [   0    0    0    1    0    0  199]]
np.mean(reliability_np):  0.7647173493940909
np.median(reliability_np):  0.8170855641365051
np.mean(c_reliability_np):  0.80029340153374
np.median(c_reliability_np):  0.8617256283760071
np.mean(w_reliability_np):  0.6150719159123704
np.median(w_reliability_np):  0.5956213772296906
self.threshold:  0.8617256283760071
Accuracy:  0.7781875658587988
Confusion Metric: 
 [[3811  131    5  291   64   59   15]
 [ 496 1434   36   70   89    6    8]
 [  22   22  236    0    1    0    3]
 [ 340   17    0 1337   75   10    2]
 [ 123   19    0   60  179    2    1]
 [  27    5    3    3    2  133    5]
 [  46    4    0   10    2   31  255]]
Micro Precision/Recall/F-score:  (0.7781875658587988, 0.7781875658587988, 0.7781875658587987, None)
Macro Precision/Recall/F-score:  (0.7326444239865629, 0.7241538028914747, 0.7228942549991191, None)


epoch 4/40
model.reset
self.reset_num:  4
self.cheat:  False
self.mask_p:  2.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.7250790305584827
ex_Confusion Metric: 
 [[3055  227   53  720   61  202   58]
 [ 214 1587   97  158   36   17   30]
 [   2   10  270    0    0    0    2]
 [ 226   67    6 1370   59   30   23]
 [  63   46    5   92  160    4   14]
 [  11    4    3    5    3  141   11]
 [  15    2    2   14    2   15  298]]
used_ex_acc:  0.9197059655074922
used_ex_Confusion Metric: 
 [[1265   20    4  124    0   24    7]
 [  14  732   17   12    0    2    3]
 [   0    1  221    0    0    0    1]
 [  18    4    0  710    0    1    0]
 [   8    3    0   14   13    0    0]
 [   0    0    1    0    0  101    4]
 [   0    0    0    2    0    0  211]]
np.mean(reliability_np):  0.7579624952500534
np.median(reliability_np):  0.8053711354732513
np.mean(c_reliability_np):  0.7898712350569081
np.median(c_reliability_np):  0.8457767963409424
np.mean(w_reliability_np):  0.6013739448927425
np.median(w_reliability_np):  0.5788244605064392
self.threshold:  0.8457767963409424
Accuracy:  0.7708113804004215
Confusion Metric: 
 [[3656  133    6  392   54  121   14]
 [ 470 1427   44   99   82    9    8]
 [  21   17  241    0    1    1    3]
 [ 253   17    0 1438   58   15    0]
 [ 118   15    0   77  169    5    0]
 [  20    5    3    5    2  139    4]
 [  39    5    0   10    1   48  245]]
Micro Precision/Recall/F-score:  (0.7708113804004215, 0.7708113804004215, 0.7708113804004215, None)
Macro Precision/Recall/F-score:  (0.711047893685051, 0.7262327859164922, 0.7061596609593505, None)


epoch 5/40
model.reset
self.reset_num:  5
self.cheat:  False
self.mask_p:  2.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.7026343519494205
ex_Confusion Metric: 
 [[2858  205   56  833   64  304   56]
 [ 219 1555  107  174   36   23   25]
 [   3    9  270    0    0    0    2]
 [ 213   60    6 1392   53   36   21]
 [  63   39    5  108  151    6   12]
 [   7    4    3    7    2  146    9]
 [  12    3    1   15    2   19  296]]
used_ex_acc:  0.9082969432314411
used_ex_Confusion Metric: 
 [[1133   11    4  142    0   34    6]
 [  11  676   21   20    0    3    3]
 [   0    1  224    0    0    0    1]
 [  16    5    0  759    0    2    0]
 [   5    2    0   19   12    0    0]
 [   0    0    2    1    0  106    4]
 [   0    0    0    2    0    0  210]]
np.mean(reliability_np):  0.7463243223616075
np.median(reliability_np):  0.7860080003738403
np.mean(c_reliability_np):  0.7753047748559881
np.median(c_reliability_np):  0.8247255980968475
np.mean(w_reliability_np):  0.594599540988914
np.median(w_reliability_np):  0.5705626308917999
self.threshold:  0.8247255980968475
Accuracy:  0.7724973656480506
Confusion Metric: 
 [[3746  140    5  350   45   71   19]
 [ 512 1382   34   87  106    7   11]
 [  23   21  231    1    4    1    3]
 [ 284   15    0 1415   54   11    2]
 [ 134   16    0   74  150    5    5]
 [  24    4    3    4    3  134    6]
 [  38    3    0    6    2   26  273]]
Micro Precision/Recall/F-score:  (0.7724973656480506, 0.7724973656480506, 0.7724973656480506, None)
Macro Precision/Recall/F-score:  (0.7187117454405119, 0.7197033879791429, 0.7131681101573548, None)


epoch 6/40
model.reset
self.reset_num:  6
self.cheat:  False
self.mask_p:  2.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.7116965226554267
ex_Confusion Metric: 
 [[2994  207   56  751   50  251   67]
 [ 249 1521  109  165   43   20   32]
 [   3    8  270    0    1    0    2]
 [ 228   58    7 1377   49   37   25]
 [  74   39    4  103  144    6   14]
 [   7    4    3    6    3  144   11]
 [  13    2    2   11    2   14  304]]
used_ex_acc:  0.912945801741084
used_ex_Confusion Metric: 
 [[1282   17    3  128    0   25   10]
 [  17  691   21   15    0    2    3]
 [   0    1  222    0    0    0    1]
 [  23    6    0  714    0    1    0]
 [   7    4    0   17   11    0    0]
 [   0    0    2    0    0  105    5]
 [   1    0    0    1    0    0  226]]
np.mean(reliability_np):  0.7347066391404126
np.median(reliability_np):  0.7677727341651917
np.mean(c_reliability_np):  0.765057431045795
np.median(c_reliability_np):  0.8109491169452667
np.mean(w_reliability_np):  0.5785696664607228
np.median(w_reliability_np):  0.5542387366294861
self.threshold:  0.8109491169452667
Accuracy:  0.7649104320337197
Confusion Metric: 
 [[3667  126    4  420   83   63   13]
 [ 470 1368   34   99  157    6    5]
 [  22   23  232    0    3    1    3]
 [ 257   16    0 1426   73    9    0]
 [ 118   14    0   74  173    4    1]
 [  23    4    3    4    3  134    7]
 [  44    4    0    6    4   31  259]]
Micro Precision/Recall/F-score:  (0.7649104320337197, 0.7649104320337197, 0.7649104320337198, None)
Macro Precision/Recall/F-score:  (0.7168268559359704, 0.7203841379062741, 0.7108547141192127, None)


epoch 7/40
model.reset
self.reset_num:  7
self.cheat:  False
self.mask_p:  2.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.6900948366701791
ex_Confusion Metric: 
 [[2782  203   58  882   77  312   62]
 [ 231 1482  129  179   57   29   32]
 [   4    8  269    0    1    0    2]
 [ 190   57    7 1405   64   37   21]
 [  61   35    5   99  163    7   14]
 [   5    4    3    6    3  147   10]
 [  13    2    2   10    2   18  301]]
used_ex_acc:  0.891973445986723
used_ex_Confusion Metric: 
 [[1029   17    3  162    1   36    9]
 [  15  602   27   24    0    3    3]
 [   0    1  226    0    0    0    1]
 [  18    4    0  756    0    2    0]
 [   3    2    0   18   13    0    0]
 [   0    0    2    0    0  110    6]
 [   0    0    0    1    0    0  220]]
np.mean(reliability_np):  0.7180288142364658
np.median(reliability_np):  0.7434403896331787
np.mean(c_reliability_np):  0.741700806646315
np.median(c_reliability_np):  0.7759287357330322
np.mean(w_reliability_np):  0.5673228378088772
np.median(w_reliability_np):  0.5375377535820007
self.threshold:  0.7759287357330322
Accuracy:  0.745100105374078
Confusion Metric: 
 [[3408  120    6  686  125   19   12]
 [ 396 1361   22  137  217    3    3]
 [  23   21  230    2    5    1    2]
 [ 180   14    0 1532   52    3    0]
 [  75   13    0  131  165    0    0]
 [  32    5    2    7    4  121    7]
 [  42    9    0   26    5   12  254]]
Micro Precision/Recall/F-score:  (0.745100105374078, 0.745100105374078, 0.745100105374078, None)
Macro Precision/Recall/F-score:  (0.7367159172342926, 0.7034957072585029, 0.7100560198965976, None)


epoch 8/40
model.reset
self.reset_num:  8
self.cheat:  False
self.mask_p:  2.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.6836670179135933
ex_Confusion Metric: 
 [[2747  192   45  986   93  259   54]
 [ 256 1438   96  204   91   28   26]
 [   7    9  262    2    2    0    2]
 [ 176   55    6 1442   60   28   14]
 [  48   31    2  123  165    7    8]
 [   6    4    3   12    2  136   15]
 [  11    3    1   18    3   14  298]]
used_ex_acc:  0.8769883351007424
used_ex_Confusion Metric: 
 [[1165   23    4  236    2   31    7]
 [  24  688   18   35    1    3    2]
 [   1    1  224    0    0    0    1]
 [  21    6    0  881    0    1    0]
 [   5    4    0   26   22    0    0]
 [   0    0    1    1    0  111    5]
 [   2    0    0    3    0    0  217]]
np.mean(reliability_np):  0.7108709107933396
np.median(reliability_np):  0.7327423691749573
np.mean(c_reliability_np):  0.7444702146021344
np.median(c_reliability_np):  0.7823291718959808
np.mean(w_reliability_np):  0.5635910326444967
np.median(w_reliability_np):  0.535210520029068
self.threshold:  0.7823291718959808
Accuracy:  0.7708113804004215
Confusion Metric: 
 [[3459  242    5  509  122   26   13]
 [ 288 1605   17   75  147    3    4]
 [  17   30  229    0    6    1    1]
 [ 225   26    0 1458   67    4    1]
 [  88   29    0   87  180    0    0]
 [  31    5    2    4    5  124    7]
 [  41   11    0   13    7   16  260]]
Micro Precision/Recall/F-score:  (0.7708113804004215, 0.7708113804004215, 0.7708113804004215, None)
Macro Precision/Recall/F-score:  (0.7429959939737245, 0.7254690599992873, 0.7298917630520785, None)


epoch 9/40
model.reset
self.reset_num:  9
self.cheat:  False
self.mask_p:  2.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.6984193888303477
ex_Confusion Metric: 
 [[2716  257   52 1018   80  188   65]
 [ 188 1600   96  168   42   19   26]
 [   3   11  266    1    1    0    2]
 [ 154   75    6 1456   46   24   20]
 [  55   40    4  122  146    6   11]
 [   6    5    3   12    2  135   15]
 [  13    3    1   13    4    5  309]]
used_ex_acc:  0.8828828828828829
used_ex_Confusion Metric: 
 [[1022   31    4  242    1   26    9]
 [  11  798   16   18    0    2    2]
 [   0    1  224    0    0    0    1]
 [  11    9    0  846    0    2    0]
 [   3    7    0   22   17    0    0]
 [   0    0    1    1    0  105    6]
 [   0    0    0    3    0    0  222]]
np.mean(reliability_np):  0.7009829102406312
np.median(reliability_np):  0.7186679840087891
np.mean(c_reliability_np):  0.73580770984328
np.median(c_reliability_np):  0.775157630443573
np.mean(w_reliability_np):  0.5647282619406758
np.median(w_reliability_np):  0.5375811159610748
self.threshold:  0.775157630443573
Accuracy:  0.7657534246575343
Confusion Metric: 
 [[3272  425   10  411  223   17   18]
 [ 157 1771   26   49  134    0    2]
 [   6   36  235    0    6    0    1]
 [ 216   50    0 1389  123    2    1]
 [  61   45    0   57  221    0    0]
 [  28   11    2    4    8  115   10]
 [  39   17    3    7   11    7  264]]
Micro Precision/Recall/F-score:  (0.7657534246575343, 0.7657534246575343, 0.7657534246575344, None)
Macro Precision/Recall/F-score:  (0.7436822665695917, 0.73760635113229, 0.7314563106531791, None)


epoch 10/40
model.reset
self.reset_num:  10
self.cheat:  False
self.mask_p:  2.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.6817702845100105
ex_Confusion Metric: 
 [[2507  374   70 1053  107  194   71]
 [ 105 1656  136  173   30   16   23]
 [   1    9  272    0    0    0    2]
 [ 148   87    9 1460   37   19   21]
 [  48   58    6  123  133    6   10]
 [   6    5    3   14    3  131   16]
 [  13    4    3   11    4    2  311]]
used_ex_acc:  0.8743515850144092
used_ex_Confusion Metric: 
 [[768  56   6 232   1  15   9]
 [  5 876  24  19   0   0   2]
 [  0   1 230   0   0   0   1]
 [  9  11   0 827   0   1   0]
 [  2   7   0  25  15   0   0]
 [  0   0   1   1   0  93   6]
 [  0   0   0   2   0   0 225]]
np.mean(reliability_np):  0.6915494708756422
np.median(reliability_np):  0.705467939376831
np.mean(c_reliability_np):  0.7225436140617595
np.median(c_reliability_np):  0.7549574375152588
np.mean(w_reliability_np):  0.5519109644538519
np.median(w_reliability_np):  0.5219312012195587
self.threshold:  0.7549574375152588
Accuracy:  0.781559536354057
Confusion Metric: 
 [[3506  371    9  416   31   26   17]
 [ 228 1783   20   85   14    4    5]
 [   7   41  234    0    0    1    1]
 [ 268   50    0 1424   34    4    1]
 [ 108   83    0  104   86    2    1]
 [  27   11    3    2    0  128    7]
 [  50   16    1    9    2   14  256]]
Micro Precision/Recall/F-score:  (0.781559536354057, 0.781559536354057, 0.781559536354057, None)
Macro Precision/Recall/F-score:  (0.7552078731515722, 0.705277357742755, 0.7201004118484107, None)


epoch 11/40
model.reset
self.reset_num:  11
self.cheat:  False
self.mask_p:  2.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.6896733403582719
ex_Confusion Metric: 
 [[2646  285   61 1014   35  240   95]
 [ 139 1621  117  195    8   26   33]
 [   1   12  269    0    0    0    2]
 [ 167   68    8 1468   17   24   29]
 [  66   61    4  138   90    8   17]
 [   6    7    3   10    0  135   17]
 [  11    4    1   12    1    3  316]]
used_ex_acc:  0.8748373666406454
used_ex_Confusion Metric: 
 [[1017   43    6  243    0   25   13]
 [  14  883   24   31    0    2    4]
 [   0    1  234    0    0    0    1]
 [  16    6    0  879    0    2    0]
 [   3    8    0   26    7    0    0]
 [   0    0    2    1    0  105    7]
 [   0    1    0    2    0    0  237]]
np.mean(reliability_np):  0.6878103128268463
np.median(reliability_np):  0.6995106041431427
np.mean(c_reliability_np):  0.7275265437965633
np.median(c_reliability_np):  0.7630875706672668
np.mean(w_reliability_np):  0.5569102021399095
np.median(w_reliability_np):  0.5290010571479797
self.threshold:  0.7630875706672668
Accuracy:  0.7656480505795574
Confusion Metric: 
 [[3357  311    6  637   11   27   27]
 [ 255 1734   18  114    6    5    7]
 [  10   44  228    0    0    1    1]
 [ 213   45    1 1495   19    3    5]
 [ 111   61    0  144   58    2    8]
 [  30    8    3    7    0  122    8]
 [  38   11    0   16    0   11  272]]
Micro Precision/Recall/F-score:  (0.7656480505795574, 0.7656480505795574, 0.7656480505795574, None)
Macro Precision/Recall/F-score:  (0.7556351823450635, 0.6911536009293199, 0.7001214195628492, None)


epoch 12/40
model.reset
self.reset_num:  12
self.cheat:  False
self.mask_p:  2.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.6738672286617492
ex_Confusion Metric: 
 [[2477  291   57 1141   30  280  100]
 [ 132 1627  102  200    8   27   43]
 [   2   10  268    0    0    0    4]
 [ 135   71    8 1486   22   23   36]
 [  65   55    3  159   74    8   20]
 [   3    5    3   10    1  138   18]
 [   8    3    0    8    0    4  325]]
used_ex_acc:  0.8611971104231166
used_ex_Confusion Metric: 
 [[893  45   5 292   0  32  15]
 [  9 936  20  28   0   5   5]
 [  0   1 223   0   0   0   1]
 [ 10   5   0 932   0   3   3]
 [  3   6   0  32   6   0   4]
 [  0   0   2   3   0 105   7]
 [  0   0   0   2   0   0 243]]
np.mean(reliability_np):  0.6857781337956723
np.median(reliability_np):  0.696403443813324
np.mean(c_reliability_np):  0.7393249675713077
np.median(c_reliability_np):  0.7771057486534119
np.mean(w_reliability_np):  0.573022816297696
np.median(w_reliability_np):  0.550865888595581
self.threshold:  0.7771057486534119
Accuracy:  0.7709167544783984
Confusion Metric: 
 [[3511  238    5  528   12   58   24]
 [ 339 1639   15  120   12    6    8]
 [  14   41  224    1    0    1    3]
 [ 260   21    0 1471   17    5    7]
 [ 131   52    0  130   61    3    7]
 [  27    6    3    6    0  128    8]
 [  27    7    0   16    1   15  282]]
Micro Precision/Recall/F-score:  (0.7709167544783984, 0.7709167544783984, 0.7709167544783985, None)
Macro Precision/Recall/F-score:  (0.7433834677957526, 0.6959356857411463, 0.6986468548075858, None)


epoch 13/40
model.reset
self.reset_num:  13
self.cheat:  False
self.mask_p:  2.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.6684931506849315
ex_Confusion Metric: 
 [[2492  260   47 1122   23  338   94]
 [ 176 1579   91  208   10   39   36]
 [   4   14  264    0    0    0    2]
 [ 153   66    4 1480   16   32   30]
 [  78   52    2  157   70    7   18]
 [   5    4    3   10    1  139   16]
 [   9    4    0   10    1    4  320]]
used_ex_acc:  0.858659217877095
used_ex_Confusion Metric: 
 [[893  31   4 258   0  49  14]
 [ 10 786  16  28   0   5   4]
 [  0   1 208   0   0   0   1]
 [ 14   5   0 840   0   4   3]
 [  4   6   0  34   3   0   1]
 [  0   0   2   2   0 108   7]
 [  0   1   0   2   0   0 236]]
np.mean(reliability_np):  0.6833612272899399
np.median(reliability_np):  0.6921968758106232
np.mean(c_reliability_np):  0.7352162244627523
np.median(c_reliability_np):  0.7672030329704285
np.mean(w_reliability_np):  0.5704337084986795
np.median(w_reliability_np):  0.545271635055542
self.threshold:  0.7672030329704285
Accuracy:  0.7760800842992623
Confusion Metric: 
 [[3514  316   11  427   18   66   24]
 [ 275 1724   26   82   16    5   11]
 [   9   40  230    0    0    1    4]
 [ 282   54    0 1408   26    6    5]
 [ 114   72    0  118   68    3    9]
 [  24    8    3    3    1  131    8]
 [  30    9    0    6    0   13  290]]
Micro Precision/Recall/F-score:  (0.7760800842992623, 0.7760800842992623, 0.7760800842992623, None)
Macro Precision/Recall/F-score:  (0.7255719222047743, 0.7079712190023395, 0.702417184673038, None)


epoch 14/40
model.reset
self.reset_num:  14
self.cheat:  False
self.mask_p:  2.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.6542676501580611
ex_Confusion Metric: 
 [[2328  322   78 1027   24  481  116]
 [ 106 1603  139  192    8   43   48]
 [   2   11  268    0    0    0    3]
 [ 110   73    7 1476   17   55   43]
 [  53   67    8  148   68   14   26]
 [   1    6    3    8    0  143   17]
 [   7    1    1    7    0    9  323]]
used_ex_acc:  0.8521687813514311
used_ex_Confusion Metric: 
 [[670  38   6 245   0  48  17]
 [  5 783  27  32   0   6   5]
 [  0   1 225   0   0   0   1]
 [  7   5   0 852   0   6   3]
 [  1   5   0  28   6   0   4]
 [  0   0   2   1   0 108   7]
 [  0   0   0   1   0   0 244]]
np.mean(reliability_np):  0.6757922427805655
np.median(reliability_np):  0.6832707822322845
np.mean(c_reliability_np):  0.7155219180670543
np.median(c_reliability_np):  0.7431995868682861
np.mean(w_reliability_np):  0.5512316408398238
np.median(w_reliability_np):  0.5208272933959961
self.threshold:  0.7431995868682861
Accuracy:  0.7766069546891464
Confusion Metric: 
 [[3839  271   10  174   10   30   42]
 [ 368 1672   31   47    7    4   10]
 [  10   38  234    0    0    1    1]
 [ 525   65    1 1147   22    5   16]
 [ 172   81    1   58   59    0   13]
 [  36    8    3    1    0  121    9]
 [  36    9    1    2    0    2  298]]
Micro Precision/Recall/F-score:  (0.7766069546891464, 0.7766069546891464, 0.7766069546891464, None)
Macro Precision/Recall/F-score:  (0.7565207116002214, 0.6880950999847559, 0.7010028476168849, None)


epoch 15/40
model.reset
self.reset_num:  15
self.cheat:  False
self.mask_p:  2.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.6793466807165437
ex_Confusion Metric: 
 [[2684  296   72  899   16  279  130]
 [ 171 1568  137  180    7   31   45]
 [   4   11  266    0    0    0    3]
 [ 182   84    8 1401   19   37   50]
 [  82   77    6  126   65    5   23]
 [   3    7    3    8    0  138   19]
 [   9    3    0    6    0    5  325]]
used_ex_acc:  0.8685481820493263
used_ex_Confusion Metric: 
 [[1222   37    6  221    0   31   23]
 [  21  798   29   30    0    4    6]
 [   0    1  228    0    0    0    1]
 [  24    7    0  800    0    5    6]
 [  11    6    0   27    6    0    6]
 [   0    1    2    1    0  102    9]
 [   1    0    0    1    0    0  260]]
np.mean(reliability_np):  0.6771326962507818
np.median(reliability_np):  0.6858600974082947
np.mean(c_reliability_np):  0.7291830805072086
np.median(c_reliability_np):  0.7641115784645081
np.mean(w_reliability_np):  0.5514290706963669
np.median(w_reliability_np):  0.5211126208305359
self.threshold:  0.7641115784645081
Accuracy:  0.7825079030558483
Confusion Metric: 
 [[3744  331    7  211    7   49   27]
 [ 312 1726   17   61    7    5   11]
 [  10   53  219    0    0    1    1]
 [ 418   50    0 1283   12    8   10]
 [ 171   81    0   83   40    0    9]
 [  28    9    2    4    0  127    8]
 [  39   14    0    3    0    5  287]]
Micro Precision/Recall/F-score:  (0.7825079030558483, 0.7825079030558483, 0.7825079030558482, None)
Macro Precision/Recall/F-score:  (0.7570632059654142, 0.6851951449151764, 0.6945111165561222, None)


epoch 16/40
model.reset
self.reset_num:  16
self.cheat:  False
self.mask_p:  2.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.6804004214963119
ex_Confusion Metric: 
 [[2559  352   54  977   14  304  116]
 [ 130 1671   87  172    6   32   41]
 [   2   14  265    0    0    0    3]
 [ 146   88    5 1445   13   38   46]
 [  70   84    1  142   55   11   21]
 [   3    8    3    8    0  139   17]
 [   9    3    0    8    0    5  323]]
used_ex_acc:  0.8803119956966111
used_ex_Confusion Metric: 
 [[1007   42    4  204    0   38   15]
 [  11  883   15   23    0    3    6]
 [   0    1  214    0    0    0    1]
 [  12    5    0  813    0    4    3]
 [   8    9    0   25    3    0    3]
 [   0    1    1    1    0  104    7]
 [   1    1    0    1    0    0  249]]
np.mean(reliability_np):  0.6778407087174226
np.median(reliability_np):  0.6881175339221954
np.mean(c_reliability_np):  0.7320617004151275
np.median(c_reliability_np):  0.7676128149032593
np.mean(w_reliability_np):  0.55049869959558
np.median(w_reliability_np):  0.5175726413726807
self.threshold:  0.7676128149032593
Accuracy:  0.7778714436248683
Confusion Metric: 
 [[3580  443   14  217   41   30   51]
 [ 205 1824   25   50   21    4   10]
 [   5   51  226    0    0    0    2]
 [ 379   96    1 1226   61   10    8]
 [ 112  101    1   54  108    1    7]
 [  29   12    2    2    1  123    9]
 [  29   18    1    2    1    2  295]]
Micro Precision/Recall/F-score:  (0.7778714436248683, 0.7778714436248683, 0.7778714436248683, None)
Macro Precision/Recall/F-score:  (0.7326527361211946, 0.710706856076552, 0.716767017674869, None)


epoch 17/40
model.reset
self.reset_num:  17
self.cheat:  False
self.mask_p:  2.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.6879873551106428
ex_Confusion Metric: 
 [[2625  403   51  808   30  331  128]
 [ 113 1727   93  129   14   30   33]
 [   2   16  265    0    0    0    1]
 [ 169  122    5 1360   37   45   43]
 [  59  103    3   97   91    8   23]
 [   2    9    3    7    0  137   20]
 [   8    5    0    5    1    5  324]]
used_ex_acc:  0.8927387767399819
used_ex_Confusion Metric: 
 [[819  54   4 134   0  33  20]
 [  8 924  18  10   0   2   5]
 [  0   1 214   0   0   0   1]
 [ 12   7   0 646   0   5   3]
 [  2   8   0  16   8   0   1]
 [  0   1   1   1   0 101   8]
 [  0   0   0   1   0   0 251]]
np.mean(reliability_np):  0.671040863989804
np.median(reliability_np):  0.6783391535282135
np.mean(c_reliability_np):  0.7093285054726154
np.median(c_reliability_np):  0.7363985776901245
np.mean(w_reliability_np):  0.5336509112196973
np.median(w_reliability_np):  0.5003658533096313
self.threshold:  0.7363985776901245
Accuracy:  0.7658587987355111
Confusion Metric: 
 [[3351  497   11  327  117   37   36]
 [ 177 1815   21   61   57    2    6]
 [   7   55  220    0    1    0    1]
 [ 274   89    0 1321   88    5    4]
 [  79   81    0   59  159    1    5]
 [  32   11    3    4    2  116   10]
 [  29   22    2    3    4    2  286]]
Micro Precision/Recall/F-score:  (0.7658587987355111, 0.7658587987355111, 0.7658587987355112, None)
Macro Precision/Recall/F-score:  (0.7228631812530819, 0.7168925958066757, 0.7180006094626153, None)


epoch 18/40
model.reset
self.reset_num:  18
self.cheat:  False
self.mask_p:  2.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.6741833508956797
ex_Confusion Metric: 
 [[2459  443   57  954   44  311  108]
 [ 101 1727   92  150   13   29   27]
 [   3   16  263    0    0    0    2]
 [ 159  118    5 1391   41   34   33]
 [  44  100    2  105  105   10   18]
 [   3    7    3   10    1  135   19]
 [  10    5    1    8    2    4  318]]
used_ex_acc:  0.8700221238938053
used_ex_Confusion Metric: 
 [[ 787   74    4  205    0   27   17]
 [   7 1001   20   23    0    2    4]
 [   0    1  221    0    0    0    1]
 [  13    8    0  780    0    4    3]
 [   1   15    0   23   11    0    1]
 [   0    1    2    2    0   99    9]
 [   1    1    0    1    0    0  247]]
np.mean(reliability_np):  0.6683698171053686
np.median(reliability_np):  0.674258291721344
np.mean(c_reliability_np):  0.7075271223412338
np.median(c_reliability_np):  0.7308688163757324
np.mean(w_reliability_np):  0.5327346068921404
np.median(w_reliability_np):  0.49875979125499725
self.threshold:  0.7308688163757324
Accuracy:  0.7729188619599578
Confusion Metric: 
 [[3462  361    9  387  109   30   18]
 [ 230 1735   20   80   67    1    6]
 [   9   59  212    0    1    0    3]
 [ 262   51    0 1374   86    6    2]
 [  90   59    0   70  162    1    2]
 [  37   11    1    3    4  114    8]
 [  40   15    3    5    5    4  276]]
Micro Precision/Recall/F-score:  (0.7729188619599578, 0.7729188619599578, 0.772918861959958, None)
Macro Precision/Recall/F-score:  (0.7367290729707283, 0.7108062297327056, 0.7218323248785473, None)


epoch 19/40
model.reset
self.reset_num:  19
self.cheat:  False
self.mask_p:  2.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.6827186512118019
ex_Confusion Metric: 
 [[2543  375   57  991   46  276   88]
 [ 120 1690   95  164   17   26   27]
 [   1   15  265    0    0    0    3]
 [ 147   97    5 1429   39   37   27]
 [  53   86    4  113  104    7   17]
 [   4    8    3   11    1  137   14]
 [  13    6    1    9    2    6  311]]
used_ex_acc:  0.8650963597430407
used_ex_Confusion Metric: 
 [[897  53   4 258   0  30  13]
 [ 10 917  26  25   0   3   4]
 [  0   1 224   0   0   0   1]
 [ 15   7   0 843   0   4   1]
 [  2   7   0  26  10   0   0]
 [  0   0   2   2   0 102   7]
 [  1   1   0   1   0   0 239]]
np.mean(reliability_np):  0.6699048585211819
np.median(reliability_np):  0.6774401962757111
np.mean(c_reliability_np):  0.7081062825769531
np.median(c_reliability_np):  0.7296574711799622
np.mean(w_reliability_np):  0.5395713477574563
np.median(w_reliability_np):  0.5063241720199585
self.threshold:  0.7296574711799622
Accuracy:  0.764172813487882
Confusion Metric: 
 [[3309  308   10  634   58   21   36]
 [ 231 1687   39  116   55    4    7]
 [   6   38  236    0    1    0    3]
 [ 199   38    0 1502   34    3    5]
 [  84   59    0  123  110    2    6]
 [  32    8    4   10    2  112   10]
 [  32   10    1    7    0    2  296]]
Micro Precision/Recall/F-score:  (0.764172813487882, 0.764172813487882, 0.764172813487882, None)
Macro Precision/Recall/F-score:  (0.7276243042647162, 0.7122050284993098, 0.7142045437634854, None)


epoch 20/40
model.reset
self.reset_num:  20
self.cheat:  False
self.mask_p:  2.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.6660695468914647
ex_Confusion Metric: 
 [[2329  362   59 1251   39  238   98]
 [  97 1673  111  189   15   23   31]
 [   3   12  267    0    0    0    2]
 [  99   74    5 1524   25   26   28]
 [  45   77    4  151   84    6   17]
 [   4    8    3   15    1  128   19]
 [  11    4    0   12    2    3  316]]
used_ex_acc:  0.8473628129994673
used_ex_Confusion Metric: 
 [[780  46   4 327   0  14  15]
 [  8 890  29  34   0   2   4]
 [  0   1 227   0   0   0   1]
 [ 12   8   0 934   0   3   2]
 [  3  11   0  34   8   0   0]
 [  0   1   2   3   0  99   8]
 [  0   0   0   1   0   0 243]]
np.mean(reliability_np):  0.671893274353727
np.median(reliability_np):  0.6789878904819489
np.mean(c_reliability_np):  0.7103007001022319
np.median(c_reliability_np):  0.7320953011512756
np.mean(w_reliability_np):  0.5497488733880638
np.median(w_reliability_np):  0.5236803889274597
self.threshold:  0.7320953011512756
Accuracy:  0.7325605900948367
Confusion Metric: 
 [[2926  368   14  893   92   54   29]
 [ 184 1710   40  127   62    8    8]
 [   6   34  237    1    2    0    4]
 [ 128   41    0 1553   49    6    4]
 [  57   66    0  126  127    3    5]
 [  22    9    3    9    2  125    8]
 [  25   15    2   15    3   14  274]]
Micro Precision/Recall/F-score:  (0.7325605900948367, 0.7325605900948367, 0.7325605900948367, None)
Macro Precision/Recall/F-score:  (0.6863590675219798, 0.7135582729829688, 0.6924717639000505, None)


epoch 21/40
model.reset
self.reset_num:  21
self.cheat:  False
self.mask_p:  2.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.6389884088514225
ex_Confusion Metric: 
 [[2065  370   69 1447   45  294   86]
 [  97 1653  120  198   15   27   29]
 [   4   12  265    1    0    0    2]
 [  71   79    5 1550   26   26   24]
 [  31   85    4  149   89   10   16]
 [   2    8    3   19    1  131   14]
 [   9    5    0   15    3    5  311]]
used_ex_acc:  0.8187344570323294
used_ex_Confusion Metric: 
 [[544  43   4 425   0  22  11]
 [  7 857  30  32   0   2   4]
 [  0   1 228   0   0   0   1]
 [  7   8   0 991   0   1   3]
 [  1   7   0  32  11   0   1]
 [  0   0   2   2   0  99   7]
 [  0   0   0   3   0   0 233]]
np.mean(reliability_np):  0.6674074093758712
np.median(reliability_np):  0.671924889087677
np.mean(c_reliability_np):  0.7033738319327106
np.median(c_reliability_np):  0.7228807508945465
np.mean(w_reliability_np):  0.553460889760681
np.median(w_reliability_np):  0.5271586775779724
self.threshold:  0.7228807508945465
Accuracy:  0.7328767123287672
Confusion Metric: 
 [[2958  308   12  924   93   23   58]
 [ 195 1656   41  166   66    1   14]
 [   9   38  228    1    2    0    6]
 [ 136   20    0 1577   36    2   10]
 [  61   46    0  128  140    0    9]
 [  29    9    3   15    3  106   13]
 [  22    9    2   16    5    4  290]]
Micro Precision/Recall/F-score:  (0.7328767123287672, 0.7328767123287672, 0.7328767123287672, None)
Macro Precision/Recall/F-score:  (0.7037941941320573, 0.70455001759238, 0.6946915078847092, None)


epoch 22/40
model.reset
self.reset_num:  22
self.cheat:  False
self.mask_p:  2.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.6289778714436248
ex_Confusion Metric: 
 [[1941  425   71 1534   43  253  109]
 [  66 1650  103  247   17   22   34]
 [   1   13  266    1    0    0    3]
 [  61   70    5 1571   18   21   35]
 [  22   75    4  163   95    7   18]
 [   3    7    4   17    1  129   17]
 [   6    2    0   16    3    4  317]]
used_ex_acc:  0.8030949839914621
used_ex_Confusion Metric: 
 [[ 487   61    7  466    0   19   19]
 [   3  904   25   47    0    1    5]
 [   0    2  223    0    0    0    1]
 [   6    6    0 1049    0    1    4]
 [   1   10    0   37   10    0    1]
 [   0    0    2    2    0   91    9]
 [   0    0    0    3    0    0  246]]
np.mean(reliability_np):  0.66169716379643
np.median(reliability_np):  0.6635091006755829
np.mean(c_reliability_np):  0.705547702117249
np.median(c_reliability_np):  0.7254171967506409
np.mean(w_reliability_np):  0.5560416958483401
np.median(w_reliability_np):  0.5272206664085388
self.threshold:  0.7254171967506409
Accuracy:  0.7413066385669126
Confusion Metric: 
 [[3044  355   23  818   51   49   36]
 [ 195 1712   39  147   33    6    7]
 [   7   36  236    1    1    1    2]
 [ 154   40    0 1545   31    6    5]
 [  68   63    1  148   96    2    6]
 [  26    6    3   13    2  119    9]
 [  30   10    3   14    2    6  283]]
Micro Precision/Recall/F-score:  (0.7413066385669126, 0.7413066385669126, 0.7413066385669126, None)
Macro Precision/Recall/F-score:  (0.6957908451802461, 0.703745749169875, 0.6900844777175166, None)


epoch 23/40
model.reset
self.reset_num:  23
self.cheat:  False
self.mask_p:  2.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.6379346680716543
ex_Confusion Metric: 
 [[2110  332   61 1434   48  274  117]
 [ 107 1578  125  244   16   28   41]
 [   1   11  267    1    1    0    3]
 [  75   64    6 1555   19   25   37]
 [  32   61    7  157   98    8   21]
 [   4    4    3   19    2  127   19]
 [   7    2    1   14    1    4  319]]
used_ex_acc:  0.8236114987440692
used_ex_Confusion Metric: 
 [[641  40   4 393   0  23  18]
 [  7 777  29  35   0   2   5]
 [  0   1 225   0   0   0   1]
 [  6   5   0 961   0   3   3]
 [  1   5   0  33   8   0   2]
 [  0   0   2   2   0  99   9]
 [  1   0   0   2   0   0 240]]
np.mean(reliability_np):  0.6533007923466931
np.median(reliability_np):  0.6512279510498047
np.mean(c_reliability_np):  0.6997943291096629
np.median(c_reliability_np):  0.7174998223781586
np.mean(w_reliability_np):  0.546240829347662
np.median(w_reliability_np):  0.5154619514942169
self.threshold:  0.7174998223781586
Accuracy:  0.7517386722866175
Confusion Metric: 
 [[3190  312   11  734   44   48   37]
 [ 243 1649   41  150   44    6    6]
 [   7   30  243    2    0    1    1]
 [ 167   29    0 1551   23    8    3]
 [  85   63    0  130   98    2    6]
 [  26    7    3    9    1  122   10]
 [  24   14    1   17    3    8  281]]
Micro Precision/Recall/F-score:  (0.7517386722866175, 0.7517386722866175, 0.7517386722866175, None)
Macro Precision/Recall/F-score:  (0.7070976898598186, 0.7106375645721968, 0.7000857714960542, None)


epoch 24/40
model.reset
self.reset_num:  24
self.cheat:  False
self.mask_p:  2.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.6329820864067439
ex_Confusion Metric: 
 [[2083  313   63 1319   33  458  107]
 [ 110 1569  120  235   15   55   35]
 [   3    9  268    1    0    0    3]
 [  72   68    7 1541   18   39   36]
 [  40   66    6  151   88   14   19]
 [   5    4    3   10    1  138   17]
 [   7    3    0   11    2    5  320]]
used_ex_acc:  0.8124152886961236
used_ex_Confusion Metric: 
 [[642  40   6 390   0  64  22]
 [  7 775  29  43   0   6   4]
 [  0   1 232   0   0   0   1]
 [  9   7   0 986   0   4   3]
 [  1   4   0  32   9   0   3]
 [  0   0   2   3   0 109   9]
 [  0   0   0   2   0   0 244]]
np.mean(reliability_np):  0.6545021101754374
np.median(reliability_np):  0.652748703956604
np.mean(c_reliability_np):  0.6994250250850955
np.median(c_reliability_np):  0.7169025540351868
np.mean(w_reliability_np):  0.5465943084566065
np.median(w_reliability_np):  0.5179665684700012
self.threshold:  0.7169025540351868
Accuracy:  0.7609062170706006
Confusion Metric: 
 [[3283  561   10  389   83   30   20]
 [ 162 1861   24   58   26    4    4]
 [   8   47  227    1    1    0    0]
 [ 260   97    0 1352   66    4    2]
 [  81  112    0   72  117    1    1]
 [  34   11    2    3    1  118    9]
 [  37   23    4    8    4    9  263]]
Micro Precision/Recall/F-score:  (0.7609062170706006, 0.7609062170706006, 0.7609062170706005, None)
Macro Precision/Recall/F-score:  (0.726696747105529, 0.7002910116798323, 0.7097283103882531, None)


epoch 25/40
model.reset
self.reset_num:  25
self.cheat:  False
self.mask_p:  2.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.6649104320337197
ex_Confusion Metric: 
 [[2350  454   63 1069   46  307   87]
 [  79 1724  100  162   15   35   24]
 [   2   15  265    1    0    0    1]
 [ 132  118    7 1431   36   25   32]
 [  45  100    6  115   94    9   15]
 [   5    9    3   12    1  131   17]
 [  11    4    1   11    3    3  315]]
used_ex_acc:  0.8574549426542872
used_ex_Confusion Metric: 
 [[ 734   80    7  248    0   34   13]
 [   5 1007   30   22    0    3    4]
 [   0    1  229    0    0    0    0]
 [  14   12    0  826    0    3    0]
 [   2   10    0   20   10    0    0]
 [   0    0    1    1    0  101    9]
 [   1    1    0    1    0    0  233]]
np.mean(reliability_np):  0.6552440661315134
np.median(reliability_np):  0.654848724603653
np.mean(c_reliability_np):  0.6964545980733472
np.median(c_reliability_np):  0.7149426639080048
np.mean(w_reliability_np):  0.5267177680612735
np.median(w_reliability_np):  0.49763351678848267
self.threshold:  0.7149426639080048
Accuracy:  0.7727081138040042
Confusion Metric: 
 [[3403  403   14  454   40   29   33]
 [ 203 1806   30   83    7    3    7]
 [   6   40  236    0    1    0    1]
 [ 269   63    1 1411   28    4    5]
 [ 100   97    0   96   82    3    6]
 [  34   12    2    8    0  114    8]
 [  32   20    3    9    0    3  281]]
Micro Precision/Recall/F-score:  (0.7727081138040042, 0.7727081138040042, 0.7727081138040043, None)
Macro Precision/Recall/F-score:  (0.7377611326253538, 0.7009529181530324, 0.7085925756528664, None)


epoch 26/40
model.reset
self.reset_num:  26
self.cheat:  False
self.mask_p:  2.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.6654373024236038
ex_Confusion Metric: 
 [[2358  363   63 1127   26  301  138]
 [ 101 1680  103  177    7   35   36]
 [   2   14  264    1    0    0    3]
 [ 107   95    7 1480   18   33   41]
 [  47   85    8  134   77    6   27]
 [   3    4    3   11    1  134   22]
 [   8    3    1    9    2    3  322]]
used_ex_acc:  0.854753053637812
used_ex_Confusion Metric: 
 [[786  60   8 274   0  32  20]
 [  9 969  27  27   0   5   5]
 [  0   1 230   0   0   0   1]
 [ 12   6   0 880   0   3   3]
 [  2  12   0  24   4   0   2]
 [  0   0   1   2   0  97   9]
 [  0   1   0   1   0   0 253]]
np.mean(reliability_np):  0.6544030614611831
np.median(reliability_np):  0.655495285987854
np.mean(c_reliability_np):  0.7011966465393513
np.median(c_reliability_np):  0.7210459113121033
np.mean(w_reliability_np):  0.5338469859887296
np.median(w_reliability_np):  0.5066301226615906
self.threshold:  0.7210459113121033
Accuracy:  0.7710221285563751
Confusion Metric: 
 [[3449  293   11  517   61   12   33]
 [ 255 1694   26  109   49    1    5]
 [  12   34  236    1    1    0    0]
 [ 249   44    0 1436   45    4    3]
 [ 103   59    1   97  118    1    5]
 [  43   11    4    6    2  102   10]
 [  37   17    4    4    1    3  282]]
Micro Precision/Recall/F-score:  (0.7710221285563751, 0.7710221285563751, 0.7710221285563751, None)
Macro Precision/Recall/F-score:  (0.7438387082883693, 0.7011523263524789, 0.7166519951347506, None)


epoch 27/40
model.reset
self.reset_num:  27
self.cheat:  False
self.mask_p:  2.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.6827186512118019
ex_Confusion Metric: 
 [[2522  345   53 1141   34  198   83]
 [ 116 1664   94  200   10   25   30]
 [   4   13  262    1    1    0    3]
 [ 128   80    6 1495   20   22   30]
 [  48   84    3  140   88    6   15]
 [   4    4    4   15    1  132   18]
 [  10    3    1   13    3    2  316]]
used_ex_acc:  0.8642568250758341
used_ex_Confusion Metric: 
 [[1001   49    5  303    0   14   15]
 [  11  945   20   31    0    1    3]
 [   0    1  223    0    0    0    0]
 [  15    9    0  904    0    1    3]
 [   4   11    0   27   10    0    1]
 [   0    0    2    1    0   96    9]
 [   1    0    0    0    0    0  240]]
np.mean(reliability_np):  0.6550903426623658
np.median(reliability_np):  0.6553211510181427
np.mean(c_reliability_np):  0.7102764658233158
np.median(c_reliability_np):  0.7384957671165466
np.mean(w_reliability_np):  0.5433254597027489
np.median(w_reliability_np):  0.5159317851066589
self.threshold:  0.7384957671165466
Accuracy:  0.7731296101159115
Confusion Metric: 
 [[3487  304   14  424   63   58   26]
 [ 266 1689   34   97   37    9    7]
 [   9   33  237    1    2    0    2]
 [ 277   43    0 1397   43   10   11]
 [ 101   65    0   88  117    4    9]
 [  35    6    4    3    2  120    8]
 [  30   14    3    5    1    5  290]]
Micro Precision/Recall/F-score:  (0.7731296101159115, 0.7731296101159115, 0.7731296101159114, None)
Macro Precision/Recall/F-score:  (0.7091258555820555, 0.7167919605887603, 0.7102124097273685, None)


epoch 28/40
model.reset
self.reset_num:  28
self.cheat:  False
self.mask_p:  2.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.6554267650158061
ex_Confusion Metric: 
 [[2352  329   66 1017   49  441  122]
 [ 102 1600  121  204   19   43   50]
 [   3   11  264    0    1    0    5]
 [ 134   73    7 1438   35   46   48]
 [  44   75    6  116  107   12   24]
 [   2    5    3   10    1  138   19]
 [   9    2    1    7    3    5  321]]
used_ex_acc:  0.86176
used_ex_Confusion Metric: 
 [[658  35   8 189   0  38  17]
 [  8 729  30  35   0   4   6]
 [  0   1 225   0   0   0   1]
 [  9   6   0 729   0   4   2]
 [  2   4   0  17  10   0   4]
 [  0   0   2   1   0  97   9]
 [  0   0   0   0   0   0 245]]
np.mean(reliability_np):  0.6472424290757673
np.median(reliability_np):  0.643067866563797
np.mean(c_reliability_np):  0.6826684798506295
np.median(c_reliability_np):  0.6940474510192871
np.mean(w_reliability_np):  0.5152438443962951
np.median(w_reliability_np):  0.4826803654432297
self.threshold:  0.6940474510192871
Accuracy:  0.7770284510010538
Confusion Metric: 
 [[3533  305    8  409   83   18   20]
 [ 239 1716   26   94   57    3    4]
 [  10   47  222    0    2    1    2]
 [ 269   42    1 1389   74    5    1]
 [ 107   57    0   71  147    0    2]
 [  48    9    3    3    3  104    8]
 [  43   18    3   14    3    4  263]]
Micro Precision/Recall/F-score:  (0.7770284510010538, 0.7770284510010538, 0.7770284510010538, None)
Macro Precision/Recall/F-score:  (0.7435222126733557, 0.6991458172508874, 0.7183348875535126, None)


epoch 29/40
model.reset
self.reset_num:  29
self.cheat:  False
self.mask_p:  2.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.6713382507903056
ex_Confusion Metric: 
 [[2448  346   55 1060   42  310  115]
 [ 104 1661  101  190   12   35   36]
 [   2   15  261    1    1    0    4]
 [ 130   82    8 1456   31   36   38]
 [  51   78    4  123   97    9   22]
 [   6    5    3   12    2  131   19]
 [  10    2    1   14    2    2  317]]
used_ex_acc:  0.854661558109834
used_ex_Confusion Metric: 
 [[904  62   7 288   0  28  17]
 [  7 969  26  34   0   2   5]
 [  0   1 229   0   0   0   1]
 [ 16   9   0 888   1   4   5]
 [  4   6   0  27  14   0   2]
 [  0   0   2   2   0  93   9]
 [  1   0   0   3   0   0 249]]
np.mean(reliability_np):  0.6507914034727066
np.median(reliability_np):  0.6513124704360962
np.mean(c_reliability_np):  0.6920702632752267
np.median(c_reliability_np):  0.7113938331604004
np.mean(w_reliability_np):  0.52278630728808
np.median(w_reliability_np):  0.493297278881073
self.threshold:  0.7113938331604004
Accuracy:  0.780400421496312
Confusion Metric: 
 [[3616  359   10  291   67    9   24]
 [ 232 1778   31   58   35    0    5]
 [   9   37  236    0    1    0    1]
 [ 362   77    1 1266   70    3    2]
 [ 110   83    0   50  139    0    2]
 [  47   10    3    4    2  101   11]
 [  42   18    4    7    5    2  270]]
Micro Precision/Recall/F-score:  (0.780400421496312, 0.780400421496312, 0.780400421496312, None)
Macro Precision/Recall/F-score:  (0.7608289012441737, 0.7006620639943806, 0.7248179295692572, None)


epoch 30/40
model.reset
self.reset_num:  30
self.cheat:  False
self.mask_p:  2.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.679768177028451
ex_Confusion Metric: 
 [[2534  342   62 1041   34  256  107]
 [ 117 1663  109  176   11   30   33]
 [   2   15  263    1    0    0    3]
 [ 146   90    8 1446   32   23   36]
 [  51   79    7  128   95    6   18]
 [   5    4    3   12    1  133   20]
 [  10    3    2    9    3    4  317]]
used_ex_acc:  0.8684348739495799
used_ex_Confusion Metric: 
 [[947  50   8 247   0  22  17]
 [ 12 929  29  23   0   2   5]
 [  0   1 228   0   0   0   1]
 [ 17  10   0 849   0   3   4]
 [  4   7   0  22  10   0   2]
 [  0   0   2   1   0  95  10]
 [  0   0   0   2   0   0 249]]
np.mean(reliability_np):  0.6504764273784475
np.median(reliability_np):  0.6498025357723236
np.mean(c_reliability_np):  0.6984929305105279
np.median(c_reliability_np):  0.7193423509597778
np.mean(w_reliability_np):  0.5262273049111349
np.median(w_reliability_np):  0.49794530868530273
self.threshold:  0.7193423509597778
Accuracy:  0.7785036880927292
Confusion Metric: 
 [[3601  434   16  222   49   29   25]
 [ 196 1837   43   33   21    5    4]
 [   8   32  243    0    1    0    0]
 [ 396  115    1 1200   61    4    4]
 [ 108  108    0   47  113    4    4]
 [  37   11    3    4    1  114    8]
 [  35   17    4    5    3    4  280]]
Micro Precision/Recall/F-score:  (0.7785036880927292, 0.7785036880927292, 0.7785036880927292, None)
Macro Precision/Recall/F-score:  (0.7353032984884281, 0.707205814870013, 0.7165998734686984, None)


epoch 31/40
model.reset
self.reset_num:  31
self.cheat:  False
self.mask_p:  2.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.676923076923077
ex_Confusion Metric: 
 [[2510  398   70  933   29  317  119]
 [  95 1709  120  139    7   34   35]
 [   1   13  268    1    0    0    1]
 [ 157  126    8 1396   22   33   39]
 [  45   96    8  115   87   12   21]
 [   4    4    4   10    1  134   21]
 [   9    4    1    8    3    3  320]]
used_ex_acc:  0.8854314002828855
used_ex_Confusion Metric: 
 [[857  61   8 163   0  29  16]
 [  8 955  26   8   0   3   5]
 [  0   2 231   0   0   0   0]
 [ 19   9   0 735   0   4   3]
 [  3  12   0  13   9   0   1]
 [  0   0   1   1   0  96   9]
 [  0   0   0   1   0   0 247]]
np.mean(reliability_np):  0.6516748928295649
np.median(reliability_np):  0.651108056306839
np.mean(c_reliability_np):  0.694071730009627
np.median(c_reliability_np):  0.7116741240024567
np.mean(w_reliability_np):  0.5169497128024415
np.median(w_reliability_np):  0.4906368851661682
self.threshold:  0.7116741240024567
Accuracy:  0.7822971548998946
Confusion Metric: 
 [[3672  245    6  352   57   19   25]
 [ 323 1649   22   91   46    3    5]
 [  15   35  230    1    2    0    1]
 [ 333   34    0 1366   40    3    5]
 [ 118   60    0   81  121    1    3]
 [  39    7    2    6    3  113    8]
 [  43   17    2    6    3    4  273]]
Micro Precision/Recall/F-score:  (0.7822971548998946, 0.7822971548998946, 0.7822971548998947, None)
Macro Precision/Recall/F-score:  (0.7568156999398139, 0.7030436940392607, 0.7265240906464028, None)


epoch 32/40
model.reset
self.reset_num:  32
self.cheat:  False
self.mask_p:  2.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.679241306638567
ex_Confusion Metric: 
 [[2494  316   49 1062   42  303  110]
 [ 120 1660   95  187   12   35   30]
 [   3   15  263    1    1    0    1]
 [ 134   79    7 1473   23   30   35]
 [  43   79    5  128  105    7   17]
 [   5    3    3   11    2  134   20]
 [   9    3    1   10    4    4  317]]
used_ex_acc:  0.8685574038723752
used_ex_Confusion Metric: 
 [[911  42   6 252   0  27  15]
 [ 10 856  20  26   0   3   5]
 [  0   1 224   0   0   0   1]
 [ 16   6   0 835   0   3   4]
 [  3   6   0  20  13   0   2]
 [  0   0   1   2   0  98   9]
 [  1   0   0   1   0   0 248]]
np.mean(reliability_np):  0.6519420049108476
np.median(reliability_np):  0.6517437696456909
np.mean(c_reliability_np):  0.6915078884533314
np.median(c_reliability_np):  0.7070259749889374
np.mean(w_reliability_np):  0.5213590316650667
np.median(w_reliability_np):  0.49280016124248505
self.threshold:  0.7070259749889374
Accuracy:  0.7807165437302424
Confusion Metric: 
 [[3641  284    9  325   47   45   25]
 [ 306 1689   32   72   28    6    6]
 [  11   32  238    0    2    0    1]
 [ 341   48    1 1331   47    7    6]
 [ 121   73    0   68  114    4    4]
 [  33    6    2    5    3  121    8]
 [  40   16    3    4    3    7  275]]
Micro Precision/Recall/F-score:  (0.7807165437302424, 0.7807165437302424, 0.7807165437302422, None)
Macro Precision/Recall/F-score:  (0.7313396351156392, 0.7105572862257368, 0.7179735231592205, None)


epoch 33/40
model.reset
self.reset_num:  33
self.cheat:  False
self.mask_p:  2.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.6723919915700738
ex_Confusion Metric: 
 [[2451  331   66 1020   32  352  124]
 [ 108 1654  112  181    9   41   34]
 [   3   12  265    1    1    0    2]
 [ 133   83    6 1455   23   40   41]
 [  48   81    7  120   98    9   21]
 [   4    4    3   10    1  136   20]
 [   9    2    1    9    1    4  322]]
used_ex_acc:  0.8651776103336921
used_ex_Confusion Metric: 
 [[900  45   7 240   0  37  21]
 [ 10 897  24  25   0   4   5]
 [  0   1 233   0   0   0   1]
 [ 17   7   0 822   0   5   4]
 [  3   8   0  22   9   0   2]
 [  0   0   1   2   0 101   9]
 [  0   0   0   1   0   0 253]]
np.mean(reliability_np):  0.6520405436390743
np.median(reliability_np):  0.6523452401161194
np.mean(c_reliability_np):  0.6922176113800838
np.median(c_reliability_np):  0.7090896964073181
np.mean(w_reliability_np):  0.5196643644646074
np.median(w_reliability_np):  0.4901880621910095
self.threshold:  0.7090896964073181
Accuracy:  0.7814541622760801
Confusion Metric: 
 [[3638  277    8  329   54   42   28]
 [ 301 1689   31   73   33    6    6]
 [  11   31  239    0    2    0    1]
 [ 337   48    1 1333   51    5    6]
 [ 120   65    0   69  121    4    5]
 [  32    5    2    5    3  123    8]
 [  41   16    4    4    3    7  273]]
Micro Precision/Recall/F-score:  (0.7814541622760801, 0.7814541622760801, 0.7814541622760801, None)
Macro Precision/Recall/F-score:  (0.7320401527639556, 0.7145110760952232, 0.7213071488540603, None)


epoch 34/40
model.reset
self.reset_num:  34
self.cheat:  False
self.mask_p:  2.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.6730242360379347
ex_Confusion Metric: 
 [[2460  336   63 1016   35  344  122]
 [ 110 1654  110  178   12   40   35]
 [   3   12  265    1    1    0    2]
 [ 137   84    7 1451   25   38   39]
 [  44   82    7  121  100    9   21]
 [   4    4    3   10    1  136   20]
 [   9    2    1    9    2    4  321]]
used_ex_acc:  0.8675155784340287
used_ex_Confusion Metric: 
 [[898  45   6 236   0  35  21]
 [  9 895  24  25   0   3   5]
 [  0   1 233   0   0   0   1]
 [ 17   6   0 814   0   4   4]
 [  3   8   0  21   9   0   2]
 [  0   0   1   2   0 100   9]
 [  0   0   0   1   0   0 253]]
np.mean(reliability_np):  0.6549794524522519
np.median(reliability_np):  0.6570282280445099
np.mean(c_reliability_np):  0.6923674531916749
np.median(c_reliability_np):  0.7106015086174011
np.mean(w_reliability_np):  0.5192334504087932
np.median(w_reliability_np):  0.4898577332496643
self.threshold:  0.7106015086174011
Accuracy:  0.7802950474183351
Confusion Metric: 
 [[3617  296    8  335   52   42   26]
 [ 294 1703   28   72   30    6    6]
 [  10   34  237    0    2    0    1]
 [ 331   50    1 1338   51    5    5]
 [ 118   73    0   70  117    2    4]
 [  31    8    2    5    2  122    8]
 [  40   16    3    6    3    9  271]]
Micro Precision/Recall/F-score:  (0.7802950474183351, 0.7802950474183351, 0.7802950474183351, None)
Macro Precision/Recall/F-score:  (0.7333234378770139, 0.7110438759302966, 0.7197752440137402, None)


epoch 35/40
model.reset
self.reset_num:  35
self.cheat:  False
self.mask_p:  2.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.673445732349842
ex_Confusion Metric: 
 [[2463  344   61 1013   35  339  121]
 [ 107 1663  107  174   12   40   36]
 [   3   13  264    1    1    0    2]
 [ 138   84    7 1451   27   36   38]
 [  45   85    7  121   97    9   20]
 [   4    4    3   12    1  134   20]
 [   9    2    1   10    3    4  319]]
used_ex_acc:  0.8689636462289745
used_ex_Confusion Metric: 
 [[897  49   6 233   0  33  20]
 [  9 905  23  23   0   3   5]
 [  0   1 231   0   0   0   1]
 [ 16   6   0 809   0   4   3]
 [  3   8   0  22   9   0   2]
 [  0   0   1   2   0 102   9]
 [  0   0   0   1   0   0 250]]
np.mean(reliability_np):  0.6558497847478238
np.median(reliability_np):  0.6586810648441315
np.mean(c_reliability_np):  0.6936374015090724
np.median(c_reliability_np):  0.7110841870307922
np.mean(w_reliability_np):  0.5198719985121948
np.median(w_reliability_np):  0.49096164107322693
self.threshold:  0.7110841870307922
Accuracy:  0.7810326659641729
Confusion Metric: 
 [[3619  293    9  338   52   39   26]
 [ 291 1699   30   76   31    5    7]
 [  10   34  237    0    2    0    1]
 [ 325   50    1 1346   51    4    4]
 [ 118   73    0   70  117    2    4]
 [  31    7    2    5    3  122    8]
 [  42   17    4    4    2    7  272]]
Micro Precision/Recall/F-score:  (0.7810326659641729, 0.7810326659641729, 0.781032665964173, None)
Macro Precision/Recall/F-score:  (0.7352631312879033, 0.7118942227003682, 0.7212768922309685, None)


epoch 36/40
model.reset
self.reset_num:  36
self.cheat:  False
self.mask_p:  2.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.673445732349842
ex_Confusion Metric: 
 [[2459  345   62 1025   37  327  121]
 [ 105 1664  105  178   13   39   35]
 [   3   12  265    1    1    0    2]
 [ 139   84    7 1452   27   33   39]
 [  43   83    7  123   98    9   21]
 [   4    4    3   12    1  134   20]
 [   9    2    1   10    3    4  319]]
used_ex_acc:  0.8671536796536796
used_ex_Confusion Metric: 
 [[893  48   6 238   0  32  20]
 [  9 904  24  26   0   3   5]
 [  0   1 231   0   0   0   1]
 [ 16   6   0 817   0   4   3]
 [  3   8   0  23   9   0   2]
 [  0   0   1   2   0  99   9]
 [  0   0   0   1   0   0 252]]
np.mean(reliability_np):  0.6571146006241548
np.median(reliability_np):  0.6606906056404114
np.mean(c_reliability_np):  0.6944148899304476
np.median(c_reliability_np):  0.712794303894043
np.mean(w_reliability_np):  0.5214347221046234
np.median(w_reliability_np):  0.4919949173927307
self.threshold:  0.712794303894043
Accuracy:  0.780927291886196
Confusion Metric: 
 [[3608  293    9  348   51   41   26]
 [ 287 1704   28   76   32    5    7]
 [  12   33  236    1    2    0    0]
 [ 320   50    0 1353   50    4    4]
 [ 118   71    0   71  118    2    4]
 [  31    7    2    5    3  122    8]
 [  42   17    4    5    2    8  270]]
Micro Precision/Recall/F-score:  (0.780927291886196, 0.780927291886196, 0.780927291886196, None)
Macro Precision/Recall/F-score:  (0.7354121686379828, 0.7114785254743253, 0.721041754404462, None)


epoch 37/40
model.reset
self.reset_num:  37
self.cheat:  False
self.mask_p:  2.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.673445732349842
ex_Confusion Metric: 
 [[2456  349   61 1025   37  326  122]
 [ 103 1665  105  178   13   39   36]
 [   3   13  264    1    1    0    2]
 [ 136   85    6 1455   27   34   38]
 [  42   84    7  123   98    9   21]
 [   4    4    3   12    1  134   20]
 [   9    2    1   10    3    4  319]]
used_ex_acc:  0.867627072574069
used_ex_Confusion Metric: 
 [[883  48   6 238   0  32  19]
 [  9 902  22  26   0   3   5]
 [  0   1 229   0   0   0   0]
 [ 16   6   0 819   0   4   3]
 [  3   8   0  23   9   0   2]
 [  0   0   1   2   0  99   9]
 [  0   0   0   1   0   0 251]]
np.mean(reliability_np):  0.6575262448741932
np.median(reliability_np):  0.6610097885131836
np.mean(c_reliability_np):  0.6942724682480456
np.median(c_reliability_np):  0.7124664783477783
np.mean(w_reliability_np):  0.5222692668976496
np.median(w_reliability_np):  0.49395427107810974
self.threshold:  0.7124664783477783
Accuracy:  0.7807165437302424
Confusion Metric: 
 [[3605  293    9  353   50   40   26]
 [ 288 1703   28   76   32    5    7]
 [  12   33  236    1    2    0    0]
 [ 318   50    0 1356   49    4    4]
 [ 117   71    0   72  118    2    4]
 [  31    7    2    5    3  122    8]
 [  43   17    4    5    2    8  269]]
Micro Precision/Recall/F-score:  (0.7807165437302424, 0.7807165437302424, 0.7807165437302422, None)
Macro Precision/Recall/F-score:  (0.7361055705889711, 0.7111439280390826, 0.7211089412234414, None)


epoch 38/40
model.reset
self.reset_num:  38
self.cheat:  False
self.mask_p:  2.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.6733403582718651
ex_Confusion Metric: 
 [[2456  348   61 1025   38  326  122]
 [ 102 1664  105  180   13   39   36]
 [   3   14  263    1    1    0    2]
 [ 136   85    6 1455   27   34   38]
 [  42   85    7  123   98    8   21]
 [   4    4    3   12    1  134   20]
 [   9    2    1   10    2    4  320]]
used_ex_acc:  0.8666666666666667
used_ex_Confusion Metric: 
 [[884  49   6 240   0  32  20]
 [  9 908  22  27   0   3   5]
 [  0   1 229   0   0   0   0]
 [ 16   6   0 817   0   4   3]
 [  3   8   0  23  10   0   2]
 [  0   0   1   2   0  99   9]
 [  0   0   0   1   0   0 251]]
np.mean(reliability_np):  0.6577320254601617
np.median(reliability_np):  0.6610310971736908
np.mean(c_reliability_np):  0.6943181433867961
np.median(c_reliability_np):  0.7127694487571716
np.mean(w_reliability_np):  0.5227403247404483
np.median(w_reliability_np):  0.4939545691013336
self.threshold:  0.7127694487571716
Accuracy:  0.7806111696522655
Confusion Metric: 
 [[3602  293    9  357   51   39   25]
 [ 288 1704   28   76   31    5    7]
 [  11   34  236    1    2    0    0]
 [ 317   51    0 1357   49    4    3]
 [ 118   70    0   72  119    1    4]
 [  32    7    2    5    3  121    8]
 [  43   17    4    5    3    7  269]]
Micro Precision/Recall/F-score:  (0.7806111696522655, 0.7806111696522655, 0.7806111696522655, None)
Macro Precision/Recall/F-score:  (0.738027048556285, 0.7107624454742882, 0.7219159573006214, None)


epoch 39/40
model.reset
self.reset_num:  39
self.cheat:  False
self.mask_p:  2.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.6741833508956797
ex_Confusion Metric: 
 [[2464  348   61 1025   38  318  122]
 [ 102 1669  104  176   13   39   36]
 [   3   14  263    1    1    0    2]
 [ 139   86    6 1451   28   34   37]
 [  43   85    7  123   98    8   20]
 [   5    4    3   12    1  133   20]
 [   9    2    1   10    2    4  320]]
used_ex_acc:  0.8676071622354856
used_ex_Confusion Metric: 
 [[887  49   6 240   0  30  19]
 [  9 906  22  27   0   3   5]
 [  0   1 230   0   0   0   0]
 [ 16   6   0 814   0   4   3]
 [  3   8   0  22  12   0   2]
 [  0   0   1   2   0  99   9]
 [  0   0   0   1   0   0 250]]
np.mean(reliability_np):  0.6581146928986257
np.median(reliability_np):  0.661619246006012
np.mean(c_reliability_np):  0.6947049560883001
np.median(c_reliability_np):  0.7127596437931061
np.mean(w_reliability_np):  0.5227938898119782
np.median(w_reliability_np):  0.4946894496679306
self.threshold:  0.7127596437931061
Accuracy:  0.7799789251844046
Confusion Metric: 
 [[3604  295    9  356   51   36   25]
 [ 287 1703   29   77   32    5    6]
 [  11   36  234    1    2    0    0]
 [ 321   52    0 1351   50    4    3]
 [ 117   70    0   72  120    1    4]
 [  33    7    2    5    3  120    8]
 [  43   17    4    5    3    6  270]]
Micro Precision/Recall/F-score:  (0.7799789251844046, 0.7799789251844046, 0.7799789251844046, None)
Macro Precision/Recall/F-score:  (0.739219737565503, 0.7092536076408352, 0.721846435432477, None)
best_epoch:  9 0.7314563106531791 0.7657534246575343


test print 
Accuracy:  0.7426878466969239
Confusion Metric: 
 [[2890  252    8  299   41   28   22]
 [ 254 1333   26   58   40    6   16]
 [  16   71  231    1    1    3    0]
 [ 413   70    3 1044   30    7   10]
 [ 106   72    2   56   70    3    7]
 [  50    9    1    4    0  133   10]
 [  18    8    2    9    3    6  190]]
Micro Precision/Recall/F-score:  (0.7426878466969239, 0.7426878466969239, 0.7426878466969239, None)
Macro Precision/Recall/F-score:  (0.700017751508639, 0.6616961626892961, 0.6764323447195721, None)
test f1:   0.6764323447195721 [0.6764323447195721]
test ass:  0.7426878466969239 [0.7426878466969239]
valid f1:  0.7314563106531791 [0.7314563106531791]
valid acc: 0.7657534246575343 [0.7657534246575343]
