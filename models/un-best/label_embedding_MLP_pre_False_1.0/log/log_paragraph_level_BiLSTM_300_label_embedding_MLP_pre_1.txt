['/home/lizhuoqun/SE_type_code', '/home/lizhuoqun/anconda/envs/py38/lib/python38.zip', '/home/lizhuoqun/anconda/envs/py38/lib/python3.8', '/home/lizhuoqun/anconda/envs/py38/lib/python3.8/lib-dynload', '/home/lizhuoqun/anconda/envs/py38/lib/python3.8/site-packages', '/home/lizhuoqun/SE_type_code/data', '/home/lizhuoqun/SE_type_code/models', '/home/lizhuoqun/SE_type_code/tools', '/home/lizhuoqun/SE_type_code/resource', '/home/lizhuoqun/SE_type_code/pre_train']
sentence level BiLSTM extra
___________****************************************** 300 ********************************************************************************
paragraph level BiLSTM label embedding MLP pre
Namespace(BATCH_SIZE=128, DROPOUT=0.5, EPOCHs=40, LEARN_RATE=0.001, WEIGHT_DECAY=0.0001, cheat='False', fold_num=1, mask_p=1.0)




time= 0
self.BiLSTM_1_require_grad:  True
self.cheat:  False
self.mask_p:  1.0
self.threshold:  0.8
start to get stanford
already get stanford
start get bert_tokenizer
get bert tokenizer
if_do_embedding:  True
start read data catalogue
start get train data
already deal 10 file
already deal 20 file
already deal 30 file
already deal 40 file
already deal 50 file
already deal 60 file
already deal 70 file
already deal 80 file
already deal 90 file
already deal 100 file
already deal 110 file
already deal 120 file
already deal 130 file
already deal 140 file
already deal 150 file
already deal 160 file
already deal 170 file
already deal 180 file
already deal 190 file
already deal 200 file
already deal 210 file
already deal 220 file
already deal 230 file
already deal 240 file
already deal 250 file
already deal 260 file
already deal 270 file
already deal 280 file
len(train_valid_data_list):  3368
already deal 10 file
already deal 20 file
already deal 30 file
already deal 40 file
already deal 50 file
already deal 60 file
already deal 70 file
already deal 80 file
complete get data, len(test_data_list):  919


start sentence level BiLSTM  extra


epoch 0/4


epoch 1/4


epoch 2/4


epoch 3/4
sentence level BiLSTM  extra best_epoch:  3 -1 -1
sentence level BiLSTM  extra end

********************************************


epoch 0/40
model.reset
self.reset_num:  0
self.cheat:  False
self.mask_p:  1.0
self.valid_flag:  False
self.BiLSTM_1_require_grad:  True
Accuracy:  0.8905836246160365
Confusion Metric: 
 [[4113   18    0  118   16    3    1]
 [ 166 2061    0    8    3    0    0]
 [  31   10  321    1    1    2    0]
 [ 231    2    0 1391   13    0    0]
 [ 247    7    0   49   56    0    2]
 [  62    3    0    2    0  175    0]
 [  29    1    0    6    1    0  291]]
Micro Precision/Recall/F-score:  (0.8905836246160365, 0.8905836246160365, 0.8905836246160365, None)
Macro Precision/Recall/F-score:  (0.8987014782507387, 0.7680862244468296, 0.8090028002338665, None)


epoch 1/40
model.reset
self.reset_num:  1
self.cheat:  False
self.mask_p:  1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.5511068742717933
ex_Confusion Metric: 
 [[1537 1324   85  836   11  325  151]
 [  17 2010   68   40    0   32   71]
 [   2   34  321    0    0    1    8]
 [ 121  550   14  842   12   49   49]
 [  12  220   10   45   39    7   28]
 [   8   24    5   10    0  166   29]
 [   1   14    0    9    0   16  288]]
used_ex_acc:  1.0
used_ex_Confusion Metric: 
 [[1537    0    0    0    0    0    0]
 [   0 2010    0    0    0    0    0]
 [   0    0  321    0    0    0    0]
 [   0    0    0  842    0    0    0]
 [   0    0    0    0   39    0    0]
 [   0    0    0    0    0  166    0]
 [   0    0    0    0    0    0  288]]
np.mean(reliability_np):  0.7915724379580995
np.median(reliability_np):  0.8533365726470947
np.mean(c_reliability_np):  0.8077299861055187
np.median(c_reliability_np):  0.8823165893554688
np.mean(w_reliability_np):  0.6833054311169156
np.median(w_reliability_np):  0.6879453063011169
self.threshold:  0.8823165893554688
Accuracy:  0.8744836352081348
Confusion Metric: 
 [[4113   48    0   69   37    1    1]
 [ 484 1737    0    6   11    0    0]
 [  24   12  330    0    0    0    0]
 [ 133    2    0 1489   13    0    0]
 [ 222    8    0   22  109    0    0]
 [  50    4    0    2    0  186    0]
 [  30    1    0    4    1    0  292]]
Micro Precision/Recall/F-score:  (0.8744836352081348, 0.8744836352081348, 0.8744836352081348, None)
Macro Precision/Recall/F-score:  (0.9051522915471616, 0.7873721364704905, 0.8325416214929652, None)


epoch 2/40
model.reset
self.reset_num:  2
self.cheat:  False
self.mask_p:  1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.5001588814744201
ex_Confusion Metric: 
 [[1116  442   75 1767   18  661  190]
 [  25 1519  126  421    8   70   69]
 [   0   19  330    9    0    4    4]
 [  39  184   11 1237   16  101   49]
 [  12   92   12  150   51   15   29]
 [   2    9    5   15    2  179   30]
 [   1    8    4   11    0   14  290]]
used_ex_acc:  1.0
used_ex_Confusion Metric: 
 [[1116    0    0    0    0    0    0]
 [   0 1519    0    0    0    0    0]
 [   0    0  330    0    0    0    0]
 [   0    0    0 1237    0    0    0]
 [   0    0    0    0   51    0    0]
 [   0    0    0    0    0  179    0]
 [   0    0    0    0    0    0  290]]
np.mean(reliability_np):  0.802306125121268
np.median(reliability_np):  0.8810836672782898
np.mean(c_reliability_np):  0.8151709579060715
np.median(c_reliability_np):  0.9032519459724426
np.mean(w_reliability_np):  0.7009006228000336
np.median(w_reliability_np):  0.7232587933540344
self.threshold:  0.9032519459724426
Accuracy:  0.8742717932422412
Confusion Metric: 
 [[4096   93    0   26   49    3    2]
 [ 530 1656    0    3   47    2    0]
 [  25   25  314    0    2    0    0]
 [  54    3    0 1576    4    0    0]
 [ 176   18    0    9  158    0    0]
 [  41    5    0    0    2  193    1]
 [  55    3    0    4    4    1  261]]
Micro Precision/Recall/F-score:  (0.8742717932422412, 0.8742717932422412, 0.8742717932422412, None)
Macro Precision/Recall/F-score:  (0.8954239359736843, 0.7930010538693668, 0.8369310141166916, None)


epoch 3/40
model.reset
self.reset_num:  3
self.cheat:  False
self.mask_p:  1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.4193411714860714
ex_Confusion Metric: 
 [[ 687  233   48 2780   13  434   74]
 [  18 1036   91 1005    6   50   32]
 [   0   14  314   34    0    2    2]
 [  15   77    7 1459    5   60   14]
 [   7   56    7  239   30   16    6]
 [   1    8    5   28    2  175   23]
 [   1   14    4   29    2   20  258]]
used_ex_acc:  1.0
used_ex_Confusion Metric: 
 [[ 687    0    0    0    0    0    0]
 [   0 1036    0    0    0    0    0]
 [   0    0  314    0    0    0    0]
 [   0    0    0 1459    0    0    0]
 [   0    0    0    0   30    0    0]
 [   0    0    0    0    0  175    0]
 [   0    0    0    0    0    0  258]]
np.mean(reliability_np):  0.8187445383598312
np.median(reliability_np):  0.8976077437400818
np.mean(c_reliability_np):  0.8588845504409709
np.median(c_reliability_np):  0.9486042857170105
np.mean(w_reliability_np):  0.8108413947521227
np.median(w_reliability_np):  0.8810486197471619
self.threshold:  0.9486042857170105
Accuracy:  0.8834869187586061
Confusion Metric: 
 [[4115   59    0   33   58    3    1]
 [ 431 1768    0    4   32    3    0]
 [  19   14  329    1    3    0    0]
 [ 123    1    0 1504    9    0    0]
 [ 172   16    0   13  157    2    1]
 [  31    4    0    0    2  204    1]
 [  54    3    0    4    2    1  264]]
Micro Precision/Recall/F-score:  (0.8834869187586061, 0.8834869187586061, 0.8834869187586061, None)
Macro Precision/Recall/F-score:  (0.8983332343488483, 0.8077620379569413, 0.8471795524493372, None)


epoch 4/40
model.reset
self.reset_num:  4
self.cheat:  False
self.mask_p:  1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.48840165236733396
ex_Confusion Metric: 
 [[1150  453  115 1880   18  583   70]
 [  30 1359  134  622   10   55   28]
 [   1   16  328   20    0    0    1]
 [  37  168   12 1280   11  113   16]
 [   9   97   14  173   46   14    8]
 [   2    9    5   15    1  189   21]
 [   2   19    7   19    1   21  259]]
used_ex_acc:  1.0
used_ex_Confusion Metric: 
 [[1150    0    0    0    0    0    0]
 [   0 1359    0    0    0    0    0]
 [   0    0  328    0    0    0    0]
 [   0    0    0 1280    0    0    0]
 [   0    0    0    0   46    0    0]
 [   0    0    0    0    0  189    0]
 [   0    0    0    0    0    0  259]]
np.mean(reliability_np):  0.8064262533897636
np.median(reliability_np):  0.8848785161972046
np.mean(c_reliability_np):  0.819752149883358
np.median(c_reliability_np):  0.9132354259490967
np.mean(w_reliability_np):  0.7478995653443948
np.median(w_reliability_np):  0.809997171163559
self.threshold:  0.9132354259490967
Accuracy:  0.8767079758500159
Confusion Metric: 
 [[4047  107    1   29   76    6    3]
 [ 453 1711    1    2   62    7    2]
 [  23   23  317    0    3    0    0]
 [  58    4    0 1575    0    0    0]
 [ 153   26    0   10  171    1    0]
 [  33    4    0    0    3  201    1]
 [  57    7    0    4    4    1  255]]
Micro Precision/Recall/F-score:  (0.8767079758500159, 0.8767079758500159, 0.8767079758500159, None)
Macro Precision/Recall/F-score:  (0.879662771165033, 0.8032095556327955, 0.8371368168245047, None)


epoch 5/40
model.reset
self.reset_num:  5
self.cheat:  False
self.mask_p:  1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.43173392649083786
ex_Confusion Metric: 
 [[ 834  219   40 2599    7  523   47]
 [  40 1019   93  995    3   62   26]
 [   0   15  312   34    0    4    1]
 [  16   75    5 1458    0   73   10]
 [  15   54    7  239   25   17    4]
 [   1    8    5   23    2  183   20]
 [   0   17    6   37    2   21  245]]
used_ex_acc:  1.0
used_ex_Confusion Metric: 
 [[ 834    0    0    0    0    0    0]
 [   0 1019    0    0    0    0    0]
 [   0    0  312    0    0    0    0]
 [   0    0    0 1458    0    0    0]
 [   0    0    0    0   25    0    0]
 [   0    0    0    0    0  183    0]
 [   0    0    0    0    0    0  245]]
np.mean(reliability_np):  0.8255772958625855
np.median(reliability_np):  0.9071789085865021
np.mean(c_reliability_np):  0.8590591076333752
np.median(c_reliability_np):  0.9471771419048309
np.mean(w_reliability_np):  0.8113824123021941
np.median(w_reliability_np):  0.8827122449874878
self.threshold:  0.9471771419048309
Accuracy:  0.8784027115771634
Confusion Metric: 
 [[3999  192    0   10   62    4    2]
 [ 383 1794    3    1   53    3    1]
 [  19   32  311    0    4    0    0]
 [  26    3    2 1606    0    0    0]
 [ 146   51    0    3  161    0    0]
 [  56    7    0    1    4  173    1]
 [  62    9    0    3    4    1  249]]
Micro Precision/Recall/F-score:  (0.8784027115771634, 0.8784027115771634, 0.8784027115771634, None)
Macro Precision/Recall/F-score:  (0.8833987083884309, 0.7841653381516062, 0.8271846585076364, None)


epoch 6/40
model.reset
self.reset_num:  6
self.cheat:  False
self.mask_p:  1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.3823747484376655
ex_Confusion Metric: 
 [[ 470  189   35 3435    5  105   30]
 [  32  882  106 1182    3   19   14]
 [   3   13  300   47    0    1    2]
 [  10   56    6 1549    1   11    4]
 [   5   32    7  300   12    4    1]
 [   2    5    5   47    1  157   25]
 [   0   11    4   69    0    4  240]]
used_ex_acc:  1.0
used_ex_Confusion Metric: 
 [[ 470    0    0    0    0    0    0]
 [   0  882    0    0    0    0    0]
 [   0    0  300    0    0    0    0]
 [   0    0    0 1549    0    0    0]
 [   0    0    0    0   12    0    0]
 [   0    0    0    0    0  157    0]
 [   0    0    0    0    0    0  240]]
np.mean(reliability_np):  0.840856937093518
np.median(reliability_np):  0.9174050986766815
np.mean(c_reliability_np):  0.8707694607386959
np.median(c_reliability_np):  0.9541899859905243
np.mean(w_reliability_np):  0.8295109724149023
np.median(w_reliability_np):  0.8944588303565979
self.threshold:  0.9541899859905243
Accuracy:  0.8848638915369135
Confusion Metric: 
 [[4005  168    1   11   72    8    4]
 [ 321 1880    1    1   29    3    3]
 [  21   37  307    0    0    0    1]
 [  43    4    1 1584    5    0    0]
 [ 151   46    0    4  159    1    0]
 [  54    6    0    0    4  176    2]
 [  62    7    0    2    8    6  243]]
Micro Precision/Recall/F-score:  (0.8848638915369135, 0.8848638915369135, 0.8848638915369135, None)
Macro Precision/Recall/F-score:  (0.8794304470021709, 0.7847408115435257, 0.8261823040720736, None)


epoch 7/40
model.reset
self.reset_num:  7
self.cheat:  False
self.mask_p:  1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.3867175087384811
ex_Confusion Metric: 
 [[ 416  362   46 3369    4   56   16]
 [  10 1107  107  989    0   20    5]
 [   3   18  297   44    0    3    1]
 [  18  143    7 1461    0    6    2]
 [   4   58    5  287    3    4    0]
 [   2    5    5   59    0  156   15]
 [   0   10    4   92    0   11  211]]
used_ex_acc:  1.0
used_ex_Confusion Metric: 
 [[ 416    0    0    0    0    0    0]
 [   0 1107    0    0    0    0    0]
 [   0    0  297    0    0    0    0]
 [   0    0    0 1461    0    0    0]
 [   0    0    0    0    3    0    0]
 [   0    0    0    0    0  156    0]
 [   0    0    0    0    0    0  211]]
np.mean(reliability_np):  0.8358731869978743
np.median(reliability_np):  0.9068543612957001
np.mean(c_reliability_np):  0.8588601216873839
np.median(c_reliability_np):  0.9427497386932373
np.mean(w_reliability_np):  0.8015413212086459
np.median(w_reliability_np):  0.8594845235347748
self.threshold:  0.9427497386932373
Accuracy:  0.8794619214066307
Confusion Metric: 
 [[4030   29    1  169   32    0    8]
 [ 155 2069    0    1    9    1    3]
 [  28   11  326    1    0    0    0]
 [ 198    3    0 1418   18    0    0]
 [ 175    8    0   48  128    0    2]
 [ 106    1    0    8    1  119    7]
 [  87    4    0   14    4    6  213]]
Micro Precision/Recall/F-score:  (0.8794619214066307, 0.8794619214066307, 0.8794619214066307, None)
Macro Precision/Recall/F-score:  (0.8848382247706127, 0.7315895190862854, 0.7870764722723579, None)


epoch 8/40
model.reset
self.reset_num:  8
self.cheat:  False
self.mask_p:  1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.4299332697807436
ex_Confusion Metric: 
 [[ 855 1971  241 1174    2   20    6]
 [  16 1878  141  202    0    1    0]
 [   2   31  324    7    0    2    0]
 [  65  790   31  746    2    2    1]
 [   7  232   18   99    5    0    0]
 [   8   74   36   17    0   95   12]
 [   0   99   38   32    0    3  156]]
used_ex_acc:  1.0
used_ex_Confusion Metric: 
 [[ 855    0    0    0    0    0    0]
 [   0 1878    0    0    0    0    0]
 [   0    0  324    0    0    0    0]
 [   0    0    0  746    0    0    0]
 [   0    0    0    0    5    0    0]
 [   0    0    0    0    0   95    0]
 [   0    0    0    0    0    0  156]]
np.mean(reliability_np):  0.767662042319869
np.median(reliability_np):  0.827926367521286
np.mean(c_reliability_np):  0.8226871529502744
np.median(c_reliability_np):  0.9127997756004333
np.mean(w_reliability_np):  0.7045670804543063
np.median(w_reliability_np):  0.7233035564422607
self.threshold:  0.9127997756004333
Accuracy:  0.8608198284080076
Confusion Metric: 
 [[3712    6    0  509   29    4    9]
 [  55 2180    0    2    0    1    0]
 [  23    3  338    1    1    0    0]
 [ 208    1    0 1413   14    0    1]
 [ 158    1    0   92  108    1    1]
 [  72    2    0   19    1  144    4]
 [  63    3    0   22    4    4  232]]
Micro Precision/Recall/F-score:  (0.8608198284080076, 0.8608198284080076, 0.8608198284080076, None)
Macro Precision/Recall/F-score:  (0.8723719491665302, 0.7473996350962286, 0.7895518227701649, None)


epoch 9/40
model.reset
self.reset_num:  9
self.cheat:  False
self.mask_p:  1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.3476326660311408
ex_Confusion Metric: 
 [[ 403 3385  303  151    5   16    6]
 [   1 2091  132   13    0    0    1]
 [   1   30  335    0    0    0    0]
 [  33 1367   29  200    3    3    2]
 [   1  335   18    4    2    1    0]
 [   7   90   35    1    0   95   14]
 [   1  128   35    8    0    0  156]]
used_ex_acc:  1.0
used_ex_Confusion Metric: 
 [[ 403    0    0    0    0    0    0]
 [   0 2091    0    0    0    0    0]
 [   0    0  335    0    0    0    0]
 [   0    0    0  200    0    0    0]
 [   0    0    0    0    2    0    0]
 [   0    0    0    0    0   95    0]
 [   0    0    0    0    0    0  156]]
np.mean(reliability_np):  0.7351421796054857
np.median(reliability_np):  0.7673911452293396
np.mean(c_reliability_np):  0.8113916756756635
np.median(c_reliability_np):  0.9051752388477325
np.mean(w_reliability_np):  0.6556005448219083
np.median(w_reliability_np):  0.6562127470970154
self.threshold:  0.9051752388477325
Accuracy:  0.8755428450376019
Confusion Metric: 
 [[4018   13    0  194   26    8   10]
 [  49 2185    0    1    0    1    2]
 [  20    2  341    1    0    2    0]
 [ 380    3    1 1234   16    0    3]
 [ 215    6    1   44   92    1    2]
 [  72    3    0    5    1  158    3]
 [  65    4    0   12    3    6  238]]
Micro Precision/Recall/F-score:  (0.8755428450376019, 0.8755428450376019, 0.8755428450376019, None)
Macro Precision/Recall/F-score:  (0.8754956985768961, 0.7480548689296989, 0.7933298976239244, None)


epoch 10/40
model.reset
self.reset_num:  10
self.cheat:  False
self.mask_p:  1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.3839635631818663
ex_Confusion Metric: 
 [[ 670 3046  335  180    3   28    7]
 [   1 2110  108   18    0    0    1]
 [   1   31  334    0    0    0    0]
 [  68 1276   43  240    2    6    2]
 [   1  330   22    4    3    1    0]
 [   9   73   35    2    0  106   17]
 [   1  120   35   10    0    0  162]]
used_ex_acc:  1.0
used_ex_Confusion Metric: 
 [[ 670    0    0    0    0    0    0]
 [   0 2110    0    0    0    0    0]
 [   0    0  334    0    0    0    0]
 [   0    0    0  240    0    0    0]
 [   0    0    0    0    3    0    0]
 [   0    0    0    0    0  106    0]
 [   0    0    0    0    0    0  162]]
np.mean(reliability_np):  0.6991012390277954
np.median(reliability_np):  0.7104747891426086
np.mean(c_reliability_np):  0.7817284752870428
np.median(c_reliability_np):  0.8753467202186584
np.mean(w_reliability_np):  0.6258731426560977
np.median(w_reliability_np):  0.6182611286640167
self.threshold:  0.8753467202186584
Accuracy:  0.8555237792606716
Confusion Metric: 
 [[4163    9    0   55   27    2   13]
 [  72 2163    0    0    1    0    2]
 [  16    3  345    0    1    0    1]
 [ 681    2    1  922   28    0    3]
 [ 238    4    0   19   97    1    2]
 [  83    2    0    0    0  153    4]
 [  81    5    0    3    3    2  234]]
Micro Precision/Recall/F-score:  (0.8555237792606716, 0.8555237792606716, 0.8555237792606716, None)
Macro Precision/Recall/F-score:  (0.8826764943390385, 0.7231214611232524, 0.7785520710653292, None)


epoch 11/40
model.reset
self.reset_num:  11
self.cheat:  False
self.mask_p:  1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.3995339476750344
ex_Confusion Metric: 
 [[ 833 2756  455  167    6   44    8]
 [   2 2073  142   17    0    1    3]
 [   1   25  340    0    0    0    0]
 [  96 1226   64  236    3   10    2]
 [   3  315   31    4    7    1    0]
 [   7   65   36    2    0  116   16]
 [   1   99   53    8    0    0  167]]
used_ex_acc:  1.0
used_ex_Confusion Metric: 
 [[ 833    0    0    0    0    0    0]
 [   0 2073    0    0    0    0    0]
 [   0    0  340    0    0    0    0]
 [   0    0    0  236    0    0    0]
 [   0    0    0    0    7    0    0]
 [   0    0    0    0    0  116    0]
 [   0    0    0    0    0    0  167]]
np.mean(reliability_np):  0.6832766890036853
np.median(reliability_np):  0.6865862905979156
np.mean(c_reliability_np):  0.7571534243425155
np.median(c_reliability_np):  0.833125650882721
np.mean(w_reliability_np):  0.6004254119587357
np.median(w_reliability_np):  0.5834186673164368
self.threshold:  0.833125650882721
Accuracy:  0.8714119267026798
Confusion Metric: 
 [[3902   32    1  166  114   29   25]
 [  54 2167    0    1    7    4    5]
 [  11    3  348    0    4    0    0]
 [ 351    1    0 1213   64    4    4]
 [ 150    5    0   26  175    3    2]
 [  57    4    0    1    2  174    4]
 [  49    3    0   14    4   10  248]]
Micro Precision/Recall/F-score:  (0.8714119267026798, 0.8714119267026798, 0.8714119267026796, None)
Macro Precision/Recall/F-score:  (0.8275772698973485, 0.7905694700706789, 0.8076157167233856, None)


epoch 12/40
model.reset
self.reset_num:  12
self.cheat:  False
self.mask_p:  1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.38163330155703845
ex_Confusion Metric: 
 [[ 709 2770  555  147    5   76    7]
 [   1 1999  220   14    0    2    2]
 [   1   21  344    0    0    0    0]
 [  72 1245   48  247    7   16    2]
 [   2  313   35    4    5    2    0]
 [   6   55   37    1    0  126   17]
 [   0   93   53    7    0    2  173]]
used_ex_acc:  1.0
used_ex_Confusion Metric: 
 [[ 709    0    0    0    0    0    0]
 [   0 1999    0    0    0    0    0]
 [   0    0  344    0    0    0    0]
 [   0    0    0  247    0    0    0]
 [   0    0    0    0    5    0    0]
 [   0    0    0    0    0  126    0]
 [   0    0    0    0    0    0  173]]
np.mean(reliability_np):  0.670067068140849
np.median(reliability_np):  0.6685358285903931
np.mean(c_reliability_np):  0.7513690531799736
np.median(c_reliability_np):  0.8335000872612
np.mean(w_reliability_np):  0.5941451837695719
np.median(w_reliability_np):  0.5740543007850647
self.threshold:  0.8335000872612
Accuracy:  0.8733185043957208
Confusion Metric: 
 [[3968   26    4  122  126    8   15]
 [  59 2172    0    0    3    0    4]
 [  11    4  346    0    4    1    0]
 [ 389    5    2 1147   90    0    4]
 [ 144    5    1   21  186    2    2]
 [  64    4    0    1    3  166    4]
 [  49    5    0    7    4    3  260]]
Micro Precision/Recall/F-score:  (0.8733185043957208, 0.8733185043957208, 0.8733185043957208, None)
Macro Precision/Recall/F-score:  (0.8511294001597997, 0.7914138595557493, 0.8161353544333593, None)


epoch 13/40
model.reset
self.reset_num:  13
self.cheat:  False
self.mask_p:  1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.41319775447516155
ex_Confusion Metric: 
 [[ 888 2567  517  220    8   59   10]
 [   2 2035  167   27    0    4    3]
 [   1   23  342    0    0    0    0]
 [ 107 1145   54  313    5   11    2]
 [   5  304   30    9   11    2    0]
 [  10   51   35    5    0  122   19]
 [   1   87   34   13    0    3  190]]
used_ex_acc:  1.0
used_ex_Confusion Metric: 
 [[ 888    0    0    0    0    0    0]
 [   0 2035    0    0    0    0    0]
 [   0    0  342    0    0    0    0]
 [   0    0    0  313    0    0    0]
 [   0    0    0    0   11    0    0]
 [   0    0    0    0    0  122    0]
 [   0    0    0    0    0    0  190]]
np.mean(reliability_np):  0.662711638865638
np.median(reliability_np):  0.6556440889835358
np.mean(c_reliability_np):  0.7472770273440986
np.median(c_reliability_np):  0.8209444284439087
np.mean(w_reliability_np):  0.5915931528064318
np.median(w_reliability_np):  0.5681380331516266
self.threshold:  0.8209444284439087
Accuracy:  0.8683402181972248
Confusion Metric: 
 [[3776   52    8  167  210   29   27]
 [  54 2168    0    0    7    2    7]
 [   9    5  345    0    5    2    0]
 [ 273    5    3 1246  104    1    5]
 [ 107    8    2   21  215    5    3]
 [  44    4    0    3    4  180    7]
 [  38    5    0    7    5    5  268]]
Micro Precision/Recall/F-score:  (0.8683402181972248, 0.8683402181972248, 0.8683402181972248, None)
Macro Precision/Recall/F-score:  (0.8156073999561199, 0.8162074910273435, 0.8122010548351942, None)


epoch 14/40
model.reset
self.reset_num:  14
self.cheat:  False
self.mask_p:  1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.42071814426437876
ex_Confusion Metric: 
 [[ 898 2360  485  415   13   87   11]
 [   5 1973  167   84    0    5    4]
 [   1   23  341    1    0    0    0]
 [  93 1033   61  423   11   14    2]
 [   5  282   35   22   16    1    0]
 [   6   48   36    9    0  125   18]
 [   1   70   36   22    0    3  196]]
used_ex_acc:  1.0
used_ex_Confusion Metric: 
 [[ 898    0    0    0    0    0    0]
 [   0 1973    0    0    0    0    0]
 [   0    0  341    0    0    0    0]
 [   0    0    0  423    0    0    0]
 [   0    0    0    0   16    0    0]
 [   0    0    0    0    0  125    0]
 [   0    0    0    0    0    0  196]]
np.mean(reliability_np):  0.6679347205866737
np.median(reliability_np):  0.6667184829711914
np.mean(c_reliability_np):  0.7539904841708632
np.median(c_reliability_np):  0.8309577107429504
np.mean(w_reliability_np):  0.6019725371298613
np.median(w_reliability_np):  0.5853164792060852
self.threshold:  0.8309577107429504
Accuracy:  0.8735303463616142
Confusion Metric: 
 [[3724   52   11  232  149   69   32]
 [  71 2135    1    2   12    7   10]
 [   9    4  348    0    3    2    0]
 [ 178    3    1 1396   50    6    3]
 [ 116    8    1   44  181    6    5]
 [  36    3    0    5    3  188    7]
 [  30    4    0    7    3    9  275]]
Micro Precision/Recall/F-score:  (0.8735303463616142, 0.8735303463616142, 0.8735303463616142, None)
Macro Precision/Recall/F-score:  (0.7978416232205581, 0.820938647590548, 0.808402491189003, None)


epoch 15/40
model.reset
self.reset_num:  15
self.cheat:  False
self.mask_p:  1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.4389365533312149
ex_Confusion Metric: 
 [[ 964 2016  494  680   15   90   10]
 [   6 1930  171  119    1    6    5]
 [   1   22  338    3    0    2    0]
 [  87  896   70  561    6   15    2]
 [   7  251   36   44   21    2    0]
 [   7   40   39   14    0  125   17]
 [   1   59   31   29    0    3  205]]
used_ex_acc:  1.0
used_ex_Confusion Metric: 
 [[ 964    0    0    0    0    0    0]
 [   0 1930    0    0    0    0    0]
 [   0    0  338    0    0    0    0]
 [   0    0    0  561    0    0    0]
 [   0    0    0    0   21    0    0]
 [   0    0    0    0    0  125    0]
 [   0    0    0    0    0    0  205]]
np.mean(reliability_np):  0.6781664043338351
np.median(reliability_np):  0.6845979690551758
np.mean(c_reliability_np):  0.7519162902608514
np.median(c_reliability_np):  0.8220102488994598
np.mean(w_reliability_np):  0.6046104498470597
np.median(w_reliability_np):  0.5828694105148315
self.threshold:  0.8220102488994598
Accuracy:  0.883910602690393
Confusion Metric: 
 [[3924   85    9  134   83   13   21]
 [ 108 2112    0    3    4    3    8]
 [   7    5  354    0    0    0    0]
 [ 227    2    2 1373   30    1    2]
 [ 141   14    3   40  158    2    3]
 [  57    6    0    6    1  164    8]
 [  43    9    0    8    3    5  260]]
Micro Precision/Recall/F-score:  (0.883910602690393, 0.883910602690393, 0.883910602690393, None)
Macro Precision/Recall/F-score:  (0.850838293050435, 0.7966955797018315, 0.820483464646954, None)


epoch 16/40
model.reset
self.reset_num:  16
self.cheat:  False
self.mask_p:  1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.46689969282914945
ex_Confusion Metric: 
 [[1215 1539  513  922    6   61   13]
 [  22 1851  202  153    0    5    5]
 [   0   18  341    6    0    1    0]
 [ 116  770   70  658    6   14    3]
 [   9  224   41   68   15    4    0]
 [  10   35   39   19    0  124   15]
 [   0   56   34   31    0    3  204]]
used_ex_acc:  1.0
used_ex_Confusion Metric: 
 [[1215    0    0    0    0    0    0]
 [   0 1851    0    0    0    0    0]
 [   0    0  341    0    0    0    0]
 [   0    0    0  658    0    0    0]
 [   0    0    0    0   15    0    0]
 [   0    0    0    0    0  124    0]
 [   0    0    0    0    0    0  204]]
np.mean(reliability_np):  0.6839307727355455
np.median(reliability_np):  0.6969558894634247
np.mean(c_reliability_np):  0.7497830994751731
np.median(c_reliability_np):  0.8093121945858002
np.mean(w_reliability_np):  0.6193321709240405
np.median(w_reliability_np):  0.6053908467292786
self.threshold:  0.8093121945858002
Accuracy:  0.8805211312360979
Confusion Metric: 
 [[3912   82    5  145   73   26   26]
 [ 192 2003    3    5   21    5    9]
 [  15    8  341    1    1    0    0]
 [ 147    0    0 1467   20    1    2]
 [ 131   32    1   45  147    3    2]
 [  52    2    0    3    3  177    5]
 [  41    4    0    8    2    7  266]]
Micro Precision/Recall/F-score:  (0.8805211312360979, 0.8805211312360979, 0.8805211312360979, None)
Macro Precision/Recall/F-score:  (0.8398112975951249, 0.798399665711805, 0.8169604156429747, None)


epoch 17/40
model.reset
self.reset_num:  17
self.cheat:  False
self.mask_p:  1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.4356530028598665
ex_Confusion Metric: 
 [[ 965 1347  332 1541    5   63   16]
 [  64 1615  169  381    1    5    3]
 [   6   18  323   17    0    2    0]
 [  59  634   62  861    8    9    4]
 [   7  170   30  137   14    3    0]
 [   7   29   25   36    0  130   15]
 [   0   44   26   48    0    5  205]]
used_ex_acc:  1.0
used_ex_Confusion Metric: 
 [[ 965    0    0    0    0    0    0]
 [   0 1615    0    0    0    0    0]
 [   0    0  323    0    0    0    0]
 [   0    0    0  861    0    0    0]
 [   0    0    0    0   14    0    0]
 [   0    0    0    0    0  130    0]
 [   0    0    0    0    0    0  205]]
np.mean(reliability_np):  0.7140406118019822
np.median(reliability_np):  0.7525047957897186
np.mean(c_reliability_np):  0.7786053941541422
np.median(c_reliability_np):  0.8488690257072449
np.mean(w_reliability_np):  0.6525505284524268
np.median(w_reliability_np):  0.6588752269744873
self.threshold:  0.8488690257072449
Accuracy:  0.8708823217879462
Confusion Metric: 
 [[3831  193    6   95   87   39   18]
 [ 210 1966    3    2   37   10   10]
 [  16   29  319    0    2    0    0]
 [ 112    3    0 1501   18    1    2]
 [ 114   55    1   24  162    3    2]
 [  45    5    0    3    1  183    5]
 [  40    8    0    5    4   11  260]]
Micro Precision/Recall/F-score:  (0.8708823217879462, 0.8708823217879462, 0.8708823217879462, None)
Macro Precision/Recall/F-score:  (0.8250046678747668, 0.7945719151533737, 0.8087078314720989, None)


epoch 18/40
model.reset
self.reset_num:  18
self.cheat:  False
self.mask_p:  1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.41425696430462877
ex_Confusion Metric: 
 [[1081  821  249 2060    2   36   20]
 [ 225 1115  172  713    2    9    2]
 [  20   15  292   36    1    2    0]
 [  56  437   48 1079    9    4    4]
 [  19  118   26  185   11    2    0]
 [  14   24   19   43    0  122   20]
 [   2   35   21   56    0    3  211]]
used_ex_acc:  1.0
used_ex_Confusion Metric: 
 [[1081    0    0    0    0    0    0]
 [   0 1115    0    0    0    0    0]
 [   0    0  292    0    0    0    0]
 [   0    0    0 1079    0    0    0]
 [   0    0    0    0   11    0    0]
 [   0    0    0    0    0  122    0]
 [   0    0    0    0    0    0  211]]
np.mean(reliability_np):  0.7272566968290949
np.median(reliability_np):  0.7687594890594482
np.mean(c_reliability_np):  0.7818086651113142
np.median(c_reliability_np):  0.8472852110862732
np.mean(w_reliability_np):  0.6796817165737126
np.median(w_reliability_np):  0.697857677936554
self.threshold:  0.8472852110862732
Accuracy:  0.8649507467429298
Confusion Metric: 
 [[3717  260   15  102  123   33   19]
 [ 162 2008    3    3   43    9   10]
 [   9   35  320    0    2    0    0]
 [  91    8    1 1514   19    1    3]
 [  92   68    3   20  174    2    2]
 [  43    6    1    7    3  174    8]
 [  33   13    0    7    6   10  259]]
Micro Precision/Recall/F-score:  (0.8649507467429298, 0.8649507467429298, 0.8649507467429298, None)
Macro Precision/Recall/F-score:  (0.8104415489502463, 0.7939631066585209, 0.8015813128655084, None)


epoch 19/40
model.reset
self.reset_num:  19
self.cheat:  False
self.mask_p:  1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.42453129965046077
ex_Confusion Metric: 
 [[1142  741  215 2120    5   29   17]
 [ 212 1117  155  742    1    8    3]
 [  21   17  292   33    1    2    0]
 [  68  404   45 1103   10    4    3]
 [  17  107   20  195   18    2    2]
 [  16   20   18   49    0  124   15]
 [   4   35   20   54    0    3  212]]
used_ex_acc:  1.0
used_ex_Confusion Metric: 
 [[1142    0    0    0    0    0    0]
 [   0 1117    0    0    0    0    0]
 [   0    0  292    0    0    0    0]
 [   0    0    0 1103    0    0    0]
 [   0    0    0    0   18    0    0]
 [   0    0    0    0    0  124    0]
 [   0    0    0    0    0    0  212]]
np.mean(reliability_np):  0.7311977285986571
np.median(reliability_np):  0.769183486700058
np.mean(c_reliability_np):  0.7799416590898396
np.median(c_reliability_np):  0.8446904122829437
np.mean(w_reliability_np):  0.6794605083213685
np.median(w_reliability_np):  0.6977576017379761
self.threshold:  0.8446904122829437
Accuracy:  0.8703527168732126
Confusion Metric: 
 [[3764  192   13  138  107   34   21]
 [ 176 2010    4    3   31    6    8]
 [  11   16  338    0    1    0    0]
 [ 109    5    0 1494   25    2    2]
 [ 111   40    2   28  175    4    1]
 [  53    4    0    4    1  174    6]
 [  37    7    1    7    6    8  262]]
Micro Precision/Recall/F-score:  (0.8703527168732126, 0.8703527168732126, 0.8703527168732126, None)
Macro Precision/Recall/F-score:  (0.8208777854318579, 0.8026463267475421, 0.8113582393664951, None)


epoch 20/40
model.reset
self.reset_num:  20
self.cheat:  False
self.mask_p:  1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.417964198707764
ex_Confusion Metric: 
 [[ 880 1050  218 2049    2   53   17]
 [ 111 1358  143  610    2   11    3]
 [  10   16  306   30    1    3    0]
 [  33  496   39 1046   10   10    3]
 [   6  146   18  171   16    2    2]
 [  13   23   21   42    0  130   13]
 [   0   38   21   56    0    3  210]]
used_ex_acc:  1.0
used_ex_Confusion Metric: 
 [[ 880    0    0    0    0    0    0]
 [   0 1358    0    0    0    0    0]
 [   0    0  306    0    0    0    0]
 [   0    0    0 1046    0    0    0]
 [   0    0    0    0   16    0    0]
 [   0    0    0    0    0  130    0]
 [   0    0    0    0    0    0  210]]
np.mean(reliability_np):  0.7307668970760585
np.median(reliability_np):  0.7712700068950653
np.mean(c_reliability_np):  0.7811967533967306
np.median(c_reliability_np):  0.850668877363205
np.mean(w_reliability_np):  0.673156991872167
np.median(w_reliability_np):  0.6963613629341125
self.threshold:  0.850668877363205
Accuracy:  0.8690816650778519
Confusion Metric: 
 [[3824  215   13  115   61   24   17]
 [ 220 1971   12    4   14    7   10]
 [  11   15  340    0    0    0    0]
 [  97   10    1 1516   12    0    1]
 [ 126   63    5   31  131    3    2]
 [  52    8    1    7    1  167    6]
 [  46   10    1    7    3    5  256]]
Micro Precision/Recall/F-score:  (0.8690816650778519, 0.8690816650778519, 0.8690816650778519, None)
Macro Precision/Recall/F-score:  (0.8321708830033849, 0.780707795319001, 0.8014078697843844, None)


epoch 21/40
model.reset
self.reset_num:  21
self.cheat:  False
self.mask_p:  1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.4111852557991738
ex_Confusion Metric: 
 [[1060  764  203 2189    1   35   17]
 [ 242 1078  160  746    1    8    3]
 [  23   12  295   34    0    2    0]
 [  57  415   41 1107    7    7    3]
 [  17  120   18  194   10    2    0]
 [  15   20   20   47    0  123   17]
 [   0   38   21   58    0    2  209]]
used_ex_acc:  1.0
used_ex_Confusion Metric: 
 [[1060    0    0    0    0    0    0]
 [   0 1078    0    0    0    0    0]
 [   0    0  295    0    0    0    0]
 [   0    0    0 1107    0    0    0]
 [   0    0    0    0   10    0    0]
 [   0    0    0    0    0  123    0]
 [   0    0    0    0    0    0  209]]
np.mean(reliability_np):  0.7293846273887075
np.median(reliability_np):  0.7663232088088989
np.mean(c_reliability_np):  0.7813130845265374
np.median(c_reliability_np):  0.8486498892307281
np.mean(w_reliability_np):  0.6864517371063503
np.median(w_reliability_np):  0.7094595432281494
self.threshold:  0.8486498892307281
Accuracy:  0.8749073191399216
Confusion Metric: 
 [[3814  246    5  109   65   13   17]
 [ 148 2061    3    3   13    2    8]
 [  11   24  331    0    0    0    0]
 [ 109   16    0 1491   19    0    2]
 [ 114   64    3   36  140    2    2]
 [  56    9    0    7    1  164    5]
 [  45   12    0    8    2    2  259]]
Micro Precision/Recall/F-score:  (0.8749073191399216, 0.8749073191399216, 0.8749073191399216, None)
Macro Precision/Recall/F-score:  (0.8525430259019016, 0.783520709712812, 0.8122973930169665, None)


epoch 22/40
model.reset
self.reset_num:  22
self.cheat:  False
self.mask_p:  1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.432051689439678
ex_Confusion Metric: 
 [[1131  889  187 1994    2   44   22]
 [ 193 1218  161  652    2    7    5]
 [  18   14  307   25    0    2    0]
 [  66  441   35 1074   10    8    3]
 [  11  142   17  177   10    2    2]
 [  11   25   20   39    0  128   19]
 [   2   40   20   53    0    2  211]]
used_ex_acc:  1.0
used_ex_Confusion Metric: 
 [[1131    0    0    0    0    0    0]
 [   0 1218    0    0    0    0    0]
 [   0    0  307    0    0    0    0]
 [   0    0    0 1074    0    0    0]
 [   0    0    0    0   10    0    0]
 [   0    0    0    0    0  128    0]
 [   0    0    0    0    0    0  211]]
np.mean(reliability_np):  0.7282909335223596
np.median(reliability_np):  0.7667693197727203
np.mean(c_reliability_np):  0.7817651257046767
np.median(c_reliability_np):  0.8505262136459351
np.mean(w_reliability_np):  0.6768645906222707
np.median(w_reliability_np):  0.6976634562015533
self.threshold:  0.8505262136459351
Accuracy:  0.8725770575150937
Confusion Metric: 
 [[3871  150    4  122   79   18   25]
 [ 188 2019    2    2   15    3    9]
 [  14   12  337    0    2    1    0]
 [ 161    2    0 1446   24    0    4]
 [ 135   43    1   36  140    3    3]
 [  57    6    0   10    2  163    4]
 [  45    7    0    7    2    5  262]]
Micro Precision/Recall/F-score:  (0.8725770575150937, 0.8725770575150937, 0.8725770575150937, None)
Macro Precision/Recall/F-score:  (0.8380600508304497, 0.7818783611444372, 0.8066842999105889, None)


epoch 23/40
model.reset
self.reset_num:  23
self.cheat:  False
self.mask_p:  1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.40938459908907954
ex_Confusion Metric: 
 [[ 699 1378  285 1802    3   75   27]
 [  47 1535  172  470    1    6    7]
 [   3   21  323   17    0    2    0]
 [  25  590   42  955    8   15    2]
 [   4  163   28  150   12    3    1]
 [   5   32   26   35    0  124   20]
 [   0   43   19   46    0    3  217]]
used_ex_acc:  1.0
used_ex_Confusion Metric: 
 [[ 699    0    0    0    0    0    0]
 [   0 1535    0    0    0    0    0]
 [   0    0  323    0    0    0    0]
 [   0    0    0  955    0    0    0]
 [   0    0    0    0   12    0    0]
 [   0    0    0    0    0  124    0]
 [   0    0    0    0    0    0  217]]
np.mean(reliability_np):  0.7269859162272547
np.median(reliability_np):  0.7691395580768585
np.mean(c_reliability_np):  0.7875002024244676
np.median(c_reliability_np):  0.8634506464004517
np.mean(w_reliability_np):  0.6659766955453491
np.median(w_reliability_np):  0.6810735762119293
self.threshold:  0.8634506464004517
Accuracy:  0.8790382374748438
Confusion Metric: 
 [[3848  154   14  126   79   29   19]
 [ 145 2056    3    3   16    7    8]
 [  11    9  344    0    2    0    0]
 [ 140    3    2 1470   19    1    2]
 [ 130   40    5   32  149    3    2]
 [  54    4    0    6    2  171    5]
 [  41    7    1    8    4    6  261]]
Micro Precision/Recall/F-score:  (0.8790382374748438, 0.8790382374748438, 0.8790382374748438, None)
Macro Precision/Recall/F-score:  (0.8325386219992821, 0.7961457049602451, 0.8123090313070636, None)


epoch 24/40
model.reset
self.reset_num:  24
self.cheat:  False
self.mask_p:  1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.4194470924690181
ex_Confusion Metric: 
 [[ 807 1359  271 1737    3   65   27]
 [  60 1525  159  478    4    6    6]
 [   6   22  318   18    0    2    0]
 [  32  577   42  964    9   11    2]
 [   6  162   23  153   13    3    1]
 [   7   33   27   33    0  122   20]
 [   1   46   20   48    0    2  211]]
used_ex_acc:  1.0
used_ex_Confusion Metric: 
 [[ 807    0    0    0    0    0    0]
 [   0 1525    0    0    0    0    0]
 [   0    0  318    0    0    0    0]
 [   0    0    0  964    0    0    0]
 [   0    0    0    0   13    0    0]
 [   0    0    0    0    0  122    0]
 [   0    0    0    0    0    0  211]]
np.mean(reliability_np):  0.7219553759089562
np.median(reliability_np):  0.7643043100833893
np.mean(c_reliability_np):  0.7889552646815174
np.median(c_reliability_np):  0.8644305765628815
np.mean(w_reliability_np):  0.664129155150536
np.median(w_reliability_np):  0.6757442355155945
self.threshold:  0.8644305765628815
Accuracy:  0.8712000847367863
Confusion Metric: 
 [[3790  210   16  106   94   27   26]
 [ 167 2027    6    1   17    8   12]
 [  10   11  345    0    0    0    0]
 [ 132    6    2 1471   22    1    3]
 [ 119   47    6   32  152    3    2]
 [  48    6    0    6    1  175    6]
 [  39    8    1    6    4    5  265]]
Micro Precision/Recall/F-score:  (0.8712000847367863, 0.8712000847367863, 0.8712000847367863, None)
Macro Precision/Recall/F-score:  (0.8210853705615743, 0.7981218610560904, 0.8084083184016438, None)


epoch 25/40
model.reset
self.reset_num:  25
self.cheat:  False
self.mask_p:  1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.41235038661158774
ex_Confusion Metric: 
 [[ 767 1174  313 1910    2   85   18]
 [  60 1435  169  555    2   12    5]
 [   5   17  318   23    0    3    0]
 [  29  515   46 1021    8   16    2]
 [   6  145   27  171    8    3    1]
 [   6   27   23   35    0  134   17]
 [   1   38   26   51    0    2  210]]
used_ex_acc:  1.0
used_ex_Confusion Metric: 
 [[ 767    0    0    0    0    0    0]
 [   0 1435    0    0    0    0    0]
 [   0    0  318    0    0    0    0]
 [   0    0    0 1021    0    0    0]
 [   0    0    0    0    8    0    0]
 [   0    0    0    0    0  134    0]
 [   0    0    0    0    0    0  210]]
np.mean(reliability_np):  0.7236533225776507
np.median(reliability_np):  0.7664240896701813
np.mean(c_reliability_np):  0.7874580703861389
np.median(c_reliability_np):  0.8657200336456299
np.mean(w_reliability_np):  0.6689173662477719
np.median(w_reliability_np):  0.6899541318416595
self.threshold:  0.8657200336456299
Accuracy:  0.8738481093104544
Confusion Metric: 
 [[3856  173   13  109   70   24   24]
 [ 175 2023    4    3   14    8   11]
 [  11   11  343    0    1    0    0]
 [ 146    3    0 1467   17    1    3]
 [ 150   38    2   38  127    3    3]
 [  56    2    1    3    2  171    7]
 [  42    6    0    7    3    7  263]]
Micro Precision/Recall/F-score:  (0.8738481093104544, 0.8738481093104544, 0.8738481093104544, None)
Macro Precision/Recall/F-score:  (0.8285705915298983, 0.785819924745233, 0.8037433211325037, None)


epoch 26/40
model.reset
self.reset_num:  26
self.cheat:  False
self.mask_p:  1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.41531617413409594
ex_Confusion Metric: 
 [[ 761 1263  291 1857    3   71   23]
 [  57 1479  161  526    3    8    4]
 [   4   18  321   21    0    2    0]
 [  29  537   42 1007    7   12    3]
 [   5  151   25  166   10    3    1]
 [   6   30   25   33    0  129   19]
 [   1   38   22   50    0    3  214]]
used_ex_acc:  1.0
used_ex_Confusion Metric: 
 [[ 761    0    0    0    0    0    0]
 [   0 1479    0    0    0    0    0]
 [   0    0  321    0    0    0    0]
 [   0    0    0 1007    0    0    0]
 [   0    0    0    0   10    0    0]
 [   0    0    0    0    0  129    0]
 [   0    0    0    0    0    0  214]]
np.mean(reliability_np):  0.7266066438445551
np.median(reliability_np):  0.7712944149971008
np.mean(c_reliability_np):  0.7896174167802339
np.median(c_reliability_np):  0.8699226975440979
np.mean(w_reliability_np):  0.6695500977202387
np.median(w_reliability_np):  0.6897424459457397
self.threshold:  0.8699226975440979
Accuracy:  0.8688698231119585
Confusion Metric: 
 [[3808  165   13  132   68   50   33]
 [ 210 1992    2    1   12   11   10]
 [  16   14  335    0    1    0    0]
 [ 128    1    0 1489   15    1    3]
 [ 147   34    3   34  135    4    4]
 [  50    4    0    4    1  178    5]
 [  40    5    0    7    3    7  266]]
Micro Precision/Recall/F-score:  (0.8688698231119585, 0.8688698231119585, 0.8688698231119585, None)
Macro Precision/Recall/F-score:  (0.817070829378472, 0.789636841376925, 0.8001922328674808, None)


epoch 27/40
model.reset
self.reset_num:  27
self.cheat:  False
self.mask_p:  1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.41817604067365743
ex_Confusion Metric: 
 [[ 774 1276  221 1888    2   78   30]
 [  50 1467  163  540    3   10    5]
 [   7   18  318   21    0    2    0]
 [  26  525   28 1027    9   18    4]
 [   6  155   19  169    7    3    2]
 [   4   27   24   34    0  134   19]
 [   1   37   18   48    0    3  221]]
used_ex_acc:  1.0
used_ex_Confusion Metric: 
 [[ 774    0    0    0    0    0    0]
 [   0 1467    0    0    0    0    0]
 [   0    0  318    0    0    0    0]
 [   0    0    0 1027    0    0    0]
 [   0    0    0    0    7    0    0]
 [   0    0    0    0    0  134    0]
 [   0    0    0    0    0    0  221]]
np.mean(reliability_np):  0.7214217545752888
np.median(reliability_np):  0.7635602653026581
np.mean(c_reliability_np):  0.784613337345127
np.median(c_reliability_np):  0.8622536063194275
np.mean(w_reliability_np):  0.6655890483706891
np.median(w_reliability_np):  0.6825196146965027
self.threshold:  0.8622536063194275
Accuracy:  0.8699290329414257
Confusion Metric: 
 [[3832  162   15  117   82   39   22]
 [ 217 1980    3    2   18    8   10]
 [  12    9  344    0    1    0    0]
 [ 123    4    0 1484   19    3    4]
 [ 143   35    3   32  140    5    3]
 [  53    3    0    5    1  177    3]
 [  42    8    0    6    4   12  256]]
Micro Precision/Recall/F-score:  (0.8699290329414257, 0.8699290329414257, 0.8699290329414257, None)
Macro Precision/Recall/F-score:  (0.8175692529515937, 0.7897834371815805, 0.8018175739390628, None)


epoch 28/40
model.reset
self.reset_num:  28
self.cheat:  False
self.mask_p:  1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.41319775447516155
ex_Confusion Metric: 
 [[ 762 1128  344 1924    3   83   25]
 [  58 1417  205  542    2   10    4]
 [   7   14  322   21    0    2    0]
 [  25  487   54 1045    6   15    5]
 [   6  146   27  170    7    3    2]
 [   5   26   27   33    0  137   14]
 [   1   35   28   50    0    3  211]]
used_ex_acc:  1.0
used_ex_Confusion Metric: 
 [[ 762    0    0    0    0    0    0]
 [   0 1417    0    0    0    0    0]
 [   0    0  322    0    0    0    0]
 [   0    0    0 1045    0    0    0]
 [   0    0    0    0    7    0    0]
 [   0    0    0    0    0  137    0]
 [   0    0    0    0    0    0  211]]
np.mean(reliability_np):  0.7231019510226804
np.median(reliability_np):  0.7658285200595856
np.mean(c_reliability_np):  0.7804748962297405
np.median(c_reliability_np):  0.8564477562904358
np.mean(w_reliability_np):  0.6658203865216528
np.median(w_reliability_np):  0.6850184202194214
self.threshold:  0.8564477562904358
Accuracy:  0.8776612646965364
Confusion Metric: 
 [[3947  108   11  107   58   14   24]
 [ 247 1955    2    0   19    3   12]
 [  13   10  341    0    2    0    0]
 [ 144    0    0 1480   11    1    1]
 [ 162   28    2   32  133    1    3]
 [  62    2    0    5    2  168    3]
 [  44    4    0    7    5    6  262]]
Micro Precision/Recall/F-score:  (0.8776612646965364, 0.8776612646965364, 0.8776612646965364, None)
Macro Precision/Recall/F-score:  (0.8507715706067961, 0.7850462240399344, 0.8126717623440572, None)


epoch 29/40
model.reset
self.reset_num:  29
self.cheat:  False
self.mask_p:  1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.4174345937930304
ex_Confusion Metric: 
 [[ 743 1215  305 1894    2   85   25]
 [  46 1488  174  515    2   10    3]
 [   4   18  320   20    0    4    0]
 [  27  504   49 1031    9   15    2]
 [   6  152   24  163   10    4    2]
 [   6   27   24   32    0  136   17]
 [   1   37   25   49    0    3  213]]
used_ex_acc:  1.0
used_ex_Confusion Metric: 
 [[ 743    0    0    0    0    0    0]
 [   0 1488    0    0    0    0    0]
 [   0    0  320    0    0    0    0]
 [   0    0    0 1031    0    0    0]
 [   0    0    0    0   10    0    0]
 [   0    0    0    0    0  136    0]
 [   0    0    0    0    0    0  213]]
np.mean(reliability_np):  0.7223623850265273
np.median(reliability_np):  0.7673585414886475
np.mean(c_reliability_np):  0.7825758775095443
np.median(c_reliability_np):  0.8593337535858154
np.mean(w_reliability_np):  0.6626874790868976
np.median(w_reliability_np):  0.679748147726059
self.threshold:  0.8593337535858154
Accuracy:  0.8776612646965364
Confusion Metric: 
 [[3922  102    8   77  102   41   17]
 [ 195 1992    1    5   30    8    7]
 [  18   11  334    0    2    1    0]
 [ 180    2    0 1425   25    2    3]
 [ 137   29    2   22  167    3    1]
 [  45    1    0    2    2  189    3]
 [  42    4    0    6    6   13  257]]
Micro Precision/Recall/F-score:  (0.8776612646965364, 0.8776612646965364, 0.8776612646965364, None)
Macro Precision/Recall/F-score:  (0.8310699592804909, 0.8027131526526057, 0.8157570511815703, None)


epoch 30/40
model.reset
self.reset_num:  30
self.cheat:  False
self.mask_p:  1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.43374642516682554
ex_Confusion Metric: 
 [[ 892 1275  260 1694    4  123   21]
 [  65 1547  149  460    1   12    4]
 [   8   24  315   16    0    3    0]
 [  35  555   47  963    8   25    4]
 [   9  162   23  147   13    5    2]
 [   3   27   21   27    0  148   16]
 [   1   40   21   40    0    9  217]]
used_ex_acc:  1.0
used_ex_Confusion Metric: 
 [[ 892    0    0    0    0    0    0]
 [   0 1547    0    0    0    0    0]
 [   0    0  315    0    0    0    0]
 [   0    0    0  963    0    0    0]
 [   0    0    0    0   13    0    0]
 [   0    0    0    0    0  148    0]
 [   0    0    0    0    0    0  217]]
np.mean(reliability_np):  0.7135979673493748
np.median(reliability_np):  0.7518454492092133
np.mean(c_reliability_np):  0.7775612639674919
np.median(c_reliability_np):  0.8527014851570129
np.mean(w_reliability_np):  0.6396045953180297
np.median(w_reliability_np):  0.6466729044914246
self.threshold:  0.8527014851570129
Accuracy:  0.8782967905942167
Confusion Metric: 
 [[3940   76    3  155   58   15   22]
 [ 174 2031    2    4   14    6    7]
 [  11    4  348    1    2    0    0]
 [ 201    2    1 1398   32    2    1]
 [ 154   15    1   39  147    1    4]
 [  53    2    0    6    2  175    4]
 [  53    6    0    6    7    3  253]]
Micro Precision/Recall/F-score:  (0.8782967905942167, 0.8782967905942167, 0.8782967905942167, None)
Macro Precision/Recall/F-score:  (0.8508492400413505, 0.7909920775401117, 0.8175573994682308, None)


epoch 31/40
model.reset
self.reset_num:  31
self.cheat:  False
self.mask_p:  1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.4197648554178583
ex_Confusion Metric: 
 [[ 722 1659  511 1164    7  176   30]
 [  17 1722  230  251    2   10    6]
 [   0   20  337    7    0    2    0]
 [  44  694   55  810   10   20    4]
 [   4  200   42   95   13    6    1]
 [   3   29   27   17    0  147   19]
 [   0   49   33   30    0    4  212]]
used_ex_acc:  1.0
used_ex_Confusion Metric: 
 [[ 722    0    0    0    0    0    0]
 [   0 1722    0    0    0    0    0]
 [   0    0  337    0    0    0    0]
 [   0    0    0  810    0    0    0]
 [   0    0    0    0   13    0    0]
 [   0    0    0    0    0  147    0]
 [   0    0    0    0    0    0  212]]
np.mean(reliability_np):  0.6842142530275505
np.median(reliability_np):  0.7069979608058929
np.mean(c_reliability_np):  0.7438630555205775
np.median(c_reliability_np):  0.8045095801353455
np.mean(w_reliability_np):  0.5926521255989369
np.median(w_reliability_np):  0.5700084269046783
self.threshold:  0.8045095801353455
Accuracy:  0.8649507467429298
Confusion Metric: 
 [[3701  263   10  164   78   30   23]
 [ 166 2017    6   11   23    5   10]
 [   9   23  332    0    1    0    1]
 [  85    9    0 1523   19    1    0]
 [ 102   59    1   39  155    3    2]
 [  39    6    1    6    3  183    4]
 [  43   10    0    7    4    9  255]]
Micro Precision/Recall/F-score:  (0.8649507467429298, 0.8649507467429298, 0.8649507467429298, None)
Macro Precision/Recall/F-score:  (0.8230073717793595, 0.7955233389893838, 0.8074865882025917, None)


epoch 32/40
model.reset
self.reset_num:  32
self.cheat:  False
self.mask_p:  1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.4520707552166084
ex_Confusion Metric: 
 [[1296  886  231 1728    1  100   27]
 [ 241 1157  160  660    2   10    8]
 [  16   15  308   24    1    1    1]
 [  47  403   37 1130    5   12    3]
 [  10  122   21  186   15    5    2]
 [   6   23   19   28    0  145   21]
 [   1   33   19   54    0    4  217]]
used_ex_acc:  1.0
used_ex_Confusion Metric: 
 [[1296    0    0    0    0    0    0]
 [   0 1157    0    0    0    0    0]
 [   0    0  308    0    0    0    0]
 [   0    0    0 1130    0    0    0]
 [   0    0    0    0   15    0    0]
 [   0    0    0    0    0  145    0]
 [   0    0    0    0    0    0  217]]
np.mean(reliability_np):  0.7040359262401064
np.median(reliability_np):  0.7375094592571259
np.mean(c_reliability_np):  0.7578895912656688
np.median(c_reliability_np):  0.8175005614757538
np.mean(w_reliability_np):  0.6384155291602341
np.median(w_reliability_np):  0.6440160870552063
self.threshold:  0.8175005614757538
Accuracy:  0.8710941637538396
Confusion Metric: 
 [[3906  192    8   75   36   31   21]
 [ 247 1967    5    1    3    8    7]
 [  15   21  328    0    1    0    1]
 [ 140    2    0 1474   17    3    1]
 [ 150   61    2   27  114    4    3]
 [  48    5    0    3    2  182    2]
 [  50    7    0    4    2   12  253]]
Micro Precision/Recall/F-score:  (0.8710941637538396, 0.8710941637538396, 0.8710941637538396, None)
Macro Precision/Recall/F-score:  (0.8435246728513696, 0.77566823502611, 0.8004679534487308, None)


epoch 33/40
model.reset
self.reset_num:  33
self.cheat:  False
self.mask_p:  1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.4276030081559157
ex_Confusion Metric: 
 [[1014  973  232 1905    2  115   28]
 [ 139 1215  164  700    1   12    7]
 [  10   17  311   24    0    3    1]
 [  31  420   32 1134    3   12    5]
 [   8  127   19  193    7    6    1]
 [   6   25   19   32    0  141   19]
 [   0   31   20   56    0    6  215]]
used_ex_acc:  1.0
used_ex_Confusion Metric: 
 [[1014    0    0    0    0    0    0]
 [   0 1215    0    0    0    0    0]
 [   0    0  311    0    0    0    0]
 [   0    0    0 1134    0    0    0]
 [   0    0    0    0    7    0    0]
 [   0    0    0    0    0  141    0]
 [   0    0    0    0    0    0  215]]
np.mean(reliability_np):  0.7106740236800342
np.median(reliability_np):  0.7426091134548187
np.mean(c_reliability_np):  0.7755964225712229
np.median(c_reliability_np):  0.8402574062347412
np.mean(w_reliability_np):  0.6454173942971326
np.median(w_reliability_np):  0.6497966349124908
self.threshold:  0.8402574062347412
Accuracy:  0.8741658722592945
Confusion Metric: 
 [[3851  163   10  115   70   36   24]
 [ 210 1973    3   14   19    9   10]
 [  12   16  336    0    1    0    1]
 [ 124    1    0 1492   15    2    3]
 [ 120   50    3   30  154    3    1]
 [  42    5    0    6    2  184    3]
 [  45    4    0    3    3   10  263]]
Micro Precision/Recall/F-score:  (0.8741658722592945, 0.8741658722592945, 0.8741658722592944, None)
Macro Precision/Recall/F-score:  (0.8313503898844805, 0.8002691814582515, 0.8138212279393616, None)


epoch 34/40
model.reset
self.reset_num:  34
self.cheat:  False
self.mask_p:  1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.4720898209935388
ex_Confusion Metric: 
 [[1414  868  192 1631    2  128   34]
 [ 220 1205  155  636    3   11    8]
 [  10   18  313   22    0    2    1]
 [  59  380   27 1149    3   16    3]
 [  15  123   15  194    7    6    1]
 [   9   24   16   26    0  146   21]
 [   1   27   14   55    0    8  223]]
used_ex_acc:  1.0
used_ex_Confusion Metric: 
 [[1414    0    0    0    0    0    0]
 [   0 1205    0    0    0    0    0]
 [   0    0  313    0    0    0    0]
 [   0    0    0 1149    0    0    0]
 [   0    0    0    0    7    0    0]
 [   0    0    0    0    0  146    0]
 [   0    0    0    0    0    0  223]]
np.mean(reliability_np):  0.7013141572349337
np.median(reliability_np):  0.7277565896511078
np.mean(c_reliability_np):  0.7591673823377331
np.median(c_reliability_np):  0.8163923621177673
np.mean(w_reliability_np):  0.6197130728489084
np.median(w_reliability_np):  0.6137764751911163
self.threshold:  0.8163923621177673
Accuracy:  0.8738481093104544
Confusion Metric: 
 [[3859  172   14  127   52   24   21]
 [ 229 1969    8    7   12    4    9]
 [  12   10  343    0    0    0    1]
 [ 105    4    0 1512   12    2    2]
 [ 134   55    9   33  127    1    2]
 [  44    5    0    7    2  179    5]
 [  48    6    0    5    3    5  261]]
Micro Precision/Recall/F-score:  (0.8738481093104544, 0.8738481093104544, 0.8738481093104544, None)
Macro Precision/Recall/F-score:  (0.8398499385138706, 0.7902518753650268, 0.809374381712095, None)


epoch 35/40
model.reset
self.reset_num:  35
self.cheat:  False
self.mask_p:  1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.4588496981251986
ex_Confusion Metric: 
 [[1253  947  202 1741    2   96   28]
 [ 167 1250  155  647    2   10    7]
 [   9   17  315   22    0    2    1]
 [  41  398   31 1148    2   15    2]
 [  10  130   16  191    8    5    1]
 [  10   25   18   29    0  139   21]
 [   1   27   15   58    0    8  219]]
used_ex_acc:  1.0
used_ex_Confusion Metric: 
 [[1253    0    0    0    0    0    0]
 [   0 1250    0    0    0    0    0]
 [   0    0  315    0    0    0    0]
 [   0    0    0 1148    0    0    0]
 [   0    0    0    0    8    0    0]
 [   0    0    0    0    0  139    0]
 [   0    0    0    0    0    0  219]]
np.mean(reliability_np):  0.699070522041181
np.median(reliability_np):  0.722477525472641
np.mean(c_reliability_np):  0.7689934809858173
np.median(c_reliability_np):  0.8315277397632599
np.mean(w_reliability_np):  0.6411908279282633
np.median(w_reliability_np):  0.6422878503799438
self.threshold:  0.8315277397632599
Accuracy:  0.870564558839106
Confusion Metric: 
 [[3764  233   13  139   65   34   21]
 [ 182 2022    5    3   11    4   11]
 [   9   16  339    0    1    0    1]
 [  96    4    1 1516   16    2    2]
 [ 121   63    5   32  136    2    2]
 [  43    5    0    7    2  180    5]
 [  40    9    0    5    4    8  262]]
Micro Precision/Recall/F-score:  (0.870564558839106, 0.870564558839106, 0.870564558839106, None)
Macro Precision/Recall/F-score:  (0.827439361354075, 0.7938311176398913, 0.8072140406640863, None)


epoch 36/40
model.reset
self.reset_num:  36
self.cheat:  False
self.mask_p:  1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.4402076051265756
ex_Confusion Metric: 
 [[1080  951  215 1885    3  105   30]
 [ 127 1254  158  678    2   11    8]
 [   9   16  316   22    0    2    1]
 [  36  407   31 1142    4   15    2]
 [   9  130   15  193    8    5    1]
 [   7   25   17   34    0  138   21]
 [   1   28   15   59    0    7  218]]
used_ex_acc:  1.0
used_ex_Confusion Metric: 
 [[1080    0    0    0    0    0    0]
 [   0 1254    0    0    0    0    0]
 [   0    0  316    0    0    0    0]
 [   0    0    0 1142    0    0    0]
 [   0    0    0    0    8    0    0]
 [   0    0    0    0    0  138    0]
 [   0    0    0    0    0    0  218]]
np.mean(reliability_np):  0.7070940917891445
np.median(reliability_np):  0.7362979650497437
np.mean(c_reliability_np):  0.7755203460333322
np.median(c_reliability_np):  0.8418804109096527
np.mean(w_reliability_np):  0.6499740375729248
np.median(w_reliability_np):  0.6575510501861572
self.threshold:  0.8418804109096527
Accuracy:  0.87172968965152
Confusion Metric: 
 [[3800  227   13  117   64   25   23]
 [ 195 2012    6    3   10    3    9]
 [   9   16  339    0    1    0    1]
 [ 106    4    1 1506   16    2    2]
 [ 126   63    5   29  135    1    2]
 [  45    5    0    7    2  178    5]
 [  47    7    0    4    4    6  260]]
Micro Precision/Recall/F-score:  (0.87172968965152, 0.87172968965152, 0.8717296896515201, None)
Macro Precision/Recall/F-score:  (0.8351505801293931, 0.7910773705882773, 0.8092195609286851, None)


epoch 37/40
model.reset
self.reset_num:  37
self.cheat:  False
self.mask_p:  1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.43766550153585426
ex_Confusion Metric: 
 [[1069  951  214 1904    3   98   30]
 [ 130 1249  157  681    2   11    8]
 [  10   17  314   22    0    2    1]
 [  37  411   30 1138    4   15    2]
 [  10  128   15  194    8    5    1]
 [   7   25   17   35    0  137   21]
 [   0   29   16   60    0    6  217]]
used_ex_acc:  1.0
used_ex_Confusion Metric: 
 [[1069    0    0    0    0    0    0]
 [   0 1249    0    0    0    0    0]
 [   0    0  314    0    0    0    0]
 [   0    0    0 1138    0    0    0]
 [   0    0    0    0    8    0    0]
 [   0    0    0    0    0  137    0]
 [   0    0    0    0    0    0  217]]
np.mean(reliability_np):  0.7101062849163102
np.median(reliability_np):  0.7421090602874756
np.mean(c_reliability_np):  0.7770540490205555
np.median(c_reliability_np):  0.8451807498931885
np.mean(w_reliability_np):  0.6547121129471112
np.median(w_reliability_np):  0.6632528901100159
self.threshold:  0.8451807498931885
Accuracy:  0.8722592945662536
Confusion Metric: 
 [[3809  230   12  110   62   24   22]
 [ 194 2013    6    3   11    3    8]
 [   9   18  337    0    1    0    1]
 [ 108    5    1 1503   16    2    2]
 [ 126   63    5   29  136    1    1]
 [  45    6    0    7    2  177    5]
 [  47    7    0    4    4    6  260]]
Micro Precision/Recall/F-score:  (0.8722592945662536, 0.8722592945662536, 0.8722592945662537, None)
Macro Precision/Recall/F-score:  (0.8379229871198003, 0.7902053419834667, 0.8100183779974204, None)


epoch 38/40
model.reset
self.reset_num:  38
self.cheat:  False
self.mask_p:  1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.4359707658087067
ex_Confusion Metric: 
 [[1056  958  211 1919    2   94   29]
 [ 128 1245  157  690    2   11    5]
 [  10   17  314   22    0    2    1]
 [  37  411   29 1140    3   15    2]
 [  10  128   15  194    8    5    1]
 [   7   26   17   35    0  136   21]
 [   0   30   17   60    0    4  217]]
used_ex_acc:  1.0
used_ex_Confusion Metric: 
 [[1056    0    0    0    0    0    0]
 [   0 1245    0    0    0    0    0]
 [   0    0  314    0    0    0    0]
 [   0    0    0 1140    0    0    0]
 [   0    0    0    0    8    0    0]
 [   0    0    0    0    0  136    0]
 [   0    0    0    0    0    0  217]]
np.mean(reliability_np):  0.7116708823226952
np.median(reliability_np):  0.7443642020225525
np.mean(c_reliability_np):  0.7783325071852977
np.median(c_reliability_np):  0.8471914529800415
np.mean(w_reliability_np):  0.657964022534554
np.median(w_reliability_np):  0.6680477857589722
self.threshold:  0.8471914529800415
Accuracy:  0.8718356106344667
Confusion Metric: 
 [[3807  232   13  111   63   21   22]
 [ 194 2011    6    3   12    4    8]
 [  11   17  336    0    1    0    1]
 [ 106    6    1 1504   16    2    2]
 [ 125   64    4   29  136    1    2]
 [  45    6    0    8    2  176    5]
 [  47    8    0    4    3    5  261]]
Micro Precision/Recall/F-score:  (0.8718356106344667, 0.8718356106344667, 0.8718356106344667, None)
Macro Precision/Recall/F-score:  (0.8384207552597494, 0.7895529181767887, 0.8098928621619191, None)


epoch 39/40
model.reset
self.reset_num:  39
self.cheat:  False
self.mask_p:  1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.4368181336722805
ex_Confusion Metric: 
 [[1062  939  208 1929    3   99   29]
 [ 128 1246  155  692    2   11    4]
 [  10   17  313   23    0    2    1]
 [  37  405   32 1143    3   15    2]
 [  11  127   15  196    7    4    1]
 [   7   25   17   36    0  136   21]
 [   1   28   16   60    0    6  217]]
used_ex_acc:  1.0
used_ex_Confusion Metric: 
 [[1062    0    0    0    0    0    0]
 [   0 1246    0    0    0    0    0]
 [   0    0  313    0    0    0    0]
 [   0    0    0 1143    0    0    0]
 [   0    0    0    0    7    0    0]
 [   0    0    0    0    0  136    0]
 [   0    0    0    0    0    0  217]]
np.mean(reliability_np):  0.7128628593218954
np.median(reliability_np):  0.7474739253520966
np.mean(c_reliability_np):  0.7776116968957286
np.median(c_reliability_np):  0.8485091328620911
np.mean(w_reliability_np):  0.6593149257166977
np.median(w_reliability_np):  0.6692781448364258
self.threshold:  0.8485091328620911
Accuracy:  0.8718356106344667
Confusion Metric: 
 [[3819  228   13  103   63   23   20]
 [ 197 2009    5    4   12    3    8]
 [  11   16  337    0    1    0    1]
 [ 115    6    1 1494   17    2    2]
 [ 128   62    4   29  135    1    2]
 [  45    6    0    7    2  177    5]
 [  49    7    0    4    3    5  260]]
Micro Precision/Recall/F-score:  (0.8718356106344667, 0.8718356106344667, 0.8718356106344667, None)
Macro Precision/Recall/F-score:  (0.8390207361187587, 0.7891035153861684, 0.8100216633183589, None)
best_epoch:  3 0.8471795524493372 0.8834869187586061


test print 
Accuracy:  0.8524962178517398
Confusion Metric: 
 [[3099  194   12  119   60   21   35]
 [ 148 1545    6    2   14   10    8]
 [  15   24  277    2    4    1    0]
 [ 120    4    4 1434   11    3    1]
 [ 136   69    4   19   77    6    5]
 [  49    6    0    0    2  141    9]
 [  32    2    0    9    3    1  189]]
Micro Precision/Recall/F-score:  (0.8524962178517398, 0.8524962178517398, 0.8524962178517398, None)
Macro Precision/Recall/F-score:  (0.7862592403194955, 0.7513608183108723, 0.7637076421860389, None)
test f1:   0.7637076421860389 [0.7637076421860389]
test ass:  0.8524962178517398 [0.8524962178517398]
valid f1:  0.8471795524493372 [0.8471795524493372]
valid acc: 0.8834869187586061 [0.8834869187586061]
