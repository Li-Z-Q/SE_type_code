['/home/lizhuoqun/SE_type_code', '/home/lizhuoqun/anconda/envs/py38/lib/python38.zip', '/home/lizhuoqun/anconda/envs/py38/lib/python3.8', '/home/lizhuoqun/anconda/envs/py38/lib/python3.8/lib-dynload', '/home/lizhuoqun/anconda/envs/py38/lib/python3.8/site-packages', '/home/lizhuoqun/SE_type_code/data', '/home/lizhuoqun/SE_type_code/models', '/home/lizhuoqun/SE_type_code/tools', '/home/lizhuoqun/SE_type_code/resource', '/home/lizhuoqun/SE_type_code/pre_train']
sentence level BiLSTM extra
___________****************************************** 300 ********************************************************************************
paragraph level BiLSTM label embedding MLP pre
Namespace(BATCH_SIZE=128, DROPOUT=0.5, EPOCHs=40, LEARN_RATE=0.001, WEIGHT_DECAY=0.0001, cheat='False', fold_num=2, mask_p=1.0)




time= 0
self.BiLSTM_1_require_grad:  True
self.cheat:  False
self.mask_p:  1.0
self.threshold:  0.8
start to get stanford
already get stanford
start get bert_tokenizer
get bert tokenizer
if_do_embedding:  True
start read data catalogue
start get train data
already deal 10 file
already deal 20 file
already deal 30 file
already deal 40 file
already deal 50 file
already deal 60 file
already deal 70 file
already deal 80 file
already deal 90 file
already deal 100 file
already deal 110 file
already deal 120 file
already deal 130 file
already deal 140 file
already deal 150 file
already deal 160 file
already deal 170 file
already deal 180 file
already deal 190 file
already deal 200 file
already deal 210 file
already deal 220 file
already deal 230 file
already deal 240 file
already deal 250 file
already deal 260 file
already deal 270 file
already deal 280 file
len(train_valid_data_list):  3368
already deal 10 file
already deal 20 file
already deal 30 file
already deal 40 file
already deal 50 file
already deal 60 file
already deal 70 file
already deal 80 file
complete get data, len(test_data_list):  919


start sentence level BiLSTM  extra


epoch 0/4


epoch 1/4


epoch 2/4


epoch 3/4
sentence level BiLSTM  extra best_epoch:  3 -1 -1
sentence level BiLSTM  extra end

********************************************


epoch 0/40
model.reset
self.reset_num:  0
self.cheat:  False
self.mask_p:  1.0
self.valid_flag:  False
self.BiLSTM_1_require_grad:  True
Accuracy:  0.8932184338703635
Confusion Metric: 
 [[3565   35    0   14    7    6    7]
 [ 371 1528    0    4    2    4    1]
 [  33    7  302    0    1    2    0]
 [  87    3    0 1442    4    0    0]
 [ 161    7    0    5   37    0    0]
 [  53    2    0    0    0  146    1]
 [  29    5    0    2    1    1  132]]
Micro Precision/Recall/F-score:  (0.8932184338703635, 0.8932184338703635, 0.8932184338703635, None)
Macro Precision/Recall/F-score:  (0.905855948875433, 0.7529443431507507, 0.800966164576434, None)


epoch 1/40
model.reset
self.reset_num:  1
self.cheat:  False
self.mask_p:  1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.5510178593730486
ex_Confusion Metric: 
 [[1028  352   65 1990   27  147   25]
 [  85 1440  125  204   15   17   24]
 [   9   29  302    5    0    0    0]
 [  23  131    4 1337   19   13    9]
 [  16   76    8   69   28    4    9]
 [   6    3    4   32    0  145   12]
 [   2    4    9   13    1    9  132]]
used_ex_acc:  1.0
used_ex_Confusion Metric: 
 [[1028    0    0    0    0    0    0]
 [   0 1440    0    0    0    0    0]
 [   0    0  302    0    0    0    0]
 [   0    0    0 1337    0    0    0]
 [   0    0    0    0   28    0    0]
 [   0    0    0    0    0  145    0]
 [   0    0    0    0    0    0  132]]
np.mean(reliability_np):  0.7834012365712762
np.median(reliability_np):  0.841921329498291
np.mean(c_reliability_np):  0.8122824114103103
np.median(c_reliability_np):  0.8851645588874817
np.mean(w_reliability_np):  0.7124545374193509
np.median(w_reliability_np):  0.733814001083374
self.threshold:  0.8851645588874817
Accuracy:  0.894467341076558
Confusion Metric: 
 [[3566   10    0   31    8   16    3]
 [ 349 1544    0    8    0    8    1]
 [  40    2  303    0    0    0    0]
 [ 106    0    0 1430    0    0    0]
 [ 164    0    0    9   34    3    0]
 [  62    0    0    0    0  139    1]
 [  19    2    0    1    1    1  146]]
Micro Precision/Recall/F-score:  (0.894467341076558, 0.894467341076558, 0.894467341076558, None)
Macro Precision/Recall/F-score:  (0.9108501171450526, 0.7582517652201659, 0.8006083799534032, None)


epoch 2/40
model.reset
self.reset_num:  2
self.cheat:  False
self.mask_p:  1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.5697514674659673
ex_Confusion Metric: 
 [[1191  583   61 1644   11   75   69]
 [  60 1512  102  185    7    6   38]
 [   2   34  303    4    0    0    2]
 [  71  142    2 1284   18    7   12]
 [  13   91    7   68   20    1   10]
 [   8    7    3   36    1  106   41]
 [   2    4    4   12    0    2  146]]
used_ex_acc:  1.0
used_ex_Confusion Metric: 
 [[1191    0    0    0    0    0    0]
 [   0 1512    0    0    0    0    0]
 [   0    0  303    0    0    0    0]
 [   0    0    0 1284    0    0    0]
 [   0    0    0    0   20    0    0]
 [   0    0    0    0    0  106    0]
 [   0    0    0    0    0    0  146]]
np.mean(reliability_np):  0.745778122678459
np.median(reliability_np):  0.7827143669128418
np.mean(c_reliability_np):  0.8117473236677523
np.median(c_reliability_np):  0.8786853551864624
np.mean(w_reliability_np):  0.710106793136832
np.median(w_reliability_np):  0.7292644381523132
self.threshold:  0.8786853551864624
Accuracy:  0.888472586486824
Confusion Metric: 
 [[3396  150    0   39   38    7    4]
 [ 311 1572    0    7   16    3    1]
 [  17   14  313    1    0    0    0]
 [  41   18    0 1473    3    1    0]
 [  95   42    0    6   65    2    0]
 [  48    4    0    0    0  149    1]
 [  16    5    0    2    0    1  146]]
Micro Precision/Recall/F-score:  (0.888472586486824, 0.888472586486824, 0.888472586486824, None)
Macro Precision/Recall/F-score:  (0.8725409169407995, 0.7899637045953506, 0.8246631680695649, None)


epoch 3/40
model.reset
self.reset_num:  3
self.cheat:  False
self.mask_p:  1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.5088047958036718
ex_Confusion Metric: 
 [[ 886  332   75 2075   32  181   53]
 [  31 1239  181  395   13   12   39]
 [   1   18  313   10    0    0    3]
 [  45  119    3 1323   17   16   13]
 [   6   63   10   86   30    3   12]
 [   9    9    4   25    0  138   17]
 [   2    2    5   11    0    5  145]]
used_ex_acc:  1.0
used_ex_Confusion Metric: 
 [[ 886    0    0    0    0    0    0]
 [   0 1239    0    0    0    0    0]
 [   0    0  313    0    0    0    0]
 [   0    0    0 1323    0    0    0]
 [   0    0    0    0   30    0    0]
 [   0    0    0    0    0  138    0]
 [   0    0    0    0    0    0  145]]
np.mean(reliability_np):  0.7488855639168476
np.median(reliability_np):  0.7970546782016754
np.mean(c_reliability_np):  0.7929558386266319
np.median(c_reliability_np):  0.8560372591018677
np.mean(w_reliability_np):  0.704832651037434
np.median(w_reliability_np):  0.7271590828895569
self.threshold:  0.8560372591018677
Accuracy:  0.8984638441363807
Confusion Metric: 
 [[3398  148    0   43   29   14    2]
 [ 234 1643    0   14   11    7    1]
 [  18   13  314    0    0    0    0]
 [  53   12    0 1465    4    2    0]
 [  89   41    0    7   72    1    0]
 [  46    3    0    1    0  151    1]
 [  14    2    0    2    1    0  151]]
Micro Precision/Recall/F-score:  (0.8984638441363807, 0.8984638441363807, 0.8984638441363807, None)
Macro Precision/Recall/F-score:  (0.8818893294887822, 0.8054007671855172, 0.8368030237402271, None)


epoch 4/40
model.reset
self.reset_num:  4
self.cheat:  False
self.mask_p:  1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.5496440614462346
ex_Confusion Metric: 
 [[1174  384   79 1619   22  196  160]
 [  50 1350  156  265    8   15   66]
 [   1   21  314    5    0    1    3]
 [  79  132    3 1249   17   24   32]
 [   7   71    6   76   28    4   18]
 [  15    6    4   15    0  135   27]
 [   4    1    4    8    0    2  151]]
used_ex_acc:  1.0
used_ex_Confusion Metric: 
 [[1174    0    0    0    0    0    0]
 [   0 1350    0    0    0    0    0]
 [   0    0  314    0    0    0    0]
 [   0    0    0 1249    0    0    0]
 [   0    0    0    0   28    0    0]
 [   0    0    0    0    0  135    0]
 [   0    0    0    0    0    0  151]]
np.mean(reliability_np):  0.7598528895065829
np.median(reliability_np):  0.8127591609954834
np.mean(c_reliability_np):  0.8112771001844833
np.median(c_reliability_np):  0.8846055865287781
np.mean(w_reliability_np):  0.7042859933621607
np.median(w_reliability_np):  0.7261237800121307
self.threshold:  0.8846055865287781
Accuracy:  0.8897214936930186
Confusion Metric: 
 [[3368  191    0   24   32   19    0]
 [ 278 1588    0   13   20   11    0]
 [  20   26  299    0    0    0    0]
 [  24   11    0 1496    5    0    0]
 [  79   49    0    3   74    5    0]
 [  37    4    0    1    0  160    0]
 [  22    4    0    3    0    2  139]]
Micro Precision/Recall/F-score:  (0.8897214936930186, 0.8897214936930186, 0.8897214936930186, None)
Macro Precision/Recall/F-score:  (0.868023901876514, 0.7944211790378203, 0.8256020861138108, None)


epoch 5/40
model.reset
self.reset_num:  5
self.cheat:  False
self.mask_p:  1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.5167978019233171
ex_Confusion Metric: 
 [[1037  211   46 2085   19  183   53]
 [  84 1111  126  519    9   18   43]
 [  10   22  299   10    1    1    2]
 [  38   71    3 1390    6   16   12]
 [  13   43    3  119   17    5   10]
 [   9    7    3   23    0  145   15]
 [   3    1    4   15    0    8  139]]
used_ex_acc:  1.0
used_ex_Confusion Metric: 
 [[1037    0    0    0    0    0    0]
 [   0 1111    0    0    0    0    0]
 [   0    0  299    0    0    0    0]
 [   0    0    0 1390    0    0    0]
 [   0    0    0    0   17    0    0]
 [   0    0    0    0    0  145    0]
 [   0    0    0    0    0    0  139]]
np.mean(reliability_np):  0.7832106130221911
np.median(reliability_np):  0.8484638035297394
np.mean(c_reliability_np):  0.8379435686060575
np.median(c_reliability_np):  0.9168114960193634
np.mean(w_reliability_np):  0.7563916766988612
np.median(w_reliability_np):  0.8150341510772705
self.threshold:  0.9168114960193634
Accuracy:  0.8842263019857625
Confusion Metric: 
 [[3400  152    0   16   42   11   13]
 [ 331 1525    1   18   28    6    1]
 [  26   16  303    0    0    0    0]
 [  35   12    0 1479   10    0    0]
 [  80   41    0    4   82    3    0]
 [  38    7    0    1    0  155    1]
 [  23    5    0    4    1    1  136]]
Micro Precision/Recall/F-score:  (0.8842263019857625, 0.8842263019857625, 0.8842263019857625, None)
Macro Precision/Recall/F-score:  (0.8549732640082205, 0.790427411768692, 0.8197619825953594, None)


epoch 6/40
model.reset
self.reset_num:  6
self.cheat:  False
self.mask_p:  1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.5161733483202198
ex_Confusion Metric: 
 [[1276  174   68 1914   12  163   27]
 [ 172  904  192  581    6   21   34]
 [  11   13  302   14    0    4    1]
 [  79   63    4 1348   11   23    8]
 [  19   49    9   97   20    6   10]
 [  12    3    4   22    0  149   12]
 [   5    1    5   16    0    9  134]]
used_ex_acc:  1.0
used_ex_Confusion Metric: 
 [[1276    0    0    0    0    0    0]
 [   0  904    0    0    0    0    0]
 [   0    0  302    0    0    0    0]
 [   0    0    0 1348    0    0    0]
 [   0    0    0    0   20    0    0]
 [   0    0    0    0    0  149    0]
 [   0    0    0    0    0    0  134]]
np.mean(reliability_np):  0.7700142647450093
np.median(reliability_np):  0.8268462717533112
np.mean(c_reliability_np):  0.821250185763435
np.median(c_reliability_np):  0.8972629308700562
np.mean(w_reliability_np):  0.7338469081284709
np.median(w_reliability_np):  0.7687782347202301
self.threshold:  0.8972629308700562
Accuracy:  0.8898463844136381
Confusion Metric: 
 [[3371  121    0   36   87   13    6]
 [ 251 1586    1   11   53    8    0]
 [  18   12  313    0    2    0    0]
 [  40   10    0 1468   17    1    0]
 [  79   22    0    9   99    1    0]
 [  41    4    0    1    3  151    2]
 [  22    5    0    3    1    2  137]]
Micro Precision/Recall/F-score:  (0.8898463844136381, 0.8898463844136381, 0.8898463844136381, None)
Macro Precision/Recall/F-score:  (0.8459040450089395, 0.8065436672346664, 0.8235666627557434, None)


epoch 7/40
model.reset
self.reset_num:  7
self.cheat:  False
self.mask_p:  1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.5473960284750843
ex_Confusion Metric: 
 [[1362  329   97 1647   15  148   36]
 [  88 1150  206  402   11   12   41]
 [   5   15  313   10    0    0    2]
 [  99  125    5 1257   22   22    6]
 [  17   59    9   88   25    3    9]
 [  16    6    4   18    0  139   19]
 [   7    1    5   13    0    7  137]]
used_ex_acc:  1.0
used_ex_Confusion Metric: 
 [[1362    0    0    0    0    0    0]
 [   0 1150    0    0    0    0    0]
 [   0    0  313    0    0    0    0]
 [   0    0    0 1257    0    0    0]
 [   0    0    0    0   25    0    0]
 [   0    0    0    0    0  139    0]
 [   0    0    0    0    0    0  137]]
np.mean(reliability_np):  0.7762482249278121
np.median(reliability_np):  0.8395282328128815
np.mean(c_reliability_np):  0.8121045825927735
np.median(c_reliability_np):  0.8844287991523743
np.mean(w_reliability_np):  0.7243141991972397
np.median(w_reliability_np):  0.7639788687229156
self.threshold:  0.8844287991523743
Accuracy:  0.8869738978393905
Confusion Metric: 
 [[3395  116    2   28   62   22    9]
 [ 289 1512    9   20   69    7    4]
 [  16   16  311    0    2    0    0]
 [  32    5    0 1493    5    1    0]
 [  67   42    0    3   96    2    0]
 [  30    6    0    1    3  160    2]
 [  17    3    2    8    0    5  135]]
Micro Precision/Recall/F-score:  (0.8869738978393905, 0.8869738978393905, 0.8869738978393905, None)
Macro Precision/Recall/F-score:  (0.8300906784844219, 0.8060927833472092, 0.8167305885482534, None)


epoch 8/40
model.reset
self.reset_num:  8
self.cheat:  False
self.mask_p:  1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.5339078306481828
ex_Confusion Metric: 
 [[1461  135   58 1773   14  173   20]
 [ 229  863  205  547   20   18   28]
 [  15    8  309   13    0    0    0]
 [  81   64    5 1335   11   33    7]
 [  30   35    6  100   26    5    8]
 [  16    5    3   17    0  148   13]
 [   7    1    5   14    0   10  133]]
used_ex_acc:  1.0
used_ex_Confusion Metric: 
 [[1461    0    0    0    0    0    0]
 [   0  863    0    0    0    0    0]
 [   0    0  309    0    0    0    0]
 [   0    0    0 1335    0    0    0]
 [   0    0    0    0   26    0    0]
 [   0    0    0    0    0  148    0]
 [   0    0    0    0    0    0  133]]
np.mean(reliability_np):  0.7747861973716348
np.median(reliability_np):  0.8364554345607758
np.mean(c_reliability_np):  0.820581309251618
np.median(c_reliability_np):  0.8984364867210388
np.mean(w_reliability_np):  0.7323613948680836
np.median(w_reliability_np):  0.7734682857990265
self.threshold:  0.8984364867210388
Accuracy:  0.8831022855001873
Confusion Metric: 
 [[3331  161    0   29   77   30    6]
 [ 279 1551    2   10   56   12    0]
 [  19   13  312    1    0    0    0]
 [  33    7    0 1488    7    1    0]
 [  69   40    0    4   93    4    0]
 [  31    4    0    1    3  162    1]
 [  14    4    1    8    0    9  134]]
Micro Precision/Recall/F-score:  (0.8831022855001873, 0.8831022855001873, 0.8831022855001873, None)
Macro Precision/Recall/F-score:  (0.8281604786100588, 0.8049761642029417, 0.8146487668250691, None)


epoch 9/40
model.reset
self.reset_num:  9
self.cheat:  False
self.mask_p:  1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.5003122268015486
ex_Confusion Metric: 
 [[1145  253   87 1874   17  231   27]
 [  86  917  213  616   17   23   38]
 [   6   12  311   15    0    1    0]
 [  78   70    3 1331   11   39    4]
 [  14   43    9  111   21    5    7]
 [  12    4    4   16    0  149   17]
 [   5    1    6   15    0   11  132]]
used_ex_acc:  1.0
used_ex_Confusion Metric: 
 [[1145    0    0    0    0    0    0]
 [   0  917    0    0    0    0    0]
 [   0    0  311    0    0    0    0]
 [   0    0    0 1331    0    0    0]
 [   0    0    0    0   21    0    0]
 [   0    0    0    0    0  149    0]
 [   0    0    0    0    0    0  132]]
np.mean(reliability_np):  0.7786898801413259
np.median(reliability_np):  0.8419163227081299
np.mean(c_reliability_np):  0.8231216799867671
np.median(c_reliability_np):  0.9056302607059479
np.mean(w_reliability_np):  0.7410647077721019
np.median(w_reliability_np):  0.7900468707084656
self.threshold:  0.9056302607059479
Accuracy:  0.8818533782939928
Confusion Metric: 
 [[3287  197    1   25   93   24    7]
 [ 256 1580    1    5   53   15    0]
 [  18   15  311    0    1    0    0]
 [  23    6    0 1502    4    1    0]
 [  67   50    0    4   85    4    0]
 [  36    4    0    1    0  161    0]
 [  20    4    1    6    0    4  135]]
Micro Precision/Recall/F-score:  (0.8818533782939928, 0.8818533782939928, 0.8818533782939928, None)
Macro Precision/Recall/F-score:  (0.8261538329920504, 0.8009944539690634, 0.8120151678587018, None)


epoch 10/40
model.reset
self.reset_num:  10
self.cheat:  False
self.mask_p:  1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.4237542150618209
ex_Confusion Metric: 
 [[ 557  284  121 2408   10  221   33]
 [  25  792  237  793    8   21   34]
 [   2    9  306   25    0    1    2]
 [  11   41    3 1442    2   30    7]
 [   6   29   11  140   12    5    7]
 [   5    2    4   24    0  152   15]
 [   0    1    5   21    0   11  132]]
used_ex_acc:  1.0
used_ex_Confusion Metric: 
 [[ 557    0    0    0    0    0    0]
 [   0  792    0    0    0    0    0]
 [   0    0  306    0    0    0    0]
 [   0    0    0 1442    0    0    0]
 [   0    0    0    0   12    0    0]
 [   0    0    0    0    0  152    0]
 [   0    0    0    0    0    0  132]]
np.mean(reliability_np):  0.7927119899126109
np.median(reliability_np):  0.8613729476928711
np.mean(c_reliability_np):  0.8393316343009489
np.median(c_reliability_np):  0.9305586814880371
np.mean(w_reliability_np):  0.777921762086506
np.median(w_reliability_np):  0.8433932662010193
self.threshold:  0.9305586814880371
Accuracy:  0.8751092793805421
Confusion Metric: 
 [[3124  366    0   24   84   20   16]
 [ 166 1688    5    6   33    8    4]
 [  11   20  314    0    0    0    0]
 [  22   11    0 1498    2    2    1]
 [  52   74    1    3   78    1    1]
 [  23   10    0    0    1  164    4]
 [  14    4    1    5    2    3  141]]
Micro Precision/Recall/F-score:  (0.8751092793805421, 0.8751092793805421, 0.8751092793805421, None)
Macro Precision/Recall/F-score:  (0.8154922936252947, 0.805936468595693, 0.8098676680519342, None)


epoch 11/40
model.reset
self.reset_num:  11
self.cheat:  False
self.mask_p:  1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.44561009117022604
ex_Confusion Metric: 
 [[ 774  141   67 2316    8  286   42]
 [ 110  764  235  722    5   33   41]
 [   8   10  307   16    0    2    2]
 [  14   41    3 1418    0   49   11]
 [  18   22    9  133   13    8    7]
 [   8    2    3   18    0  155   16]
 [   1    0    5   17    0   10  137]]
used_ex_acc:  1.0
used_ex_Confusion Metric: 
 [[ 774    0    0    0    0    0    0]
 [   0  764    0    0    0    0    0]
 [   0    0  307    0    0    0    0]
 [   0    0    0 1418    0    0    0]
 [   0    0    0    0   13    0    0]
 [   0    0    0    0    0  155    0]
 [   0    0    0    0    0    0  137]]
np.mean(reliability_np):  0.7963835118370444
np.median(reliability_np):  0.8664774894714355
np.mean(c_reliability_np):  0.8333484636569571
np.median(c_reliability_np):  0.9155600070953369
np.mean(w_reliability_np):  0.7567506074388437
np.median(w_reliability_np):  0.8103919625282288
self.threshold:  0.9155600070953369
Accuracy:  0.860372174347446
Confusion Metric: 
 [[2912  574    0   65   55    6   22]
 [  71 1811    0   10   13    3    2]
 [   7   21  316    1    0    0    0]
 [  17   28    0 1488    2    1    0]
 [  36   96    0   11   65    1    1]
 [  22   13    0    3    1  156    7]
 [  10    7    1    7    1    3  141]]
Micro Precision/Recall/F-score:  (0.860372174347446, 0.860372174347446, 0.8603721743474461, None)
Macro Precision/Recall/F-score:  (0.8285661644784845, 0.7921990326804356, 0.803417922770504, None)


epoch 12/40
model.reset
self.reset_num:  12
self.cheat:  False
self.mask_p:  1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.4883227176220807
ex_Confusion Metric: 
 [[ 929  278   97 2045    3  253   29]
 [  93 1000  267  490    4   27   29]
 [   5   11  316    9    0    2    2]
 [  28   78    4 1371    6   41    8]
 [  18   51   11  107    9    7    7]
 [   9    2    5   18    0  148   20]
 [   2    1    5   14    0   11  137]]
used_ex_acc:  1.0
used_ex_Confusion Metric: 
 [[ 929    0    0    0    0    0    0]
 [   0 1000    0    0    0    0    0]
 [   0    0  316    0    0    0    0]
 [   0    0    0 1371    0    0    0]
 [   0    0    0    0    9    0    0]
 [   0    0    0    0    0  148    0]
 [   0    0    0    0    0    0  137]]
np.mean(reliability_np):  0.7856681779059643
np.median(reliability_np):  0.8510143458843231
np.mean(c_reliability_np):  0.8301189881380256
np.median(c_reliability_np):  0.9073762595653534
np.mean(w_reliability_np):  0.7465371298613943
np.median(w_reliability_np):  0.7975901365280151
self.threshold:  0.9073762595653534
Accuracy:  0.9008367678281504
Confusion Metric: 
 [[3402  190    0   16   16    3    7]
 [ 214 1677    3    5    6    4    1]
 [  11   11  323    0    0    0    0]
 [  58   19    1 1454    3    1    0]
 [  84   61    2    5   56    2    0]
 [  36    6    0    1    0  157    2]
 [  16    5    1    4    0    0  144]]
Micro Precision/Recall/F-score:  (0.9008367678281504, 0.9008367678281504, 0.9008367678281504, None)
Macro Precision/Recall/F-score:  (0.8952141987985922, 0.7982812363701166, 0.8316687461617069, None)


epoch 13/40
model.reset
self.reset_num:  13
self.cheat:  False
self.mask_p:  1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.49868864743349567
ex_Confusion Metric: 
 [[ 969  262  121 1948    4  280   50]
 [  81 1050  324  376    7   29   43]
 [   3   11  323    6    0    0    2]
 [  29   83    5 1350    5   50   14]
 [  15   48   13  101   13    7   13]
 [   7    2    6   16    0  145   26]
 [   3    0    6    9    0    9  143]]
used_ex_acc:  1.0
used_ex_Confusion Metric: 
 [[ 969    0    0    0    0    0    0]
 [   0 1050    0    0    0    0    0]
 [   0    0  323    0    0    0    0]
 [   0    0    0 1350    0    0    0]
 [   0    0    0    0   13    0    0]
 [   0    0    0    0    0  145    0]
 [   0    0    0    0    0    0  143]]
np.mean(reliability_np):  0.7658114413448784
np.median(reliability_np):  0.8258489668369293
np.mean(c_reliability_np):  0.8124323166531786
np.median(c_reliability_np):  0.8883903622627258
np.mean(w_reliability_np):  0.7115477290566905
np.median(w_reliability_np):  0.7477320730686188
self.threshold:  0.8883903622627258
Accuracy:  0.900462095666292
Confusion Metric: 
 [[3424  129    1   23   45    7    5]
 [ 258 1600    3    8   37    3    1]
 [  14    9  319    0    2    1    0]
 [  42    8    0 1480    5    1    0]
 [  79   36    1    7   86    1    0]
 [  35    5    0    1    0  160    1]
 [  20    3    1    3    1    1  141]]
Micro Precision/Recall/F-score:  (0.900462095666292, 0.900462095666292, 0.9004620956662921, None)
Macro Precision/Recall/F-score:  (0.8704249653778147, 0.8141575575914085, 0.8401207880003649, None)


epoch 14/40
model.reset
self.reset_num:  14
self.cheat:  False
self.mask_p:  1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.48295241663544397
ex_Confusion Metric: 
 [[ 835  277   92 2074   10  297   49]
 [  75 1044  259  446    9   35   42]
 [   4   11  317    9    0    2    2]
 [  17   83    4 1367    4   49   12]
 [  13   49   11  104   15    7   11]
 [   5    3    4   19    0  149   22]
 [   1    0    5   14    0   10  140]]
used_ex_acc:  1.0
used_ex_Confusion Metric: 
 [[ 835    0    0    0    0    0    0]
 [   0 1044    0    0    0    0    0]
 [   0    0  317    0    0    0    0]
 [   0    0    0 1367    0    0    0]
 [   0    0    0    0   15    0    0]
 [   0    0    0    0    0  149    0]
 [   0    0    0    0    0    0  140]]
np.mean(reliability_np):  0.7749878082845783
np.median(reliability_np):  0.8377283215522766
np.mean(c_reliability_np):  0.8260579228879008
np.median(c_reliability_np):  0.9080817103385925
np.mean(w_reliability_np):  0.7366795062658867
np.median(w_reliability_np):  0.7854414582252502
self.threshold:  0.9080817103385925
Accuracy:  0.8954664668415137
Confusion Metric: 
 [[3429  120    0   18   49   16    2]
 [ 280 1572    2    9   40    6    1]
 [  15    9  318    0    2    1    0]
 [  46   12    0 1467   10    1    0]
 [  79   38    0    7   83    3    0]
 [  35    4    0    1    0  162    0]
 [  20    2    1    5    1    2  139]]
Micro Precision/Recall/F-score:  (0.8954664668415137, 0.8954664668415137, 0.8954664668415137, None)
Macro Precision/Recall/F-score:  (0.8589768053522685, 0.8083296555924199, 0.8317154749075703, None)


epoch 15/40
model.reset
self.reset_num:  15
self.cheat:  False
self.mask_p:  1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.5009366804046459
ex_Confusion Metric: 
 [[ 906  311   82 2045   11  247   32]
 [  63 1115  241  430    8   24   29]
 [   3   12  316   10    0    2    2]
 [  27   84    3 1371    4   39    8]
 [  12   50    9  110   18    6    5]
 [   9    3    5   20    0  147   18]
 [   2    1    5   14    0   10  138]]
used_ex_acc:  1.0
used_ex_Confusion Metric: 
 [[ 906    0    0    0    0    0    0]
 [   0 1115    0    0    0    0    0]
 [   0    0  316    0    0    0    0]
 [   0    0    0 1371    0    0    0]
 [   0    0    0    0   18    0    0]
 [   0    0    0    0    0  147    0]
 [   0    0    0    0    0    0  138]]
np.mean(reliability_np):  0.7770538900873518
np.median(reliability_np):  0.8423351049423218
np.mean(c_reliability_np):  0.8270591946276487
np.median(c_reliability_np):  0.908403217792511
np.mean(w_reliability_np):  0.7417513029211694
np.median(w_reliability_np):  0.7936428785324097
self.threshold:  0.908403217792511
Accuracy:  0.8882228050455852
Confusion Metric: 
 [[3245  228    7   58   70   11   15]
 [ 168 1675    5   14   39    4    5]
 [   7   11  323    1    1    1    1]
 [  47    9    0 1474    5    1    0]
 [  61   49    1   12   83    2    2]
 [  23    4    0    1    0  172    2]
 [  15    2    3    6    1    3  140]]
Micro Precision/Recall/F-score:  (0.8882228050455852, 0.8882228050455852, 0.8882228050455853, None)
Macro Precision/Recall/F-score:  (0.8290029013009594, 0.819434104007328, 0.8240270275050152, None)


epoch 16/40
model.reset
self.reset_num:  16
self.cheat:  False
self.mask_p:  1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.47895591357562134
ex_Confusion Metric: 
 [[ 803  374  116 1859   11  450   21]
 [  44 1075  258  443    8   50   32]
 [   2   12  316   10    0    3    2]
 [  27   93    3 1332    5   69    7]
 [  12   52   11  109   11   10    5]
 [   3    2    5   13    0  164   15]
 [   2    1    6   12    0   15  134]]
used_ex_acc:  1.0
used_ex_Confusion Metric: 
 [[ 803    0    0    0    0    0    0]
 [   0 1075    0    0    0    0    0]
 [   0    0  316    0    0    0    0]
 [   0    0    0 1332    0    0    0]
 [   0    0    0    0   11    0    0]
 [   0    0    0    0    0  164    0]
 [   0    0    0    0    0    0  134]]
np.mean(reliability_np):  0.7842679937547813
np.median(reliability_np):  0.8506762087345123
np.mean(c_reliability_np):  0.8244424338873859
np.median(c_reliability_np):  0.9092044830322266
np.mean(w_reliability_np):  0.7462876043992326
np.median(w_reliability_np):  0.8033497035503387
self.threshold:  0.9092044830322266
Accuracy:  0.8902210565754964
Confusion Metric: 
 [[3340  160    5   61   43   24    1]
 [ 253 1600    8   15   21   13    0]
 [  13    9  319    1    1    2    0]
 [  30    7    0 1496    2    1    0]
 [  68   56    2   12   66    6    0]
 [  29    5    0    1    0  167    0]
 [  15    4    2    6    0    3  140]]
Micro Precision/Recall/F-score:  (0.8902210565754964, 0.8902210565754964, 0.8902210565754964, None)
Macro Precision/Recall/F-score:  (0.8445192331583848, 0.8028482231725275, 0.8193704594056832, None)


epoch 17/40
model.reset
self.reset_num:  17
self.cheat:  False
self.mask_p:  1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.45447733233420756
ex_Confusion Metric: 
 [[ 591  293   74 2258   16  347   55]
 [  51 1055  230  481    7   39   47]
 [   2   15  314    9    0    2    3]
 [  12   78    5 1378    4   47   12]
 [  12   46   10  112   13    7   10]
 [   4    3    3   19    0  149   24]
 [   1    0    5   15    0   10  139]]
used_ex_acc:  1.0
used_ex_Confusion Metric: 
 [[ 591    0    0    0    0    0    0]
 [   0 1055    0    0    0    0    0]
 [   0    0  314    0    0    0    0]
 [   0    0    0 1378    0    0    0]
 [   0    0    0    0   13    0    0]
 [   0    0    0    0    0  149    0]
 [   0    0    0    0    0    0  139]]
np.mean(reliability_np):  0.7746649705083118
np.median(reliability_np):  0.8395299315452576
np.mean(c_reliability_np):  0.8270311539777199
np.median(c_reliability_np):  0.9110561609268188
np.mean(w_reliability_np):  0.7422850889566562
np.median(w_reliability_np):  0.7982917428016663
self.threshold:  0.9110561609268188
Accuracy:  0.8977144998126639
Confusion Metric: 
 [[3427  140    7   13   24   16    7]
 [ 277 1594   11    6   16    5    1]
 [  17   11  315    0    1    1    0]
 [  35    6    0 1493    2    0    0]
 [  81   49    2    8   65    5    0]
 [  40    3    0    2    0  155    2]
 [  19    3    3    3    1    2  139]]
Micro Precision/Recall/F-score:  (0.8977144998126639, 0.8977144998126639, 0.8977144998126639, None)
Macro Precision/Recall/F-score:  (0.8635443107865345, 0.7938770337314776, 0.821163220665295, None)


epoch 18/40
model.reset
self.reset_num:  18
self.cheat:  False
self.mask_p:  1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.4603471962033221
ex_Confusion Metric: 
 [[ 690  299   70 2261   11  268   35]
 [  55 1012  201  574    7   29   32]
 [   3   12  308   19    0    2    1]
 [  14   82    5 1391    4   32    8]
 [  14   50    9  116    9    6    6]
 [   7    3    3   24    0  141   24]
 [   1    1    5   19    0    9  135]]
used_ex_acc:  1.0
used_ex_Confusion Metric: 
 [[ 690    0    0    0    0    0    0]
 [   0 1012    0    0    0    0    0]
 [   0    0  308    0    0    0    0]
 [   0    0    0 1391    0    0    0]
 [   0    0    0    0    9    0    0]
 [   0    0    0    0    0  141    0]
 [   0    0    0    0    0    0  135]]
np.mean(reliability_np):  0.794292944030895
np.median(reliability_np):  0.8683488667011261
np.mean(c_reliability_np):  0.8409320273422962
np.median(c_reliability_np):  0.9278544783592224
np.mean(w_reliability_np):  0.770387105997225
np.median(w_reliability_np):  0.8361378908157349
self.threshold:  0.9278544783592224
Accuracy:  0.8955913575621332
Confusion Metric: 
 [[3361  193    4   19   33   16    8]
 [ 220 1646    5    6   24    7    2]
 [  14   12  315    1    1    2    0]
 [  35   12    0 1488    1    0    0]
 [  68   64    3   10   61    4    0]
 [  34    5    0    2    0  159    2]
 [  15    4    2    4    1    3  141]]
Micro Precision/Recall/F-score:  (0.8955913575621332, 0.8955913575621332, 0.8955913575621332, None)
Macro Precision/Recall/F-score:  (0.8479068979426978, 0.796495202933779, 0.817548602560457, None)


epoch 19/40
model.reset
self.reset_num:  19
self.cheat:  False
self.mask_p:  1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.4633445734981891
ex_Confusion Metric: 
 [[ 736  280   79 2236   10  254   39]
 [  70  980  244  546    7   26   37]
 [   3   12  311   16    0    2    1]
 [  15   78    5 1392    4   33    9]
 [  14   44   11  116   12    6    7]
 [   8    2    4   22    0  143   23]
 [   1    0    5   18    0   10  136]]
used_ex_acc:  1.0
used_ex_Confusion Metric: 
 [[ 736    0    0    0    0    0    0]
 [   0  980    0    0    0    0    0]
 [   0    0  311    0    0    0    0]
 [   0    0    0 1392    0    0    0]
 [   0    0    0    0   12    0    0]
 [   0    0    0    0    0  143    0]
 [   0    0    0    0    0    0  136]]
np.mean(reliability_np):  0.7918850072367783
np.median(reliability_np):  0.8642340898513794
np.mean(c_reliability_np):  0.8366526543812932
np.median(c_reliability_np):  0.9206464290618896
np.mean(w_reliability_np):  0.7567950328935543
np.median(w_reliability_np):  0.8153061270713806
self.threshold:  0.9206464290618896
Accuracy:  0.8895966029723992
Confusion Metric: 
 [[3270  248    9   20   42   38    7]
 [ 181 1677   11    5   20   16    0]
 [  12   17  313    0    0    3    0]
 [  29   18    0 1487    1    1    0]
 [  58   72    3    7   62    8    0]
 [  22    8    1    2    0  169    0]
 [  10    1    5    3    1    5  145]]
Micro Precision/Recall/F-score:  (0.8895966029723992, 0.8895966029723992, 0.8895966029723992, None)
Macro Precision/Recall/F-score:  (0.8250939805273804, 0.8054290905863397, 0.8103852141437377, None)


epoch 20/40
model.reset
self.reset_num:  20
self.cheat:  False
self.mask_p:  1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.46147121268889724
ex_Confusion Metric: 
 [[ 808  183   63 2266    9  250   55]
 [ 102  888  217  631    4   32   36]
 [   7   12  303   17    0    2    4]
 [  16   62    5 1405    4   35    9]
 [  19   35    7  128    8    6    7]
 [   8    2    3   23    0  141   25]
 [   1    0    5   15    0    7  142]]
used_ex_acc:  1.0
used_ex_Confusion Metric: 
 [[ 808    0    0    0    0    0    0]
 [   0  888    0    0    0    0    0]
 [   0    0  303    0    0    0    0]
 [   0    0    0 1405    0    0    0]
 [   0    0    0    0    8    0    0]
 [   0    0    0    0    0  141    0]
 [   0    0    0    0    0    0  142]]
np.mean(reliability_np):  0.791078606729518
np.median(reliability_np):  0.8603759407997131
np.mean(c_reliability_np):  0.8361570101952198
np.median(c_reliability_np):  0.9222483038902283
np.mean(w_reliability_np):  0.7569287535674
np.median(w_reliability_np):  0.8117056488990784
self.threshold:  0.9222483038902283
Accuracy:  0.8852254277507181
Confusion Metric: 
 [[3190  304   17   21   43   48   11]
 [ 153 1705   10    6   16   18    2]
 [  10   10  321    0    0    4    0]
 [  28   17    0 1487    1    1    2]
 [  61   67    2    7   64    9    0]
 [  22    6    0    2    0  172    0]
 [  10    2    3    2    0    4  149]]
Micro Precision/Recall/F-score:  (0.8852254277507181, 0.8852254277507181, 0.8852254277507181, None)
Macro Precision/Recall/F-score:  (0.8152707101352813, 0.8145345889859055, 0.809073919265109, None)


epoch 21/40
model.reset
self.reset_num:  21
self.cheat:  False
self.mask_p:  1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.4685899837642063
ex_Confusion Metric: 
 [[ 724  263   88 2192   12  271   84]
 [  51 1020  239  521    7   26   46]
 [   2   13  315   10    0    2    3]
 [  11   72    5 1396    4   37   11]
 [  12   47    8  116   13    4   10]
 [   4    4    3   18    0  137   36]
 [   1    0    4   12    0    6  147]]
used_ex_acc:  1.0
used_ex_Confusion Metric: 
 [[ 724    0    0    0    0    0    0]
 [   0 1020    0    0    0    0    0]
 [   0    0  315    0    0    0    0]
 [   0    0    0 1396    0    0    0]
 [   0    0    0    0   13    0    0]
 [   0    0    0    0    0  137    0]
 [   0    0    0    0    0    0  147]]
np.mean(reliability_np):  0.7839559402965888
np.median(reliability_np):  0.852400928735733
np.mean(c_reliability_np):  0.8241530993997034
np.median(c_reliability_np):  0.907829999923706
np.mean(w_reliability_np):  0.7391570657386622
np.median(w_reliability_np):  0.7888572812080383
self.threshold:  0.907829999923706
Accuracy:  0.8882228050455852
Confusion Metric: 
 [[3268  292    6   22   42    0    4]
 [ 198 1685    4    6   15    1    1]
 [  14   19  311    0    1    0    0]
 [  38   17    0 1479    1    1    0]
 [  67   75    3    6   59    0    0]
 [  28    6    0    2    0  165    1]
 [  16    2    3    4    0    0  145]]
Micro Precision/Recall/F-score:  (0.8882228050455852, 0.8882228050455852, 0.8882228050455853, None)
Macro Precision/Recall/F-score:  (0.8682088356012375, 0.7995069469687002, 0.8274968009151469, None)


epoch 22/40
model.reset
self.reset_num:  22
self.cheat:  False
self.mask_p:  1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.4386162108155364
ex_Confusion Metric: 
 [[ 631  177   64 2270   12  435   45]
 [  77  875  199  668    5   47   39]
 [   5   12  307   15    0    3    3]
 [   9   59    2 1394    4   56   12]
 [  12   37    7  131    7   10    6]
 [   1    3    3   14    0  157   24]
 [   1    0    3   12    0   13  141]]
used_ex_acc:  1.0
used_ex_Confusion Metric: 
 [[ 631    0    0    0    0    0    0]
 [   0  875    0    0    0    0    0]
 [   0    0  307    0    0    0    0]
 [   0    0    0 1394    0    0    0]
 [   0    0    0    0    7    0    0]
 [   0    0    0    0    0  157    0]
 [   0    0    0    0    0    0  141]]
np.mean(reliability_np):  0.786763312424124
np.median(reliability_np):  0.8550330400466919
np.mean(c_reliability_np):  0.8290323835069946
np.median(c_reliability_np):  0.9153201282024384
np.mean(w_reliability_np):  0.7562456086891246
np.median(w_reliability_np):  0.8127514123916626
self.threshold:  0.9153201282024384
Accuracy:  0.8887223679280629
Confusion Metric: 
 [[3254  227   11   52   61   22    7]
 [ 189 1667   10    7   25   10    2]
 [  12    7  322    1    1    2    0]
 [  37    9    0 1488    2    0    0]
 [  61   54    3   12   74    5    1]
 [  27    4    0    1    0  168    2]
 [  15    2    3    3    0    4  143]]
Micro Precision/Recall/F-score:  (0.8887223679280629, 0.8887223679280629, 0.8887223679280629, None)
Macro Precision/Recall/F-score:  (0.8283083697655583, 0.8136472606499047, 0.8196910335899016, None)


epoch 23/40
model.reset
self.reset_num:  23
self.cheat:  False
self.mask_p:  1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.4388659922567753
ex_Confusion Metric: 
 [[ 432  345  101 2105    9  582   60]
 [  24 1096  248  436    7   49   50]
 [   0   12  318    8    0    5    2]
 [   9   88    5 1360    4   57   13]
 [   3   54    9  103   17   14   10]
 [   0    3    3   16    0  151   29]
 [   1    2    4   14    0    9  140]]
used_ex_acc:  1.0
used_ex_Confusion Metric: 
 [[ 432    0    0    0    0    0    0]
 [   0 1096    0    0    0    0    0]
 [   0    0  318    0    0    0    0]
 [   0    0    0 1360    0    0    0]
 [   0    0    0    0   17    0    0]
 [   0    0    0    0    0  151    0]
 [   0    0    0    0    0    0  140]]
np.mean(reliability_np):  0.7856661550184485
np.median(reliability_np):  0.8549685478210449
np.mean(c_reliability_np):  0.8260419875697175
np.median(c_reliability_np):  0.9169580638408661
np.mean(w_reliability_np):  0.7429821105860879
np.median(w_reliability_np):  0.7982954382896423
self.threshold:  0.9169580638408661
Accuracy:  0.8882228050455852
Confusion Metric: 
 [[3239  309    5   33   22   18    8]
 [ 174 1703    4   11   11    6    1]
 [  15   11  317    1    1    0    0]
 [  27   15    0 1491    2    1    0]
 [  66   71    2   10   56    5    0]
 [  32    5    0    1    0  163    1]
 [  16    2    3    2    0    4  143]]
Micro Precision/Recall/F-score:  (0.8882228050455852, 0.8882228050455852, 0.8882228050455853, None)
Macro Precision/Recall/F-score:  (0.8576236141765518, 0.7981778456442364, 0.817597628859911, None)


epoch 24/40
model.reset
self.reset_num:  24
self.cheat:  False
self.mask_p:  1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.4559760209816411
ex_Confusion Metric: 
 [[ 697  229   72 2261    9  323   43]
 [  66  955  210  603    4   32   40]
 [   1   12  315   12    0    2    3]
 [  13   75    4 1397    4   33   10]
 [  15   42    9  122    7    7    8]
 [   3    3    3   23    0  141   29]
 [   1    1    4   17    0    8  139]]
used_ex_acc:  1.0
used_ex_Confusion Metric: 
 [[ 697    0    0    0    0    0    0]
 [   0  955    0    0    0    0    0]
 [   0    0  315    0    0    0    0]
 [   0    0    0 1397    0    0    0]
 [   0    0    0    0    7    0    0]
 [   0    0    0    0    0  141    0]
 [   0    0    0    0    0    0  139]]
np.mean(reliability_np):  0.7812729514001326
np.median(reliability_np):  0.849249929189682
np.mean(c_reliability_np):  0.8295605051961542
np.median(c_reliability_np):  0.9112823009490967
np.mean(w_reliability_np):  0.7489808754528521
np.median(w_reliability_np):  0.801155298948288
self.threshold:  0.9112823009490967
Accuracy:  0.8851005370300986
Confusion Metric: 
 [[3299  151   10   32   88   36   18]
 [ 253 1587    7   15   38    8    2]
 [  14   10  317    1    1    2    0]
 [  35    6    1 1488    4    0    2]
 [  67   39    0   13   89    1    1]
 [  28    7    0    1    2  162    2]
 [  14    1    2    2    0    6  145]]
Micro Precision/Recall/F-score:  (0.8851005370300986, 0.8851005370300986, 0.8851005370300986, None)
Macro Precision/Recall/F-score:  (0.8110202296735168, 0.8150038014525645, 0.8127173595811297, None)


epoch 25/40
model.reset
self.reset_num:  25
self.cheat:  False
self.mask_p:  1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.4687148744848258
ex_Confusion Metric: 
 [[ 674  248   81 2211   19  356   45]
 [  54 1091  233  436   14   39   43]
 [   3   13  313    9    0    5    2]
 [  15   96    5 1374   12   29    5]
 [  11   47   13   98   22   10    9]
 [   1    4    3   26    0  140   28]
 [   1    2    4   16    0    8  139]]
used_ex_acc:  1.0
used_ex_Confusion Metric: 
 [[ 674    0    0    0    0    0    0]
 [   0 1091    0    0    0    0    0]
 [   0    0  313    0    0    0    0]
 [   0    0    0 1374    0    0    0]
 [   0    0    0    0   22    0    0]
 [   0    0    0    0    0  140    0]
 [   0    0    0    0    0    0  139]]
np.mean(reliability_np):  0.7512530501730967
np.median(reliability_np):  0.8106207847595215
np.mean(c_reliability_np):  0.7887052682568606
np.median(c_reliability_np):  0.8718726634979248
np.mean(w_reliability_np):  0.7133581642224355
np.median(w_reliability_np):  0.757525235414505
self.threshold:  0.8718726634979248
Accuracy:  0.8993380791807168
Confusion Metric: 
 [[3380  163    1   24   48    8   10]
 [ 225 1638    4   18   22    2    1]
 [  16    8  316    1    2    1    1]
 [  34    6    0 1489    6    0    1]
 [  67   45    1   16   79    1    1]
 [  36    5    0    1    0  159    1]
 [  18    4    0    4    0    4  140]]
Micro Precision/Recall/F-score:  (0.8993380791807168, 0.8993380791807168, 0.8993380791807168, None)
Macro Precision/Recall/F-score:  (0.8609527801208863, 0.8085554089263532, 0.8323323546614058, None)


epoch 26/40
model.reset
self.reset_num:  26
self.cheat:  False
self.mask_p:  1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.4956912701386287
ex_Confusion Metric: 
 [[ 828  268   78 2098   12  312   38]
 [  81 1180  240  340   14   28   27]
 [   4   13  315    9    0    2    2]
 [  14  114    5 1347    9   39    8]
 [  17   55   10   93   20    8    7]
 [   4    3    5   23    0  144   23]
 [   6    2    4   14    0    9  135]]
used_ex_acc:  1.0
used_ex_Confusion Metric: 
 [[ 828    0    0    0    0    0    0]
 [   0 1180    0    0    0    0    0]
 [   0    0  315    0    0    0    0]
 [   0    0    0 1347    0    0    0]
 [   0    0    0    0   20    0    0]
 [   0    0    0    0    0  144    0]
 [   0    0    0    0    0    0  135]]
np.mean(reliability_np):  0.7486377919865456
np.median(reliability_np):  0.8039436042308807
np.mean(c_reliability_np):  0.7933033375272706
np.median(c_reliability_np):  0.8712227940559387
np.mean(w_reliability_np):  0.7085688735822925
np.median(w_reliability_np):  0.744786411523819
self.threshold:  0.8712227940559387
Accuracy:  0.9023354564755839
Confusion Metric: 
 [[3394  164    3   25   32    7    9]
 [ 209 1662    3   14   17    1    4]
 [  10    7  324    1    1    2    0]
 [  44   13    0 1475    3    1    0]
 [  84   42    3   15   64    2    0]
 [  31    6    1    2    1  160    1]
 [  14    6    0    2    1    1  146]]
Micro Precision/Recall/F-score:  (0.9023354564755839, 0.9023354564755839, 0.9023354564755839, None)
Macro Precision/Recall/F-score:  (0.8675215977569122, 0.8084565250528705, 0.8324989263837335, None)


epoch 27/40
model.reset
self.reset_num:  27
self.cheat:  False
self.mask_p:  1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.5018109154489822
ex_Confusion Metric: 
 [[ 994  263  123 1812   12  363   67]
 [  89 1107  310  311    9   30   54]
 [   2   11  322    6    0    2    2]
 [  32  128    6 1296    9   47   18]
 [  17   60   15   86   14    8   10]
 [   6    3    5   15    0  141   32]
 [   4    2    4   10    0    6  144]]
used_ex_acc:  1.0
used_ex_Confusion Metric: 
 [[ 994    0    0    0    0    0    0]
 [   0 1107    0    0    0    0    0]
 [   0    0  322    0    0    0    0]
 [   0    0    0 1296    0    0    0]
 [   0    0    0    0   14    0    0]
 [   0    0    0    0    0  141    0]
 [   0    0    0    0    0    0  144]]
np.mean(reliability_np):  0.7554233285957809
np.median(reliability_np):  0.8136363327503204
np.mean(c_reliability_np):  0.7901655876514863
np.median(c_reliability_np):  0.8680073618888855
np.mean(w_reliability_np):  0.6912777495282609
np.median(w_reliability_np):  0.7249053120613098
self.threshold:  0.8680073618888855
Accuracy:  0.900462095666292
Confusion Metric: 
 [[3390  161    9   17   36   11   10]
 [ 214 1652   11   14   13    4    2]
 [   9   10  322    1    1    2    0]
 [  40   11    0 1479    5    1    0]
 [  81   41    4   16   64    3    1]
 [  31    6    0    2    0  162    1]
 [  14    1    5    6    0    3  141]]
Micro Precision/Recall/F-score:  (0.900462095666292, 0.900462095666292, 0.9004620956662921, None)
Macro Precision/Recall/F-score:  (0.8534584886543382, 0.8043079497744741, 0.8237443737024462, None)


epoch 28/40
model.reset
self.reset_num:  28
self.cheat:  False
self.mask_p:  1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.4950668165355314
ex_Confusion Metric: 
 [[ 873  282   95 2003   10  329   42]
 [  59 1147  252  373    8   34   37]
 [   2   15  315    9    0    2    2]
 [  25  118    5 1327    7   45    9]
 [  13   63   10   93   17    7    7]
 [   6    4    4   19    0  146   23]
 [   5    2    4   11    0    9  139]]
used_ex_acc:  1.0
used_ex_Confusion Metric: 
 [[ 873    0    0    0    0    0    0]
 [   0 1147    0    0    0    0    0]
 [   0    0  315    0    0    0    0]
 [   0    0    0 1327    0    0    0]
 [   0    0    0    0   17    0    0]
 [   0    0    0    0    0  146    0]
 [   0    0    0    0    0    0  139]]
np.mean(reliability_np):  0.753290880651541
np.median(reliability_np):  0.8099576532840729
np.mean(c_reliability_np):  0.7939917183773428
np.median(c_reliability_np):  0.8721103072166443
np.mean(w_reliability_np):  0.701064665284217
np.median(w_reliability_np):  0.7360784411430359
self.threshold:  0.8721103072166443
Accuracy:  0.8933433245909829
Confusion Metric: 
 [[3314  221    8   17   39   12   23]
 [ 197 1663   10    9   23    2    6]
 [  13    8  320    1    1    2    0]
 [  33   16    0 1482    4    0    1]
 [  67   60    4    9   66    2    2]
 [  27    8    0    2    0  162    3]
 [  11    2    3    6    0    2  146]]
Micro Precision/Recall/F-score:  (0.8933433245909829, 0.8933433245909829, 0.8933433245909829, None)
Macro Precision/Recall/F-score:  (0.8339144568982769, 0.8071561163813439, 0.8171321637070014, None)


epoch 29/40
model.reset
self.reset_num:  29
self.cheat:  False
self.mask_p:  1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.4673410765580117
ex_Confusion Metric: 
 [[ 761  197   64 2188    9  377   38]
 [  85  993  219  536    7   40   30]
 [   2   13  311   13    0    4    2]
 [  16   83    3 1373    6   46    9]
 [  15   44    8  110   16   11    6]
 [   4    4    3   22    0  152   17]
 [   1    2    4   15    0   12  136]]
used_ex_acc:  1.0
used_ex_Confusion Metric: 
 [[ 761    0    0    0    0    0    0]
 [   0  993    0    0    0    0    0]
 [   0    0  311    0    0    0    0]
 [   0    0    0 1373    0    0    0]
 [   0    0    0    0   16    0    0]
 [   0    0    0    0    0  152    0]
 [   0    0    0    0    0    0  136]]
np.mean(reliability_np):  0.7639264117349853
np.median(reliability_np):  0.8239384591579437
np.mean(c_reliability_np):  0.8137761300727366
np.median(c_reliability_np):  0.8935971558094025
np.mean(w_reliability_np):  0.7306967336121086
np.median(w_reliability_np):  0.7745654582977295
self.threshold:  0.8935971558094025
Accuracy:  0.8965904833270888
Confusion Metric: 
 [[3302  230    8   24   46   10   14]
 [ 166 1694    7   12   24    2    5]
 [  13    9  319    1    1    2    0]
 [  33   13    0 1487    3    0    0]
 [  61   61    2   12   71    2    1]
 [  28    7    0    2    1  162    2]
 [  12    2    3    6    0    3  144]]
Micro Precision/Recall/F-score:  (0.8965904833270888, 0.8965904833270888, 0.8965904833270888, None)
Macro Precision/Recall/F-score:  (0.8437969748229097, 0.8107746443288947, 0.8248988967891611, None)


epoch 30/40
model.reset
self.reset_num:  30
self.cheat:  False
self.mask_p:  1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.4788310228550019
ex_Confusion Metric: 
 [[ 786  229   79 2117   11  373   39]
 [  75 1077  247  429   12   36   34]
 [   4   13  315    9    0    2    2]
 [  19   99    4 1353    6   46    9]
 [  15   49    9  102   18   10    7]
 [   4    4    3   22    0  148   21]
 [   3    2    4   14    0   10  137]]
used_ex_acc:  1.0
used_ex_Confusion Metric: 
 [[ 786    0    0    0    0    0    0]
 [   0 1077    0    0    0    0    0]
 [   0    0  315    0    0    0    0]
 [   0    0    0 1353    0    0    0]
 [   0    0    0    0   18    0    0]
 [   0    0    0    0    0  148    0]
 [   0    0    0    0    0    0  137]]
np.mean(reliability_np):  0.7676826623867951
np.median(reliability_np):  0.8290553390979767
np.mean(c_reliability_np):  0.8099207229364273
np.median(c_reliability_np):  0.8912323117256165
np.mean(w_reliability_np):  0.7267598133849321
np.median(w_reliability_np):  0.7701519727706909
self.threshold:  0.8912323117256165
Accuracy:  0.8950917946796553
Confusion Metric: 
 [[3326  216    7   15   50    8   12]
 [ 197 1667    6    8   26    1    5]
 [  14   11  317    1    1    1    0]
 [  33   17    0 1481    5    0    0]
 [  67   57    2    8   73    2    1]
 [  29    7    0    2    0  161    3]
 [  14    2    3    6    0    3  142]]
Micro Precision/Recall/F-score:  (0.8950917946796553, 0.8950917946796553, 0.8950917946796553, None)
Macro Precision/Recall/F-score:  (0.8462681989796319, 0.8072851335115434, 0.824742996733062, None)


epoch 31/40
model.reset
self.reset_num:  31
self.cheat:  False
self.mask_p:  1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.4673410765580117
ex_Confusion Metric: 
 [[ 740  213   79 2204   11  349   38]
 [  70 1020  241  501    7   37   34]
 [   4   13  312   12    0    2    2]
 [  16   86    4 1371    6   44    9]
 [  15   46   10  109   15    8    7]
 [   4    4    3   22    0  147   22]
 [   2    2    4   15    0   10  137]]
used_ex_acc:  1.0
used_ex_Confusion Metric: 
 [[ 740    0    0    0    0    0    0]
 [   0 1020    0    0    0    0    0]
 [   0    0  312    0    0    0    0]
 [   0    0    0 1371    0    0    0]
 [   0    0    0    0   15    0    0]
 [   0    0    0    0    0  147    0]
 [   0    0    0    0    0    0  137]]
np.mean(reliability_np):  0.7675244150390494
np.median(reliability_np):  0.8289643824100494
np.mean(c_reliability_np):  0.8138301617867612
np.median(c_reliability_np):  0.8962779343128204
np.mean(w_reliability_np):  0.7300398568929569
np.median(w_reliability_np):  0.7762364745140076
self.threshold:  0.8962779343128204
Accuracy:  0.8912201823404521
Confusion Metric: 
 [[3232  256    7   27   80   14   18]
 [ 150 1704    5   15   28    1    7]
 [  12    6  321    1    3    2    0]
 [  34   11    0 1486    4    1    0]
 [  59   54    2   10   81    3    1]
 [  25    5    0    2    1  164    5]
 [  10    2    3    5    0    2  148]]
Micro Precision/Recall/F-score:  (0.8912201823404521, 0.8912201823404521, 0.8912201823404521, None)
Macro Precision/Recall/F-score:  (0.8256652957486842, 0.8210844430033516, 0.8228798597967776, None)


epoch 32/40
model.reset
self.reset_num:  32
self.cheat:  False
self.mask_p:  1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.47708255276632944
ex_Confusion Metric: 
 [[ 752  278  103 2057   15  391   38]
 [  55 1088  257  435   13   32   30]
 [   0   13  318    8    0    4    2]
 [  16   92    5 1359    6   43   15]
 [  10   56   10   99   17   10    8]
 [   3    3    5   18    0  147   26]
 [   2    3    5   12    0    9  139]]
used_ex_acc:  1.0
used_ex_Confusion Metric: 
 [[ 752    0    0    0    0    0    0]
 [   0 1088    0    0    0    0    0]
 [   0    0  318    0    0    0    0]
 [   0    0    0 1359    0    0    0]
 [   0    0    0    0   17    0    0]
 [   0    0    0    0    0  147    0]
 [   0    0    0    0    0    0  139]]
np.mean(reliability_np):  0.7700443523725624
np.median(reliability_np):  0.8312953412532806
np.mean(c_reliability_np):  0.8090036318174207
np.median(c_reliability_np):  0.8891846239566803
np.mean(w_reliability_np):  0.7266915803212438
np.median(w_reliability_np):  0.7729488015174866
self.threshold:  0.8891846239566803
Accuracy:  0.8949669039590359
Confusion Metric: 
 [[3333  163    4   76   41    7   10]
 [ 225 1635    6   18   21    1    4]
 [  12    9  322    1    0    1    0]
 [  30    8    0 1495    1    1    1]
 [  73   38    1   22   75    0    1]
 [  28    6    0    5    0  161    2]
 [  12    3    2    5    0    3  145]]
Micro Precision/Recall/F-score:  (0.8949669039590359, 0.8949669039590359, 0.8949669039590359, None)
Macro Precision/Recall/F-score:  (0.8595681086732877, 0.812420923606705, 0.8323388769768046, None)


epoch 33/40
model.reset
self.reset_num:  33
self.cheat:  False
self.mask_p:  1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.47708255276632944
ex_Confusion Metric: 
 [[ 757  302   92 2021   11  401   50]
 [  57 1094  255  425    5   34   40]
 [   0   13  317   10    0    3    2]
 [  18  112    4 1342    8   38   14]
 [   8   66    8   88   17   13   10]
 [   4    4    3   18    0  155   18]
 [   1    3    5   12    0   11  138]]
used_ex_acc:  1.0
used_ex_Confusion Metric: 
 [[ 757    0    0    0    0    0    0]
 [   0 1094    0    0    0    0    0]
 [   0    0  317    0    0    0    0]
 [   0    0    0 1342    0    0    0]
 [   0    0    0    0   17    0    0]
 [   0    0    0    0    0  155    0]
 [   0    0    0    0    0    0  138]]
np.mean(reliability_np):  0.7598715867553735
np.median(reliability_np):  0.819491982460022
np.mean(c_reliability_np):  0.7858219715898261
np.median(c_reliability_np):  0.8655902743339539
np.mean(w_reliability_np):  0.6997177934757645
np.median(w_reliability_np):  0.7334383130073547
self.threshold:  0.8655902743339539
Accuracy:  0.8965904833270888
Confusion Metric: 
 [[3407  159    1   18   23    5   21]
 [ 258 1624    4    7   12    0    5]
 [  16   10  318    0    1    0    0]
 [  49   10    0 1475    1    0    1]
 [  95   39    1    8   60    2    5]
 [  39    9    0    1    0  147    6]
 [  10    3    2    4    1    2  148]]
Micro Precision/Recall/F-score:  (0.8965904833270888, 0.8965904833270888, 0.8965904833270888, None)
Macro Precision/Recall/F-score:  (0.8651418057896337, 0.7934067227881061, 0.8183066511061207, None)


epoch 34/40
model.reset
self.reset_num:  34
self.cheat:  False
self.mask_p:  1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.4936930186087174
ex_Confusion Metric: 
 [[ 886  272  109 2097    8  218   44]
 [  64 1093  281  422    5   17   28]
 [   3   13  316    9    0    2    2]
 [  22  105    5 1369    5   20   10]
 [  12   63   12   95   12    8    8]
 [   8    4    4   26    0  141   19]
 [   3    3    7   12    0    9  136]]
used_ex_acc:  1.0
used_ex_Confusion Metric: 
 [[ 886    0    0    0    0    0    0]
 [   0 1093    0    0    0    0    0]
 [   0    0  316    0    0    0    0]
 [   0    0    0 1369    0    0    0]
 [   0    0    0    0   12    0    0]
 [   0    0    0    0    0  141    0]
 [   0    0    0    0    0    0  136]]
np.mean(reliability_np):  0.7554789467499388
np.median(reliability_np):  0.8121001124382019
np.mean(c_reliability_np):  0.8074346291635901
np.median(c_reliability_np):  0.8888399004936218
np.mean(w_reliability_np):  0.7207413662903169
np.median(w_reliability_np):  0.7625013589859009
self.threshold:  0.8888399004936218
Accuracy:  0.8885974772074435
Confusion Metric: 
 [[3218  298    4   25   68   13    8]
 [ 156 1718    2   10   20    1    3]
 [  11    9  318    1    3    3    0]
 [  31   16    0 1484    3    1    1]
 [  57   66    3    9   73    1    1]
 [  26    9    0    0    1  166    0]
 [  13    7    1    5    2    4  138]]
Micro Precision/Recall/F-score:  (0.8885974772074435, 0.8885974772074435, 0.8885974772074435, None)
Macro Precision/Recall/F-score:  (0.8405804047552785, 0.8077218467017824, 0.8225058509115898, None)


epoch 35/40
model.reset
self.reset_num:  35
self.cheat:  False
self.mask_p:  1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.4819532908704883
ex_Confusion Metric: 
 [[ 793  237   79 2092    8  400   25]
 [  69 1080  229  458    7   42   25]
 [   2   14  316    9    0    3    1]
 [  16   96    3 1368    4   41    8]
 [   9   54    9  106   12   12    8]
 [   4    4    4   18    0  157   15]
 [   2    1    6   14    0   14  133]]
used_ex_acc:  1.0
used_ex_Confusion Metric: 
 [[ 793    0    0    0    0    0    0]
 [   0 1080    0    0    0    0    0]
 [   0    0  316    0    0    0    0]
 [   0    0    0 1368    0    0    0]
 [   0    0    0    0   12    0    0]
 [   0    0    0    0    0  157    0]
 [   0    0    0    0    0    0  133]]
np.mean(reliability_np):  0.7504175364563842
np.median(reliability_np):  0.805004894733429
np.mean(c_reliability_np):  0.7978889541780124
np.median(c_reliability_np):  0.8784701228141785
np.mean(w_reliability_np):  0.7119918651088512
np.median(w_reliability_np):  0.7486348748207092
self.threshold:  0.8784701228141785
Accuracy:  0.9052079430498314
Confusion Metric: 
 [[3359  141    5   64   35    7   23]
 [ 149 1720    2   19    9    4    7]
 [   8    7  327    1    1    1    0]
 [  60    5    1 1460    8    1    1]
 [  81   23    3   29   70    2    2]
 [  28    6    0    1    0  163    4]
 [  10    4    2    3    0    2  149]]
Micro Precision/Recall/F-score:  (0.9052079430498314, 0.9052079430498314, 0.9052079430498314, None)
Macro Precision/Recall/F-score:  (0.8535413507924076, 0.8199901295592671, 0.831678389608266, None)


epoch 36/40
model.reset
self.reset_num:  36
self.cheat:  False
self.mask_p:  1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.5093043586861496
ex_Confusion Metric: 
 [[ 883  456  126 1687   13  407   62]
 [  55 1323  297  145    8   36   46]
 [   0   13  323    3    1    3    2]
 [  25  202    6 1234   14   43   12]
 [   9   84   16   61   21   10    9]
 [   3    4    6   16    0  152   21]
 [   2    3    6    7    0   10  142]]
used_ex_acc:  1.0
used_ex_Confusion Metric: 
 [[ 883    0    0    0    0    0    0]
 [   0 1323    0    0    0    0    0]
 [   0    0  323    0    0    0    0]
 [   0    0    0 1234    0    0    0]
 [   0    0    0    0   21    0    0]
 [   0    0    0    0    0  152    0]
 [   0    0    0    0    0    0  142]]
np.mean(reliability_np):  0.7345097629385382
np.median(reliability_np):  0.7817290425300598
np.mean(c_reliability_np):  0.7622544593001885
np.median(c_reliability_np):  0.8241707980632782
np.mean(w_reliability_np):  0.6469058011188917
np.median(w_reliability_np):  0.6505783796310425
self.threshold:  0.8241707980632782
Accuracy:  0.8955913575621332
Confusion Metric: 
 [[3284  203    7   68   44   17   11]
 [ 162 1688    6   24   20    6    4]
 [  11    8  322    1    1    2    0]
 [  32    5    0 1495    3    1    0]
 [  68   43    3   23   70    2    1]
 [  23    6    0    3    0  169    1]
 [  12    2    3    6    1    3  143]]
Micro Precision/Recall/F-score:  (0.8955913575621332, 0.8955913575621332, 0.8955913575621332, None)
Macro Precision/Recall/F-score:  (0.8410213087037456, 0.8150344460862405, 0.8253151414766725, None)


epoch 37/40
model.reset
self.reset_num:  37
self.cheat:  False
self.mask_p:  1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.48682402897464716
ex_Confusion Metric: 
 [[ 717  307   85 2048    7  429   41]
 [  57 1223  237  307    9   39   38]
 [   0   13  316    8    0    5    3]
 [  15  119    4 1334    6   46   12]
 [   7   64   11   90   16   14    8]
 [   3    3    4   19    0  155   18]
 [   3    3    4   10    0   13  137]]
used_ex_acc:  1.0
used_ex_Confusion Metric: 
 [[ 717    0    0    0    0    0    0]
 [   0 1223    0    0    0    0    0]
 [   0    0  316    0    0    0    0]
 [   0    0    0 1334    0    0    0]
 [   0    0    0    0   16    0    0]
 [   0    0    0    0    0  155    0]
 [   0    0    0    0    0    0  137]]
np.mean(reliability_np):  0.7351649244332138
np.median(reliability_np):  0.7808448374271393
np.mean(c_reliability_np):  0.7844981345505272
np.median(c_reliability_np):  0.8571252226829529
np.mean(w_reliability_np):  0.6894344961296529
np.median(w_reliability_np):  0.7167552709579468
self.threshold:  0.8571252226829529
Accuracy:  0.9003372049456725
Confusion Metric: 
 [[3309  161    5   89   49   11   10]
 [ 146 1716    3   20   14    5    6]
 [   8    4  327    1    3    2    0]
 [  49    7    0 1473    5    1    1]
 [  74   32    2   28   69    4    1]
 [  25    6    0    3    0  166    2]
 [  10    3    2    3    0    3  149]]
Micro Precision/Recall/F-score:  (0.9003372049456725, 0.9003372049456725, 0.9003372049456725, None)
Macro Precision/Recall/F-score:  (0.8454373282466809, 0.8203758349738993, 0.8303787482668596, None)


epoch 38/40
model.reset
self.reset_num:  38
self.cheat:  False
self.mask_p:  1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.49169476707880605
ex_Confusion Metric: 
 [[ 788  405  159 1708   10  482   82]
 [  36 1258  312  205    7   37   55]
 [   0   12  324    4    0    3    2]
 [  23  163    8 1252    8   60   22]
 [   6   74   18   71   15   13   13]
 [   3    3    5   12    0  155   24]
 [   2    3    5    5    0   10  145]]
used_ex_acc:  1.0
used_ex_Confusion Metric: 
 [[ 788    0    0    0    0    0    0]
 [   0 1258    0    0    0    0    0]
 [   0    0  324    0    0    0    0]
 [   0    0    0 1252    0    0    0]
 [   0    0    0    0   15    0    0]
 [   0    0    0    0    0  155    0]
 [   0    0    0    0    0    0  145]]
np.mean(reliability_np):  0.7346426095991772
np.median(reliability_np):  0.7812496423721313
np.mean(c_reliability_np):  0.7723455639669125
np.median(c_reliability_np):  0.8393660187721252
np.mean(w_reliability_np):  0.6633443808196804
np.median(w_reliability_np):  0.6746189296245575
self.threshold:  0.8393660187721252
Accuracy:  0.8968402647683277
Confusion Metric: 
 [[3315  206    4   54   31   15    9]
 [ 176 1689    3   14   16    7    5]
 [  13    7  321    1    1    2    0]
 [  40   15    0 1478    2    1    0]
 [  76   44    2   19   65    3    1]
 [  25    6    0    2    0  168    1]
 [  13    4    2    3    0    3  145]]
Micro Precision/Recall/F-score:  (0.8968402647683277, 0.8968402647683277, 0.8968402647683277, None)
Macro Precision/Recall/F-score:  (0.8544124934818692, 0.8119048079475165, 0.8276213383135097, None)


epoch 39/40
model.reset
self.reset_num:  39
self.cheat:  False
self.mask_p:  1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.4875733732983639
ex_Confusion Metric: 
 [[ 771  284   93 1964    8  461   53]
 [  72 1183  244  315    5   37   54]
 [   0   13  317    8    0    4    3]
 [  24  119    4 1321    5   47   16]
 [   7   59   14   94   12   12   12]
 [   2    3    3   17    0  157   20]
 [   1    3    4    8    0   11  143]]
used_ex_acc:  1.0
used_ex_Confusion Metric: 
 [[ 771    0    0    0    0    0    0]
 [   0 1183    0    0    0    0    0]
 [   0    0  317    0    0    0    0]
 [   0    0    0 1321    0    0    0]
 [   0    0    0    0   12    0    0]
 [   0    0    0    0    0  157    0]
 [   0    0    0    0    0    0  143]]
np.mean(reliability_np):  0.7278006043351808
np.median(reliability_np):  0.77366703748703
np.mean(c_reliability_np):  0.780403937094799
np.median(c_reliability_np):  0.8560169041156769
np.mean(w_reliability_np):  0.6769933345810019
np.median(w_reliability_np):  0.7013590931892395
self.threshold:  0.8560169041156769
Accuracy:  0.8978393905332834
Confusion Metric: 
 [[3402  163    4   22   36    4    3]
 [ 239 1633    5   12   18    2    1]
 [  15    6  321    1    1    1    0]
 [  57    7    0 1467    4    1    0]
 [  95   41    2    9   62    1    0]
 [  31    5    0    2    0  164    0]
 [  17    4    2    4    1    2  140]]
Micro Precision/Recall/F-score:  (0.8978393905332834, 0.8978393905332834, 0.8978393905332834, None)
Macro Precision/Recall/F-score:  (0.8723386471090873, 0.8010419896781149, 0.8309606223736428, None)
best_epoch:  13 0.8401207880003649 0.900462095666292


test print 
Accuracy:  0.8785930408472012
Confusion Metric: 
 [[3286  147    8   38   53    4    4]
 [ 236 1462    1   13   18    2    1]
 [  17   14  289    2    1    0    0]
 [  77   10    0 1481    7    0    2]
 [ 162   49    1   15   87    1    1]
 [  37    3    0    3    1  162    1]
 [  18    1    0   13    1    1  202]]
Micro Precision/Recall/F-score:  (0.8785930408472012, 0.8785930408472012, 0.8785930408472012, None)
Macro Precision/Recall/F-score:  (0.866494064910958, 0.7885130684217599, 0.8201824289077418, None)
test f1:   0.8201824289077418 [0.8201824289077418]
test ass:  0.8785930408472012 [0.8785930408472012]
valid f1:  0.8401207880003649 [0.8401207880003649]
valid acc: 0.900462095666292 [0.900462095666292]
