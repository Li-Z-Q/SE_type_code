['/home/lizhuoqun/SE_type_code', '/home/lizhuoqun/anconda/envs/py38/lib/python38.zip', '/home/lizhuoqun/anconda/envs/py38/lib/python3.8', '/home/lizhuoqun/anconda/envs/py38/lib/python3.8/lib-dynload', '/home/lizhuoqun/anconda/envs/py38/lib/python3.8/site-packages', '/home/lizhuoqun/SE_type_code/data', '/home/lizhuoqun/SE_type_code/models', '/home/lizhuoqun/SE_type_code/tools', '/home/lizhuoqun/SE_type_code/resource', '/home/lizhuoqun/SE_type_code/pre_train']
sentence level BiLSTM extra
___________****************************************** 300 ********************************************************************************
paragraph level BiLSTM label embedding MLP pre
Namespace(BATCH_SIZE=128, DROPOUT=0.5, EPOCHs=40, LEARN_RATE=0.001, WEIGHT_DECAY=0.0001, cheat='True', fold_num=1, mask_p=-1.0)




time= 0
self.BiLSTM_1_require_grad:  True
self.cheat:  True
self.mask_p:  -1.0
self.threshold:  0.8
start to get stanford
already get stanford
start get bert_tokenizer
get bert tokenizer
if_do_embedding:  True
start read data catalogue
start get train data
already deal 10 file
already deal 20 file
already deal 30 file
already deal 40 file
already deal 50 file
already deal 60 file
already deal 70 file
already deal 80 file
already deal 90 file
already deal 100 file
already deal 110 file
already deal 120 file
already deal 130 file
already deal 140 file
already deal 150 file
already deal 160 file
already deal 170 file
already deal 180 file
already deal 190 file
already deal 200 file
already deal 210 file
already deal 220 file
already deal 230 file
already deal 240 file
already deal 250 file
already deal 260 file
already deal 270 file
already deal 280 file
len(train_valid_data_list):  3368
already deal 10 file
already deal 20 file
already deal 30 file
already deal 40 file
already deal 50 file
already deal 60 file
already deal 70 file
already deal 80 file
complete get data, len(test_data_list):  919


start sentence level BiLSTM  extra


epoch 0/4


epoch 1/4


epoch 2/4


epoch 3/4
sentence level BiLSTM  extra best_epoch:  3 -1 -1
sentence level BiLSTM  extra end

********************************************


epoch 0/40
model.reset
self.reset_num:  0
self.cheat:  True
self.mask_p:  -1.0
self.valid_flag:  False
self.BiLSTM_1_require_grad:  True
Accuracy:  0.8464145747272535
Confusion Metric: 
 [[3921   87    6  218    2   20   15]
 [ 327 1836   14   54    0    3    4]
 [  21   10  333    2    0    0    0]
 [ 205   19    2 1406    0    3    2]
 [ 268   18    0   43   30    1    1]
 [  33    6    0    8    0  188    7]
 [  41    3    0    3    0    4  277]]
Micro Precision/Recall/F-score:  (0.8464145747272535, 0.8464145747272535, 0.8464145747272535, None)
Macro Precision/Recall/F-score:  (0.8845641160950669, 0.7445794118966184, 0.7619914541888514, None)


epoch 1/40
model.reset
self.reset_num:  1
self.cheat:  True
self.mask_p:  -1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.7206863679694948
ex_Confusion Metric: 
 [[2851  398   60  564   98  234   64]
 [ 126 1777   94  121   61   34   25]
 [   5   19  341    0    0    0    1]
 [ 219  105    9 1197   61   29   17]
 [  33   60    8   65  171   14   10]
 [  18    6    5    8    3  187   15]
 [  14    8    1    8    2   15  280]]
np.mean(reliability_np):  0.7281988871015194
np.median(reliability_np):  0.7543411254882812
np.mean(c_reliability_np):  0.7600619075562518
np.median(c_reliability_np):  0.798138827085495
np.mean(w_reliability_np):  0.5718837922886099
np.median(w_reliability_np):  0.5509529709815979
self.threshold:  0.798138827085495
Accuracy:  0.8402711577163436
Confusion Metric: 
 [[3981   73   14  143    0   42   16]
 [ 493 1646   24   64    2    5    4]
 [  24    5  335    2    0    0    0]
 [ 196   26    0 1407    3    2    3]
 [ 209   20    0   35   88    4    5]
 [  36    6    1    4    0  188    7]
 [  31    4    0    3    0    2  288]]
Micro Precision/Recall/F-score:  (0.8402711577163436, 0.8402711577163436, 0.8402711577163436, None)
Macro Precision/Recall/F-score:  (0.8687999752025021, 0.7630700324449489, 0.7840338394032409, None)


epoch 2/40
model.reset
self.reset_num:  2
self.cheat:  True
self.mask_p:  -1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.6914521766761995
ex_Confusion Metric: 
 [[2739  238   68  774   93  286   71]
 [ 165 1539  114  273   67   44   36]
 [   6   17  338    1    3    0    1]
 [ 186   52   11 1300   39   34   15]
 [  47   35    8  107  143   12    9]
 [  14    6    3   12    5  186   16]
 [  13    4    2   11    2   13  283]]
np.mean(reliability_np):  0.7097070875256604
np.median(reliability_np):  0.725532054901123
np.mean(c_reliability_np):  0.7476431211940578
np.median(c_reliability_np):  0.7793407738208771
np.mean(w_reliability_np):  0.5763309468242502
np.median(w_reliability_np):  0.5595424771308899
self.threshold:  0.7793407738208771
Accuracy:  0.8650566677258765
Confusion Metric: 
 [[4016  108   11   94    8   27    5]
 [ 370 1792   18   40    9    4    5]
 [  24   10  331    0    0    0    1]
 [ 195   13    0 1415    9    3    2]
 [ 163   30    1   20  143    3    1]
 [  41    7    0    2    0  188    4]
 [  38    4    0    2    0    2  282]]
Micro Precision/Recall/F-score:  (0.8650566677258765, 0.8650566677258765, 0.8650566677258765, None)
Macro Precision/Recall/F-score:  (0.8816825065687307, 0.7918493716322468, 0.8236634791460252, None)


epoch 3/40
model.reset
self.reset_num:  3
self.cheat:  True
self.mask_p:  -1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.6874271793242241
ex_Confusion Metric: 
 [[2552  321   57 1004   73  201   61]
 [ 132 1656  111  236   46   30   27]
 [   4   22  334    2    2    0    2]
 [ 139   72   12 1356   34   16    8]
 [  41   56    7  114  131    7    5]
 [  14    6    4   17    3  181   17]
 [  14    6    1   15    3    9  280]]
np.mean(reliability_np):  0.7206208641230007
np.median(reliability_np):  0.7436170876026154
np.mean(c_reliability_np):  0.7711382875732722
np.median(c_reliability_np):  0.8147330284118652
np.mean(w_reliability_np):  0.6113496739070159
np.median(w_reliability_np):  0.5991670489311218
self.threshold:  0.8147330284118652
Accuracy:  0.8758606079864422
Confusion Metric: 
 [[3971  100    4   85   35   46   28]
 [ 225 1957   15   22    7    6    6]
 [  28    8  326    0    2    1    1]
 [ 206   26    0 1379   15    6    5]
 [ 154   25    2   21  153    5    1]
 [  27    4    2    4    1  195    9]
 [  28    3    0    3    0    6  288]]
Micro Precision/Recall/F-score:  (0.8758606079864422, 0.8758606079864422, 0.875860607986442, None)
Macro Precision/Recall/F-score:  (0.8469959693688833, 0.8064853594972524, 0.8204887434489737, None)


epoch 4/40
model.reset
self.reset_num:  4
self.cheat:  True
self.mask_p:  -1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.7248172863044169
ex_Confusion Metric: 
 [[2937  475   42  504   59  166   86]
 [ 115 1875   73  112   16   17   30]
 [   6   26  331    1    0    0    2]
 [ 317  127    8 1123   23   24   15]
 [  49   80    6   97  114    7    8]
 [  17   10    4    9    2  181   19]
 [  16   11    1    9    2    7  282]]
np.mean(reliability_np):  0.7272298442027237
np.median(reliability_np):  0.7553252577781677
np.mean(c_reliability_np):  0.7765905214156495
np.median(c_reliability_np):  0.8253998756408691
np.mean(w_reliability_np):  0.6053933852264016
np.median(w_reliability_np):  0.5875879228115082
self.threshold:  0.8253998756408691
Accuracy:  0.8740599512763478
Confusion Metric: 
 [[3932  103    1  128   66   27   12]
 [ 214 1954   10   33   19    4    4]
 [  29   11  324    1    1    0    0]
 [ 222   21    0 1365   26    3    0]
 [ 111   17    0   26  206    1    0]
 [  31    7    1    4    2  194    3]
 [  39    2    0    4    5    1  277]]
Micro Precision/Recall/F-score:  (0.8740599512763478, 0.8740599512763478, 0.874059951276348, None)
Macro Precision/Recall/F-score:  (0.8620896879117784, 0.8185786117218105, 0.8391190716843172, None)


epoch 5/40
model.reset
self.reset_num:  5
self.cheat:  True
self.mask_p:  -1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.7070225611693677
ex_Confusion Metric: 
 [[2866  406   51  458  142  265   81]
 [ 117 1835   92   85   57   25   27]
 [   4   27  330    1    2    0    2]
 [ 321  142    9 1019   83   50   13]
 [  45   75    7   58  162    7    7]
 [  15    7    4    6    3  185   22]
 [  15   11    1   10    5    8  278]]
np.mean(reliability_np):  0.7198675643218597
np.median(reliability_np):  0.7462687790393829
np.mean(c_reliability_np):  0.7431771116154025
np.median(c_reliability_np):  0.7805389761924744
np.mean(w_reliability_np):  0.5582875354364999
np.median(w_reliability_np):  0.523110568523407
self.threshold:  0.7805389761924744
Accuracy:  0.8707764008049995
Confusion Metric: 
 [[3919  123    7   95   83   26   16]
 [ 236 1941    5   18   32    3    3]
 [  24   24  313    0    3    0    2]
 [ 186   28    1 1396   22    3    1]
 [ 128   29    1   14  187    1    1]
 [  39    3    0    2    2  186   10]
 [  36    5    0    5    2    1  279]]
Micro Precision/Recall/F-score:  (0.8707764008049995, 0.8707764008049995, 0.8707764008049995, None)
Macro Precision/Recall/F-score:  (0.8476717544268543, 0.8043552686552118, 0.82478231547641, None)


epoch 6/40
model.reset
self.reset_num:  6
self.cheat:  True
self.mask_p:  -1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.6596758817921831
ex_Confusion Metric: 
 [[2327  435   38  672   66  650   81]
 [  91 1815   51  161   22   71   27]
 [   2   46  310    4    0    2    2]
 [ 208  114    7 1202   25   67   14]
 [  43   82    3   94  113   20    6]
 [  10   11    3    8    1  188   21]
 [  11   11    1   12    2   18  273]]
np.mean(reliability_np):  0.7160878704045942
np.median(reliability_np):  0.7371123135089874
np.mean(c_reliability_np):  0.7686938938440118
np.median(c_reliability_np):  0.8145514130592346
np.mean(w_reliability_np):  0.6146930148445332
np.median(w_reliability_np):  0.5979369282722473
self.threshold:  0.8145514130592346
Accuracy:  0.8788263955089504
Confusion Metric: 
 [[3900  125    4  101  111   14   14]
 [ 173 1994    7   18   37    3    6]
 [  19   20  315    0   10    1    1]
 [ 164   21    0 1425   26    0    1]
 [ 115   27    1   12  204    2    0]
 [  38    3    0    3    6  186    6]
 [  38    4    1    2    6    4  273]]
Micro Precision/Recall/F-score:  (0.8788263955089504, 0.8788263955089504, 0.8788263955089504, None)
Macro Precision/Recall/F-score:  (0.8516816099280781, 0.8145280845680849, 0.8315540586070105, None)


epoch 7/40
model.reset
self.reset_num:  7
self.cheat:  True
self.mask_p:  -1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.6336193199872895
ex_Confusion Metric: 
 [[1891  551   39 1234   47  442   65]
 [  44 1885   52  185   11   38   23]
 [   2   43  314    4    0    1    2]
 [  98  114    6 1357   12   42    8]
 [  26   92    3  143   87    8    2]
 [   8   10    3   18    2  183   18]
 [   6   14    2   19    2   20  265]]
np.mean(reliability_np):  0.726873878636347
np.median(reliability_np):  0.755717009305954
np.mean(c_reliability_np):  0.777303473461595
np.median(c_reliability_np):  0.8366581499576569
np.mean(w_reliability_np):  0.6265553550702638
np.median(w_reliability_np):  0.6134353876113892
self.threshold:  0.8366581499576569
Accuracy:  0.8737421883275077
Confusion Metric: 
 [[3853  133    3  132   89   40   19]
 [ 221 1910    6   42   48    3    8]
 [  22   16  314    1   12    0    1]
 [ 101   20    1 1482   26    7    0]
 [  72   26    0   29  227    5    2]
 [  29    1    3    7    4  196    2]
 [  43    4    0    3    7    4  267]]
Micro Precision/Recall/F-score:  (0.8737421883275077, 0.8737421883275077, 0.8737421883275077, None)
Macro Precision/Recall/F-score:  (0.834014717537862, 0.8245689385907772, 0.8280049775303558, None)


epoch 8/40
model.reset
self.reset_num:  8
self.cheat:  True
self.mask_p:  -1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.6696324541891748
ex_Confusion Metric: 
 [[2571  315   30  866   52  354   81]
 [ 199 1676   56  200   29   49   29]
 [   8   39  310    7    0    0    2]
 [ 259   90    4 1202   26   47    9]
 [  47   63    4  115  111   15    6]
 [  12    6    2   17    3  188   14]
 [   9    8    1   23    2   21  264]]
np.mean(reliability_np):  0.7283289023664479
np.median(reliability_np):  0.762541264295578
np.mean(c_reliability_np):  0.7829416130128182
np.median(c_reliability_np):  0.8405197262763977
np.mean(w_reliability_np):  0.6224393923051772
np.median(w_reliability_np):  0.6064426898956299
self.threshold:  0.8405197262763977
Accuracy:  0.8733185043957208
Confusion Metric: 
 [[3974  156    5   75   26   23   10]
 [ 233 1956    6   31    9    2    1]
 [  33   21  308    1    3    0    0]
 [ 183   15    1 1424    9    5    0]
 [ 159   47    0   24  128    1    2]
 [  38    2    1    6    1  189    5]
 [  52    2    0    4    2    2  266]]
Micro Precision/Recall/F-score:  (0.8733185043957208, 0.8733185043957208, 0.8733185043957208, None)
Macro Precision/Recall/F-score:  (0.8737960634877942, 0.7804062535378754, 0.8165144928811446, None)


epoch 9/40
model.reset
self.reset_num:  9
self.cheat:  True
self.mask_p:  -1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.6864738904777037
ex_Confusion Metric: 
 [[2610  329   36  880   46  268  100]
 [ 175 1727   68  184   19   27   38]
 [   8   33  318    4    0    0    3]
 [ 202  101    6 1267   19   31   11]
 [  36   77    5  126  101   10    6]
 [  14    5    3   17    3  178   22]
 [   7    9    1   15    1   15  280]]
np.mean(reliability_np):  0.7208082604503335
np.median(reliability_np):  0.7503404021263123
np.mean(c_reliability_np):  0.7721605238548824
np.median(c_reliability_np):  0.8279706835746765
np.mean(w_reliability_np):  0.5960831319560875
np.median(w_reliability_np):  0.5740102231502533
self.threshold:  0.8279706835746765
Accuracy:  0.8731066624298274
Confusion Metric: 
 [[4043   98    2   66   17   26   17]
 [ 295 1885    9   27   12    5    5]
 [  27   19  315    0    3    1    1]
 [ 187   24    1 1411   11    1    2]
 [ 183   34    1   17  124    2    0]
 [  41    4    1    2    1  188    5]
 [  44    1    0    3    1    2  277]]
Micro Precision/Recall/F-score:  (0.8731066624298274, 0.8731066624298274, 0.8731066624298274, None)
Macro Precision/Recall/F-score:  (0.8721827851275903, 0.7823986292616848, 0.8157071705602138, None)


epoch 10/40
model.reset
self.reset_num:  10
self.cheat:  True
self.mask_p:  -1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.6742929774388307
ex_Confusion Metric: 
 [[2515  308   40  874   33  408   91]
 [ 170 1696   76  191   17   49   39]
 [   8   29  320    5    0    1    3]
 [ 202   82    4 1291   16   32   10]
 [  43   75    7  126   86   18    6]
 [  12    5    3   18    2  180   22]
 [   2    6    1   20    1   20  278]]
np.mean(reliability_np):  0.7187112297599235
np.median(reliability_np):  0.7484410405158997
np.mean(c_reliability_np):  0.7590588603567823
np.median(c_reliability_np):  0.8078272938728333
np.mean(w_reliability_np):  0.6008977476465024
np.median(w_reliability_np):  0.5839954614639282
self.threshold:  0.8078272938728333
Accuracy:  0.8778731066624298
Confusion Metric: 
 [[3917  173    3   90   53   23   10]
 [ 186 1999    7   21   21    4    0]
 [  21   18  321    0    5    0    1]
 [ 124   38    0 1456   16    0    3]
 [ 132   56    0   24  149    0    0]
 [  37    3    2    3    4  189    4]
 [  55    7    0    5    2    2  257]]
Micro Precision/Recall/F-score:  (0.8778731066624298, 0.8778731066624298, 0.8778731066624298, None)
Macro Precision/Recall/F-score:  (0.8599070167676807, 0.7935007264650891, 0.8226582137785091, None)


epoch 11/40
model.reset
self.reset_num:  11
self.cheat:  True
self.mask_p:  -1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.6397627369981993
ex_Confusion Metric: 
 [[2086  383   34 1309   23  387   47]
 [ 103 1750   66  255    4   37   23]
 [   2   33  322    5    0    2    2]
 [ 109   92    6 1382    8   31    9]
 [  32   79    7  168   61   11    3]
 [  12    8    3   21    1  174   23]
 [   8   10    1   26    1   17  265]]
np.mean(reliability_np):  0.7172122454039619
np.median(reliability_np):  0.7438443303108215
np.mean(c_reliability_np):  0.771494068775252
np.median(c_reliability_np):  0.8258112370967865
np.mean(w_reliability_np):  0.6308759163623696
np.median(w_reliability_np):  0.6191892623901367
self.threshold:  0.8258112370967865
Accuracy:  0.867916534265438
Confusion Metric: 
 [[3947  165    3   63   61   21    9]
 [ 249 1933    5   20   25    4    2]
 [  23   26  315    0    1    0    1]
 [ 181   34    0 1385   32    2    3]
 [ 133   47    2    8  170    1    0]
 [  41    4    3    3    3  184    4]
 [  56    7    1    1    2    1  260]]
Micro Precision/Recall/F-score:  (0.867916534265438, 0.867916534265438, 0.867916534265438, None)
Macro Precision/Recall/F-score:  (0.8560020769631704, 0.7884190486424395, 0.8192495659713005, None)


epoch 12/40
model.reset
self.reset_num:  12
self.cheat:  True
self.mask_p:  -1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.6819192882109946
ex_Confusion Metric: 
 [[2509  390   33  953   34  289   61]
 [ 143 1774   79  178   11   28   25]
 [   6   27  326    4    0    1    2]
 [ 179  105    7 1300   15   22    9]
 [  41   85    6  129   86   10    4]
 [  15    6    3   21    2  170   25]
 [  10   13    1   15    0   16  273]]
np.mean(reliability_np):  0.7142362202516894
np.median(reliability_np):  0.7408469617366791
np.mean(c_reliability_np):  0.766319153943244
np.median(c_reliability_np):  0.818043053150177
np.mean(w_reliability_np):  0.6022963840198088
np.median(w_reliability_np):  0.5845179557800293
self.threshold:  0.818043053150177
Accuracy:  0.8704586378561593
Confusion Metric: 
 [[3942  160    2   68   83    7    7]
 [ 226 1929    5   34   41    3    0]
 [  16   41  303    1    3    0    2]
 [ 162   13    1 1438   23    0    0]
 [ 120   34    0   20  186    0    1]
 [  57    8    1    6    3  163    4]
 [  53   10    0    1    5    2  257]]
Micro Precision/Recall/F-score:  (0.8704586378561593, 0.8704586378561593, 0.8704586378561593, None)
Macro Precision/Recall/F-score:  (0.8641397072615756, 0.7805660482071948, 0.8171894616589527, None)


epoch 13/40
model.reset
self.reset_num:  13
self.cheat:  True
self.mask_p:  -1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.6578752250820887
ex_Confusion Metric: 
 [[2274  391   48 1177   30  282   67]
 [ 124 1758   91  196   12   28   29]
 [   3   25  331    4    0    1    2]
 [ 157  106    6 1332   13   17    6]
 [  34   86    7  146   77    7    4]
 [  12    8    3   24    2  167   26]
 [   8   12    1   24    1   10  272]]
np.mean(reliability_np):  0.7126513431464458
np.median(reliability_np):  0.7375889718532562
np.mean(c_reliability_np):  0.75252506527237
np.median(c_reliability_np):  0.7962180972099304
np.mean(w_reliability_np):  0.5968182770691051
np.median(w_reliability_np):  0.5733217895030975
self.threshold:  0.7962180972099304
Accuracy:  0.8555237792606716
Confusion Metric: 
 [[3951  162    4   81   59    6    6]
 [ 299 1872    2   22   34    2    7]
 [  31   55  274    0    4    1    1]
 [ 198   19    1 1401   18    0    0]
 [ 135   55    1   17  152    1    0]
 [  61    4    0    3    2  168    4]
 [  61    6    0    1    0    1  259]]
Micro Precision/Recall/F-score:  (0.8555237792606716, 0.8555237792606716, 0.8555237792606716, None)
Macro Precision/Recall/F-score:  (0.8606673088709925, 0.7530485698763105, 0.7992806326019987, None)


epoch 14/40
model.reset
self.reset_num:  14
self.cheat:  True
self.mask_p:  -1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.603325918864527
ex_Confusion Metric: 
 [[1846  333   49 1419   20  535   67]
 [ 118 1602  109  313   11   54   31]
 [   3   24  330    6    0    1    2]
 [ 103   65    8 1397   13   41   10]
 [  24   78    6  159   68   22    4]
 [   8    6    3   20    3  188   14]
 [   6   11    2   20    0   24  265]]
np.mean(reliability_np):  0.7019611062634177
np.median(reliability_np):  0.7193707525730133
np.mean(c_reliability_np):  0.756553933780452
np.median(c_reliability_np):  0.8063304126262665
np.mean(w_reliability_np):  0.6178120742135437
np.median(w_reliability_np):  0.6018385887145996
self.threshold:  0.8063304126262665
Accuracy:  0.8572185149878191
Confusion Metric: 
 [[4026  133    0   60   40    3    7]
 [ 324 1876    2   14   21    1    0]
 [  24   61  279    0    0    0    2]
 [ 230   21    1 1367   18    0    0]
 [ 163   50    0    8  139    0    1]
 [  65    6    0    6    2  156    7]
 [  70    5    0    1    1    1  250]]
Micro Precision/Recall/F-score:  (0.8572185149878191, 0.8572185149878191, 0.8572185149878191, None)
Macro Precision/Recall/F-score:  (0.8793589904899604, 0.7386500623401852, 0.7956985912520168, None)


epoch 15/40
model.reset
self.reset_num:  15
self.cheat:  True
self.mask_p:  -1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.6160364368181337
ex_Confusion Metric: 
 [[1854  376   71 1509   27  367   65]
 [  96 1684  143  243   10   34   28]
 [   1   17  341    4    0    1    2]
 [  96   86    8 1408   10   19   10]
 [  20   81    9  167   69   10    5]
 [   9    8    3   21    2  181   18]
 [   5    9    2   21    0   12  279]]
np.mean(reliability_np):  0.6998659825265683
np.median(reliability_np):  0.7158620357513428
np.mean(c_reliability_np):  0.7460388250910309
np.median(c_reliability_np):  0.7919944822788239
np.mean(w_reliability_np):  0.6031813024241349
np.median(w_reliability_np):  0.5861988663673401
self.threshold:  0.7919944822788239
Accuracy:  0.8637856159305158
Confusion Metric: 
 [[3897  196    8  118   40    8    2]
 [ 253 1926   13   27   18    1    0]
 [  16   20  328    1    0    0    1]
 [ 121   19    1 1489    7    0    0]
 [ 138   63    2   35  122    1    0]
 [  56    5    2    6    2  168    3]
 [  88   10    2    2    0    1  225]]
Micro Precision/Recall/F-score:  (0.8637856159305158, 0.8637856159305158, 0.8637856159305158, None)
Macro Precision/Recall/F-score:  (0.8685596636529122, 0.7567651670483903, 0.7994206454053691, None)


epoch 16/40
model.reset
self.reset_num:  16
self.cheat:  True
self.mask_p:  -1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.6192140663065353
ex_Confusion Metric: 
 [[1879  410   70 1482   26  357   45]
 [  85 1701  138  256    7   34   17]
 [   3   16  341    4    0    1    1]
 [  95   84    9 1416    7   20    6]
 [  20   77    9  183   62    8    2]
 [   9   10    3   22    1  184   13]
 [   9   13    2   27    0   14  263]]
np.mean(reliability_np):  0.6972100969780911
np.median(reliability_np):  0.7140763401985168
np.mean(c_reliability_np):  0.7467560804781341
np.median(c_reliability_np):  0.7921798825263977
np.mean(w_reliability_np):  0.6081637750373264
np.median(w_reliability_np):  0.5941691398620605
self.threshold:  0.7921798825263977
Accuracy:  0.8528757546870035
Confusion Metric: 
 [[3981   77    2  134   43   23    9]
 [ 412 1702    4   70   39    7    4]
 [  29   29  301    1    5    0    1]
 [ 144    9    0 1467   14    3    0]
 [ 153   10    0   45  149    4    0]
 [  38    1    0    7    3  190    3]
 [  55    3    0    4    2    2  262]]
Micro Precision/Recall/F-score:  (0.8528757546870035, 0.8528757546870035, 0.8528757546870035, None)
Macro Precision/Recall/F-score:  (0.8484777053352027, 0.7726057208510101, 0.8047980170550776, None)


epoch 17/40
model.reset
self.reset_num:  17
self.cheat:  True
self.mask_p:  -1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.6545916746107404
ex_Confusion Metric: 
 [[2380  362   64  799   42  547   75]
 [ 155 1696  130  155   12   60   30]
 [   4   15  340    3    0    2    2]
 [ 210  119    8 1216   19   50   15]
 [  42   83    9  113   86   22    6]
 [  15    9    2   11    1  184   20]
 [   7    9    2   13    0   19  278]]
np.mean(reliability_np):  0.6823152693243203
np.median(reliability_np):  0.6932650208473206
np.mean(c_reliability_np):  0.7198141535171413
np.median(c_reliability_np):  0.7520259916782379
np.mean(w_reliability_np):  0.5618551686812822
np.median(w_reliability_np):  0.5371919274330139
self.threshold:  0.7520259916782379
Accuracy:  0.87172968965152
Confusion Metric: 
 [[3904  186    2   74   77   15   11]
 [ 175 1983    9   32   33    4    2]
 [  18   41  301    0    4    0    2]
 [ 180   25    0 1411   20    1    0]
 [  97   51    1   29  182    1    0]
 [  39    6    0    8    4  181    4]
 [  43    8    0    2    6    1  268]]
Micro Precision/Recall/F-score:  (0.87172968965152, 0.87172968965152, 0.8717296896515201, None)
Macro Precision/Recall/F-score:  (0.8557822015105117, 0.7934382847519773, 0.8220181443979759, None)


epoch 18/40
model.reset
self.reset_num:  18
self.cheat:  True
self.mask_p:  -1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.6444232602478551
ex_Confusion Metric: 
 [[2177  382   56 1091   36  463   64]
 [ 116 1730  119  194   13   40   26]
 [   4   17  337    5    0    1    2]
 [ 155  109    8 1308   16   31   10]
 [  35   84    7  140   77   14    4]
 [  11    7    3   20    2  179   20]
 [  10   12    1   18    0   11  276]]
np.mean(reliability_np):  0.6883937519233736
np.median(reliability_np):  0.7019303739070892
np.mean(c_reliability_np):  0.7425806196106453
np.median(c_reliability_np):  0.7848349213600159
np.mean(w_reliability_np):  0.5908722168754033
np.median(w_reliability_np):  0.572306752204895
self.threshold:  0.7848349213600159
Accuracy:  0.8531935176358436
Confusion Metric: 
 [[3718  289    1  120  118   15    8]
 [ 157 2012    1   25   43    0    0]
 [  19   55  283    0    8    0    1]
 [ 127   54    1 1415   40    0    0]
 [  90   54    0   22  193    0    2]
 [  36    7    0    5    7  181    6]
 [  53   11    0    1    8    2  253]]
Micro Precision/Recall/F-score:  (0.8531935176358436, 0.8531935176358436, 0.8531935176358436, None)
Macro Precision/Recall/F-score:  (0.841493041435338, 0.7802083488451722, 0.8058872472747243, None)


epoch 19/40
model.reset
self.reset_num:  19
self.cheat:  True
self.mask_p:  -1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.6015252621544328
ex_Confusion Metric: 
 [[1670  534   77 1479   39  428   42]
 [  58 1780  142  200    7   33   18]
 [   2   17  337    6    0    2    2]
 [  89  122    6 1379   13   21    7]
 [  16   89   11  160   73    9    3]
 [   6   10    3   22    2  184   15]
 [   8   17    2   24    2   19  256]]
np.mean(reliability_np):  0.6802578820220688
np.median(reliability_np):  0.6866214871406555
np.mean(c_reliability_np):  0.7307301174956196
np.median(c_reliability_np):  0.7714459896087646
np.mean(w_reliability_np):  0.5781795027398924
np.median(w_reliability_np):  0.5514829456806183
self.threshold:  0.7714459896087646
Accuracy:  0.8487448363520813
Confusion Metric: 
 [[3841  196    1  110  111    6    4]
 [ 196 1911    6   51   72    0    2]
 [  24   68  265    0    8    0    1]
 [ 197   23    0 1384   32    0    1]
 [ 109   34    0   24  194    0    0]
 [  45    6    0   11    5  167    8]
 [  55    6    0    4   11    1  251]]
Micro Precision/Recall/F-score:  (0.8487448363520813, 0.8487448363520813, 0.8487448363520813, None)
Macro Precision/Recall/F-score:  (0.8439070764132929, 0.759406443533482, 0.7939175227725902, None)


epoch 20/40
model.reset
self.reset_num:  20
self.cheat:  True
self.mask_p:  -1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.6069272322847156
ex_Confusion Metric: 
 [[1714  462   59 1424   35  514   61]
 [  66 1766  102  223   12   44   25]
 [   2   22  334    5    0    1    2]
 [  97  107    6 1386    8   26    7]
 [  17   88    6  157   74   15    4]
 [   7    8    3   19    2  184   19]
 [   6    8    2   22    1   17  272]]
np.mean(reliability_np):  0.6795905160527274
np.median(reliability_np):  0.684842586517334
np.mean(c_reliability_np):  0.7306195569392067
np.median(c_reliability_np):  0.7680677771568298
np.mean(w_reliability_np):  0.5885746387523385
np.median(w_reliability_np):  0.5696934461593628
self.threshold:  0.7680677771568298
Accuracy:  0.8551000953288846
Confusion Metric: 
 [[3695  225    1  137  152   42   17]
 [ 154 1974    4   30   71    3    2]
 [  17   45  295    1    7    0    1]
 [ 141   25    0 1423   45    2    1]
 [  75   45    0   14  222    1    4]
 [  31    4    0    7    5  193    2]
 [  36   11    0    1    5    4  271]]
Micro Precision/Recall/F-score:  (0.8551000953288846, 0.8551000953288846, 0.8551000953288845, None)
Macro Precision/Recall/F-score:  (0.8198159153046178, 0.8087946323743819, 0.8105520871467873, None)


epoch 21/40
model.reset
self.reset_num:  21
self.cheat:  True
self.mask_p:  -1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.6221798538290435
ex_Confusion Metric: 
 [[1891  452   68 1151   54  590   63]
 [  76 1776  123  168   18   53   24]
 [   3   19  337    4    0    1    2]
 [ 125  119    8 1318   18   39   10]
 [  20   86    8  131   92   20    4]
 [   7    8    3   19    2  188   15]
 [   5    9    1   16    0   25  272]]
np.mean(reliability_np):  0.6650748481674866
np.median(reliability_np):  0.6644258499145508
np.mean(c_reliability_np):  0.7156076915498732
np.median(c_reliability_np):  0.7463768422603607
np.mean(w_reliability_np):  0.5608469614268753
np.median(w_reliability_np):  0.5304864645004272
self.threshold:  0.7463768422603607
Accuracy:  0.8355047134837411
Confusion Metric: 
 [[3654  108    2  229  205   54   17]
 [ 245 1790    6   62  125    5    5]
 [  24   28  301    3    8    1    1]
 [ 128    7    0 1430   69    2    1]
 [  66   16    0   38  239    2    0]
 [  27    1    0    5    3  202    4]
 [  40    3    0    3    8    2  272]]
Micro Precision/Recall/F-score:  (0.8355047134837411, 0.8355047134837411, 0.8355047134837411, None)
Macro Precision/Recall/F-score:  (0.7994368569702012, 0.8111059818136283, 0.7968576598000003, None)


epoch 22/40
model.reset
self.reset_num:  22
self.cheat:  True
self.mask_p:  -1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.6146594640398263
ex_Confusion Metric: 
 [[1817  560   69  994   63  702   64]
 [  64 1847  109  128   15   51   24]
 [   2   22  335    4    0    1    2]
 [ 143  151    7 1237   30   56   13]
 [  20  100    9  104  101   22    5]
 [   7    9    3   14    2  191   16]
 [   5   10    1   13    1   23  275]]
np.mean(reliability_np):  0.6641131593822766
np.median(reliability_np):  0.6631672084331512
np.mean(c_reliability_np):  0.7166039750593686
np.median(c_reliability_np):  0.7501184344291687
np.mean(w_reliability_np):  0.5590519221430955
np.median(w_reliability_np):  0.5258832275867462
self.threshold:  0.7501184344291687
Accuracy:  0.8380468170744625
Confusion Metric: 
 [[3690  211    4  115  184   53   12]
 [ 192 1920    7   22   90    2    5]
 [  16   53  288    1    6    0    2]
 [ 194   39    0 1318   81    4    1]
 [  76   38    0   12  232    2    1]
 [  29    2    0    4    3  201    3]
 [  43   10    0    0    8    4  263]]
Micro Precision/Recall/F-score:  (0.8380468170744625, 0.8380468170744625, 0.8380468170744625, None)
Macro Precision/Recall/F-score:  (0.8042420223978287, 0.7984805054930135, 0.794292580798221, None)


epoch 23/40
model.reset
self.reset_num:  23
self.cheat:  True
self.mask_p:  -1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.6054443385234615
ex_Confusion Metric: 
 [[1738  468   69 1106   81  730   77]
 [  62 1770  113  184   27   53   29]
 [   2   23  332    4    2    1    2]
 [ 124  115    7 1295   26   58   12]
 [  17   86    7  118  109   21    3]
 [   6    8    3   16    2  194   13]
 [   4    9    1   15    1   20  278]]
np.mean(reliability_np):  0.6576091770899618
np.median(reliability_np):  0.6552943885326385
np.mean(c_reliability_np):  0.7002507673721158
np.median(c_reliability_np):  0.7267042100429535
np.mean(w_reliability_np):  0.5501561497921912
np.median(w_reliability_np):  0.5218117833137512
self.threshold:  0.7267042100429535
Accuracy:  0.856477068107192
Confusion Metric: 
 [[3805  204    5  123   88   32   12]
 [ 247 1873   17   34   58    5    4]
 [  15   25  320    1    4    0    1]
 [ 135   26    1 1454   19    0    2]
 [ 107   38    0   36  177    2    1]
 [  34    3    0    4    2  196    3]
 [  40    9    0    3    4   11  261]]
Micro Precision/Recall/F-score:  (0.856477068107192, 0.856477068107192, 0.856477068107192, None)
Macro Precision/Recall/F-score:  (0.8225982198916476, 0.7980997494145329, 0.809513053248146, None)


epoch 24/40
model.reset
self.reset_num:  24
self.cheat:  True
self.mask_p:  -1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.5878614553543057
ex_Confusion Metric: 
 [[1614  391   91 1386   38  693   56]
 [  69 1680  153  240   15   54   27]
 [   2   14  344    3    0    1    2]
 [  95   93    8 1376   13   44    8]
 [  17   83   11  157   75   15    3]
 [   6    7    3   19    2  194   11]
 [   3    7    1   19    1   30  267]]
np.mean(reliability_np):  0.6597817221013031
np.median(reliability_np):  0.6592308580875397
np.mean(c_reliability_np):  0.713304398970024
np.median(c_reliability_np):  0.7411679625511169
np.mean(w_reliability_np):  0.5740732007232248
np.median(w_reliability_np):  0.5492159724235535
self.threshold:  0.7411679625511169
Accuracy:  0.8523461497722699
Confusion Metric: 
 [[3652  283    8  162  124   23   17]
 [ 137 2011    5   33   45    2    5]
 [  10   43  306    0    5    0    2]
 [ 145   32    1 1429   29    1    0]
 [  76   63    0   31  190    1    0]
 [  28   11    2    7    1  189    4]
 [  34   15    0    2    5    2  270]]
Micro Precision/Recall/F-score:  (0.8523461497722699, 0.8523461497722699, 0.8523461497722697, None)
Macro Precision/Recall/F-score:  (0.8244417332890409, 0.7990745641726447, 0.810113064755117, None)


epoch 25/40
model.reset
self.reset_num:  25
self.cheat:  True
self.mask_p:  -1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.6023726300180066
ex_Confusion Metric: 
 [[1739  423   87 1352   49  548   71]
 [  67 1694  147  238   17   45   30]
 [   2   15  342    3    1    1    2]
 [ 106   98    9 1370   11   32   11]
 [  17   81   10  154   82   14    3]
 [   7    8    3   20    2  189   13]
 [   4    8    1   18    1   25  271]]
np.mean(reliability_np):  0.6537904118771829
np.median(reliability_np):  0.6482605040073395
np.mean(c_reliability_np):  0.7056148800837128
np.median(c_reliability_np):  0.7262259125709534
np.mean(w_reliability_np):  0.5636808177100006
np.median(w_reliability_np):  0.5349034070968628
self.threshold:  0.7262259125709534
Accuracy:  0.8421777354093846
Confusion Metric: 
 [[3700  198    4  116  226   18    7]
 [ 167 1900    2   36  127    2    4]
 [   7   64  281    1   12    0    1]
 [ 184   23    0 1401   29    0    0]
 [  66   24    0   34  237    0    0]
 [  40    9    0    4    5  182    2]
 [  49    9    0    5   10    5  250]]
Micro Precision/Recall/F-score:  (0.8421777354093846, 0.8421777354093846, 0.8421777354093846, None)
Macro Precision/Recall/F-score:  (0.8258333577240913, 0.7871500215600145, 0.7966503055240249, None)


epoch 26/40
model.reset
self.reset_num:  26
self.cheat:  True
self.mask_p:  -1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.5969706598877238
ex_Confusion Metric: 
 [[1656  431   81 1363   61  603   74]
 [  61 1708  148  220   21   55   25]
 [   2   14  345    2    0    1    2]
 [  94   96    8 1377   15   37   10]
 [  18   83    9  145   87   16    3]
 [   7    7    3   19    2  192   12]
 [   5    8    1   19    2   22  271]]
np.mean(reliability_np):  0.6501837583433605
np.median(reliability_np):  0.6423244178295135
np.mean(c_reliability_np):  0.7018123883370646
np.median(c_reliability_np):  0.7228304743766785
np.mean(w_reliability_np):  0.5591463389871312
np.median(w_reliability_np):  0.5291475653648376
self.threshold:  0.7228304743766785
Accuracy:  0.8471560216078805
Confusion Metric: 
 [[3632  277    3  189  143   15   10]
 [ 149 1971    4   32   78    2    2]
 [   8   59  288    0    9    0    2]
 [ 139   28    1 1453   15    1    0]
 [  67   44    0   39  211    0    0]
 [  37    6    0    5    8  183    3]
 [  44   13    0    2    6    3  260]]
Micro Precision/Recall/F-score:  (0.8471560216078805, 0.8471560216078805, 0.8471560216078805, None)
Macro Precision/Recall/F-score:  (0.8307668841945185, 0.7913335856366899, 0.8063516666959096, None)


epoch 27/40
model.reset
self.reset_num:  27
self.cheat:  True
self.mask_p:  -1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.6045969706598877
ex_Confusion Metric: 
 [[1673  488   75 1352   62  566   53]
 [  58 1774  131  193   19   42   21]
 [   2   15  342    4    0    1    2]
 [  96  104    9 1368   15   38    7]
 [  20   85    8  139   89   17    3]
 [   6    8    3   20    2  190   13]
 [   5    9    1   17    2   22  272]]
np.mean(reliability_np):  0.6451347613239766
np.median(reliability_np):  0.6363711357116699
np.mean(c_reliability_np):  0.6981766791133173
np.median(c_reliability_np):  0.723158448934555
np.mean(w_reliability_np):  0.5506312015458658
np.median(w_reliability_np):  0.5214102864265442
self.threshold:  0.723158448934555
Accuracy:  0.84620273276136
Confusion Metric: 
 [[3794  282    3   96   62   19   13]
 [ 224 1936    5   31   33    3    6]
 [  16   50  296    0    2    0    2]
 [ 206   38    0 1373   19    1    0]
 [  99   71    1   32  157    0    1]
 [  45    8    0    5    1  180    3]
 [  49   13    0    3    1    9  253]]
Micro Precision/Recall/F-score:  (0.84620273276136, 0.84620273276136, 0.84620273276136, None)
Macro Precision/Recall/F-score:  (0.8364687364432705, 0.7644727896692612, 0.796490663722377, None)


epoch 28/40
model.reset
self.reset_num:  28
self.cheat:  True
self.mask_p:  -1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.577481199025527
ex_Confusion Metric: 
 [[1492  395   80 1549   43  645   65]
 [  59 1675  147  266   15   51   25]
 [   1   14  341    7    0    1    2]
 [  81   90    8 1403   11   35    9]
 [  18   78    9  160   75   18    3]
 [   7    7    3   20    2  188   15]
 [   4    8    1   18    1   18  278]]
np.mean(reliability_np):  0.6481673736395114
np.median(reliability_np):  0.6393068432807922
np.mean(c_reliability_np):  0.7067533217053464
np.median(c_reliability_np):  0.7357260584831238
np.mean(w_reliability_np):  0.5639768997494455
np.median(w_reliability_np):  0.5366464853286743
self.threshold:  0.7357260584831238
Accuracy:  0.8456731278466264
Confusion Metric: 
 [[3874  151    3  148   65   20    8]
 [ 330 1787    9   47   56    6    3]
 [  18   34  309    3    1    0    1]
 [ 176   15    1 1426   17    2    0]
 [ 126   41    1   32  161    0    0]
 [  40    4    1    9    2  183    3]
 [  60    7    1    4    3    9  244]]
Micro Precision/Recall/F-score:  (0.8456731278466264, 0.8456731278466264, 0.8456731278466264, None)
Macro Precision/Recall/F-score:  (0.8315939735476203, 0.766772200606475, 0.795849504971971, None)


epoch 29/40
model.reset
self.reset_num:  29
self.cheat:  True
self.mask_p:  -1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.5917805317233344
ex_Confusion Metric: 
 [[1718  325   71 1299   34  757   65]
 [  95 1623  152  258   12   67   31]
 [   2   18  336    6    0    2    2]
 [ 111   79    9 1368    9   51   10]
 [  25   79    9  147   74   24    3]
 [   7    6    3   19    2  193   12]
 [   4    7    1   16    0   25  275]]
np.mean(reliability_np):  0.6493534505145929
np.median(reliability_np):  0.641398161649704
np.mean(c_reliability_np):  0.6992862741972138
np.median(c_reliability_np):  0.7198506593704224
np.mean(w_reliability_np):  0.5591028203185383
np.median(w_reliability_np):  0.5290861129760742
self.threshold:  0.7198506593704224
Accuracy:  0.8327507679271263
Confusion Metric: 
 [[3900  173    1  105   74    8    8]
 [ 386 1766    6   31   42    2    5]
 [  36   56  267    1    3    0    3]
 [ 237   33    0 1346   21    0    0]
 [ 119   54    0   26  161    0    1]
 [  54    7    0    4    2  171    4]
 [  60    9    0    4    2    2  251]]
Micro Precision/Recall/F-score:  (0.8327507679271263, 0.8327507679271263, 0.8327507679271262, None)
Macro Precision/Recall/F-score:  (0.8432042506627461, 0.7388918785416616, 0.7840225937875237, None)


epoch 30/40
model.reset
self.reset_num:  30
self.cheat:  True
self.mask_p:  -1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.5818239593263426
ex_Confusion Metric: 
 [[1551  396   66 1240   39  904   73]
 [  68 1716  120  216   11   76   31]
 [   2   16  338    5    0    3    2]
 [ 101   93    9 1339   12   70   13]
 [  18   81    8  141   79   30    4]
 [   8    7    2   16    2  195   12]
 [   5    8    2   14    0   24  275]]
np.mean(reliability_np):  0.6401040355344826
np.median(reliability_np):  0.6285714209079742
np.mean(c_reliability_np):  0.6902205438837856
np.median(c_reliability_np):  0.7105299830436707
np.mean(w_reliability_np):  0.5498864237811669
np.median(w_reliability_np):  0.5218875706195831
self.threshold:  0.7105299830436707
Accuracy:  0.835186950534901
Confusion Metric: 
 [[3922  148    2  102   69   20    6]
 [ 373 1779    2   35   42    3    4]
 [  34   67  255    1    8    0    1]
 [ 233   21    0 1361   21    1    0]
 [ 142   42    0   24  152    1    0]
 [  42    5    0    5    3  183    4]
 [  69   10    0    4    4    8  233]]
Micro Precision/Recall/F-score:  (0.835186950534901, 0.835186950534901, 0.8351869505349009, None)
Macro Precision/Recall/F-score:  (0.8344521966924761, 0.7327656482109213, 0.7761035449453398, None)


epoch 31/40
model.reset
self.reset_num:  31
self.cheat:  True
self.mask_p:  -1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.571761465946404
ex_Confusion Metric: 
 [[1498  347   60 1530   27  744   63]
 [  72 1646  115  297    8   70   30]
 [   1   20  335    6    0    2    2]
 [  89   77    8 1399   10   45    9]
 [  17   83    7  159   64   27    4]
 [   7    8    2   21    1  190   13]
 [   5    8    1   22    0   26  266]]
np.mean(reliability_np):  0.6422785603346386
np.median(reliability_np):  0.6303108930587769
np.mean(c_reliability_np):  0.70089950685801
np.median(c_reliability_np):  0.7265283465385437
np.mean(w_reliability_np):  0.5651239987915175
np.median(w_reliability_np):  0.5383999347686768
self.threshold:  0.7265283465385437
Accuracy:  0.8370935282279419
Confusion Metric: 
 [[3953  110    4  113   72    7   10]
 [ 394 1737    5   33   64    0    5]
 [  34   53  275    0    3    0    1]
 [ 247   15    0 1352   22    0    1]
 [ 127   34    0   35  165    0    0]
 [  60    6    1    8    2  159    6]
 [  47    7    0    5    6    1  262]]
Micro Precision/Recall/F-score:  (0.8370935282279419, 0.8370935282279419, 0.8370935282279419, None)
Macro Precision/Recall/F-score:  (0.8433134557202504, 0.7417505061125285, 0.7849271797984775, None)


epoch 32/40
model.reset
self.reset_num:  32
self.cheat:  True
self.mask_p:  -1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.6273699819934329
ex_Confusion Metric: 
 [[1983  419   82 1077   51  600   57]
 [  85 1745  141  165   21   55   26]
 [   2   16  342    2    0    2    2]
 [ 149  113    9 1300   21   37    8]
 [  26   90   12  116   95   20    2]
 [   9    9    2   18    1  191   12]
 [   6    8    2   17    1   27  267]]
np.mean(reliability_np):  0.6393436612165593
np.median(reliability_np):  0.6284605264663696
np.mean(c_reliability_np):  0.6836276089050229
np.median(c_reliability_np):  0.6950270533561707
np.mean(w_reliability_np):  0.5355429637535449
np.median(w_reliability_np):  0.5026592016220093
self.threshold:  0.6950270533561707
Accuracy:  0.841648130494651
Confusion Metric: 
 [[3782  198    1  143   84   30   31]
 [ 271 1865    9   30   43    2   18]
 [  15   34  312    0    3    0    2]
 [ 220   30    1 1363   19    2    2]
 [ 118   48    1   27  161    0    6]
 [  34    5    1    6    4  185    7]
 [  35    7    0    2    2    4  278]]
Micro Precision/Recall/F-score:  (0.841648130494651, 0.841648130494651, 0.8416481304946511, None)
Macro Precision/Recall/F-score:  (0.8103908406198174, 0.7803345605454135, 0.7942122167511677, None)


epoch 33/40
model.reset
self.reset_num:  33
self.cheat:  True
self.mask_p:  -1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.5899798750132401
ex_Confusion Metric: 
 [[1614  430   89 1262   46  760   68]
 [  71 1701  148  210   12   64   32]
 [   1   13  345    3    0    2    2]
 [ 101   90   11 1355   11   58   11]
 [  23   83   12  138   79   21    5]
 [   6    9    3   15    1  195   13]
 [   3    8    1   16    0   19  281]]
np.mean(reliability_np):  0.633013768875231
np.median(reliability_np):  0.619173675775528
np.mean(c_reliability_np):  0.6835850124218947
np.median(c_reliability_np):  0.7003678679466248
np.mean(w_reliability_np):  0.5366872826755216
np.median(w_reliability_np):  0.5076205730438232
self.threshold:  0.7003678679466248
Accuracy:  0.8369876072449952
Confusion Metric: 
 [[3954  187    4   48   58    8   10]
 [ 340 1834    9   17   31    4    3]
 [  17   45  300    1    2    0    1]
 [ 347   38    1 1229   21    0    1]
 [ 137   50    0   18  154    1    1]
 [  55    6    1    3    2  172    3]
 [  52   10    0    2    1    4  259]]
Micro Precision/Recall/F-score:  (0.8369876072449952, 0.8369876072449952, 0.8369876072449952, None)
Macro Precision/Recall/F-score:  (0.8501176467245444, 0.7490143395173965, 0.7927275249435589, None)


epoch 34/40
model.reset
self.reset_num:  34
self.cheat:  True
self.mask_p:  -1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.5864844825759983
ex_Confusion Metric: 
 [[1583  479   97 1308   33  696   73]
 [  58 1721  168  198    8   53   32]
 [   1   15  344    3    0    1    2]
 [  96  111   10 1351    8   50   11]
 [  23   87   12  140   71   22    6]
 [   6    9    3   17    1  193   13]
 [   4    8    4   14    0   24  274]]
np.mean(reliability_np):  0.6347397693294411
np.median(reliability_np):  0.6208182573318481
np.mean(c_reliability_np):  0.6938303552483186
np.median(c_reliability_np):  0.7196182608604431
np.mean(w_reliability_np):  0.5465344417092131
np.median(w_reliability_np):  0.5189565718173981
self.threshold:  0.7196182608604431
Accuracy:  0.8304205063022985
Confusion Metric: 
 [[3841  221    2   67   83   38   17]
 [ 264 1900    2   18   45    3    6]
 [  15   58  288    1    2    0    2]
 [ 358   39    2 1204   31    2    1]
 [ 111   52    1   22  172    1    2]
 [  38    8    0    2    4  181    9]
 [  46   13    0    2    4    9  254]]
Micro Precision/Recall/F-score:  (0.8304205063022985, 0.8304205063022985, 0.8304205063022985, None)
Macro Precision/Recall/F-score:  (0.8133154605644088, 0.7528385780064456, 0.7794556184122458, None)


epoch 35/40
model.reset
self.reset_num:  35
self.cheat:  True
self.mask_p:  -1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.5737739646223917
ex_Confusion Metric: 
 [[1434  478   77 1334   38  844   64]
 [  55 1758  126  209    9   55   26]
 [   1   20  337    4    0    2    2]
 [  88  111    9 1346   10   65    8]
 [  18   88    9  138   79   25    4]
 [   6    9    3   17    1  195   11]
 [   4    9    1   17    1   28  268]]
np.mean(reliability_np):  0.6360815307879534
np.median(reliability_np):  0.6225356459617615
np.mean(c_reliability_np):  0.695379803280054
np.median(c_reliability_np):  0.7220144271850586
np.mean(w_reliability_np):  0.5474171665224948
np.median(w_reliability_np):  0.5213116109371185
self.threshold:  0.7220144271850586
Accuracy:  0.8101895985594746
Confusion Metric: 
 [[4028  129    2   46   45   15    4]
 [ 504 1663   11   26   29    2    3]
 [  23   37  302    0    2    0    2]
 [ 454   29    1 1128   24    1    0]
 [ 160   49    2   24  125    1    0]
 [  57    5    0    3    2  170    5]
 [  80    8    0    1    2    4  233]]
Micro Precision/Recall/F-score:  (0.8101895985594746, 0.8101895985594746, 0.8101895985594746, None)
Macro Precision/Recall/F-score:  (0.8376484458151477, 0.7085611753118208, 0.7610728263529033, None)


epoch 36/40
model.reset
self.reset_num:  36
self.cheat:  True
self.mask_p:  -1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.5933693464675353
ex_Confusion Metric: 
 [[1638  454   90 1346   30  661   50]
 [  66 1721  145  226    4   49   27]
 [   2   15  343    3    0    1    2]
 [ 108   98    9 1367    9   38    8]
 [  22   89    9  146   74   17    4]
 [   6   11    3   21    0  190   11]
 [   4    8    5   18    0   24  269]]
np.mean(reliability_np):  0.6335510869025023
np.median(reliability_np):  0.6200320720672607
np.mean(c_reliability_np):  0.6843266624854915
np.median(c_reliability_np):  0.7017147839069366
np.mean(w_reliability_np):  0.5370445666554757
np.median(w_reliability_np):  0.5072764158248901
self.threshold:  0.7017147839069366
Accuracy:  0.8219468276665608
Confusion Metric: 
 [[3909  153    4  105   70   14   14]
 [ 433 1701    9   41   42    3    9]
 [  20   49  293    0    3    0    1]
 [ 318   25    1 1262   27    0    4]
 [ 134   49    0   22  153    1    2]
 [  46    5    0    4    2  178    7]
 [  45    8    0    4    1    6  264]]
Micro Precision/Recall/F-score:  (0.8219468276665608, 0.8219468276665608, 0.8219468276665607, None)
Macro Precision/Recall/F-score:  (0.8222011853810339, 0.7444902224788433, 0.7791338858762805, None)


epoch 37/40
model.reset
self.reset_num:  37
self.cheat:  True
self.mask_p:  -1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.5683719944921088
ex_Confusion Metric: 
 [[1466  401   88 1213   31  977   93]
 [  66 1680  150  216    6   82   38]
 [   1   13  344    1    0    5    2]
 [  91   97   10 1328    6   88   17]
 [  15   85   11  136   73   33    8]
 [   6   11    3   14    0  196   12]
 [   4    6    2   11    0   26  279]]
np.mean(reliability_np):  0.6265912319061913
np.median(reliability_np):  0.6107422411441803
np.mean(c_reliability_np):  0.6741382407688891
np.median(c_reliability_np):  0.6861567497253418
np.mean(w_reliability_np):  0.5329921301632571
np.median(w_reliability_np):  0.5012511610984802
self.threshold:  0.6861567497253418
Accuracy:  0.8277724817286305
Confusion Metric: 
 [[3884  239    2   67   48   19   10]
 [ 268 1912    4   27   20    1    6]
 [  16   77  272    0    0    0    1]
 [ 379   60    0 1179   17    2    0]
 [ 124   75    0   22  136    1    3]
 [  52    6    0    4    0  176    4]
 [  53   11    0    2    1    5  256]]
Micro Precision/Recall/F-score:  (0.8277724817286305, 0.8277724817286305, 0.8277724817286305, None)
Macro Precision/Recall/F-score:  (0.8415544066426504, 0.7302900456307146, 0.776011951507542, None)


epoch 38/40
model.reset
self.reset_num:  38
self.cheat:  True
self.mask_p:  -1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.5720792288952441
ex_Confusion Metric: 
 [[1458  477   92 1288   36  848   70]
 [  48 1722  162  211    7   63   25]
 [   2   15  343    1    0    3    2]
 [  93  106   10 1336    9   74    9]
 [  18   90   12  137   74   24    6]
 [   6   11    3   15    0  196   11]
 [   3    9    4   14    0   26  272]]
np.mean(reliability_np):  0.6289451090691769
np.median(reliability_np):  0.6136245429515839
np.mean(c_reliability_np):  0.6855254766538703
np.median(c_reliability_np):  0.7028387188911438
np.mean(w_reliability_np):  0.5392416426192711
np.median(w_reliability_np):  0.5071423351764679
self.threshold:  0.7028387188911438
Accuracy:  0.8215231437347739
Confusion Metric: 
 [[3887  220    1   76   65   11    9]
 [ 325 1844    5   19   42    1    2]
 [  23   72  268    0    2    0    1]
 [ 364   51    0 1185   36    0    1]
 [ 131   63    1   15  150    0    1]
 [  48    7    1    6    4  173    3]
 [  58   13    0    2    5    1  249]]
Micro Precision/Recall/F-score:  (0.8215231437347739, 0.8215231437347739, 0.8215231437347739, None)
Macro Precision/Recall/F-score:  (0.8365958992665793, 0.725732581969195, 0.7729791464852692, None)


epoch 39/40
model.reset
self.reset_num:  39
self.cheat:  True
self.mask_p:  -1.0
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.5618048935494121
ex_Confusion Metric: 
 [[1320  473   79 1489   31  818   59]
 [  50 1747  123  231    5   57   25]
 [   1   19  337    4    0    3    2]
 [  77  103    9 1379    9   49   11]
 [  13   93   11  149   64   25    6]
 [   6   11    3   21    0  191   10]
 [   3   12    2   21    0   24  266]]
np.mean(reliability_np):  0.6294170053294533
np.median(reliability_np):  0.6135971248149872
np.mean(c_reliability_np):  0.688708420929978
np.median(c_reliability_np):  0.7111943960189819
np.mean(w_reliability_np):  0.5436119452886083
np.median(w_reliability_np):  0.5147450566291809
self.threshold:  0.7111943960189819
Accuracy:  0.8098718356106345
Confusion Metric: 
 [[3999  154    1   53   35    5   22]
 [ 526 1667    1   21   13    1    9]
 [  32   69  261    0    3    0    1]
 [ 402   42    0 1167   26    0    0]
 [ 138   76    0   20  126    0    1]
 [  54    7    0    5    2  170    4]
 [  56    9    0    1    1    5  256]]
Micro Precision/Recall/F-score:  (0.8098718356106345, 0.8098718356106345, 0.8098718356106345, None)
Macro Precision/Recall/F-score:  (0.8470981700374125, 0.7056595174438234, 0.7618000265628527, None)
best_epoch:  4 0.8391190716843172 0.8740599512763478


test print 
Accuracy:  0.7871911245587494
Confusion Metric: 
 [[3321  110    1   47   34    6   21]
 [ 417 1277    2   13   13    3    8]
 [  38   68  213    2    1    1    0]
 [ 467   36    0 1034   30    1    9]
 [ 158   52    0   12   82    4    8]
 [  69    3    0    3    0  124    8]
 [  27    5    0    4    2    5  193]]
Micro Precision/Recall/F-score:  (0.7871911245587494, 0.7871911245587494, 0.7871911245587494, None)
Macro Precision/Recall/F-score:  (0.8034225641488723, 0.6666357462208392, 0.7159304642239082, None)
test f1:   0.7159304642239082 [0.7159304642239082]
test ass:  0.7871911245587494 [0.7871911245587494]
valid f1:  0.8391190716843172 [0.8391190716843172]
valid acc: 0.8740599512763478 [0.8740599512763478]
