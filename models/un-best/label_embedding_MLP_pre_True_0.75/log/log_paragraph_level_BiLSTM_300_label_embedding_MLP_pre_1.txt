['/home/lizhuoqun/SE_type_code', '/home/lizhuoqun/anconda/envs/py38/lib/python38.zip', '/home/lizhuoqun/anconda/envs/py38/lib/python3.8', '/home/lizhuoqun/anconda/envs/py38/lib/python3.8/lib-dynload', '/home/lizhuoqun/anconda/envs/py38/lib/python3.8/site-packages', '/home/lizhuoqun/SE_type_code/data', '/home/lizhuoqun/SE_type_code/models', '/home/lizhuoqun/SE_type_code/tools', '/home/lizhuoqun/SE_type_code/resource', '/home/lizhuoqun/SE_type_code/pre_train']
sentence level BiLSTM extra
___________****************************************** 300 ********************************************************************************
paragraph level BiLSTM label embedding MLP pre
Namespace(BATCH_SIZE=128, DROPOUT=0.5, EPOCHs=40, LEARN_RATE=0.001, WEIGHT_DECAY=0.0001, cheat='True', fold_num=1, mask_p=0.75)




time= 0
self.BiLSTM_1_require_grad:  True
self.cheat:  True
self.mask_p:  0.75
self.threshold:  0.8
start to get stanford
already get stanford
start get bert_tokenizer
get bert tokenizer
if_do_embedding:  True
start read data catalogue
start get train data
already deal 10 file
already deal 20 file
already deal 30 file
already deal 40 file
already deal 50 file
already deal 60 file
already deal 70 file
already deal 80 file
already deal 90 file
already deal 100 file
already deal 110 file
already deal 120 file
already deal 130 file
already deal 140 file
already deal 150 file
already deal 160 file
already deal 170 file
already deal 180 file
already deal 190 file
already deal 200 file
already deal 210 file
already deal 220 file
already deal 230 file
already deal 240 file
already deal 250 file
already deal 260 file
already deal 270 file
already deal 280 file
len(train_valid_data_list):  3368
already deal 10 file
already deal 20 file
already deal 30 file
already deal 40 file
already deal 50 file
already deal 60 file
already deal 70 file
already deal 80 file
complete get data, len(test_data_list):  919


start sentence level BiLSTM  extra


epoch 0/4


epoch 1/4


epoch 2/4


epoch 3/4
sentence level BiLSTM  extra best_epoch:  3 -1 -1
sentence level BiLSTM  extra end

********************************************


epoch 0/40
model.reset
self.reset_num:  0
self.cheat:  True
self.mask_p:  0.75
self.valid_flag:  False
self.BiLSTM_1_require_grad:  True
Accuracy:  0.7804258023514459
Confusion Metric: 
 [[3704  187   11  280    0   71   16]
 [ 409 1670   25  108    0    9   17]
 [  19   49  291    2    0    1    4]
 [ 294   23    2 1308    1    3    6]
 [ 187   54    0  106    3    3    8]
 [  39    6    1   11    0  160   25]
 [  27    6    0   19    0   44  232]]
Micro Precision/Recall/F-score:  (0.7804258023514459, 0.7804258023514459, 0.7804258023514459, None)
Macro Precision/Recall/F-score:  (0.7538290269738158, 0.6549630552111384, 0.6504552195997343, None)


epoch 1/40
model.reset
self.reset_num:  1
self.cheat:  True
self.mask_p:  0.75
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.7356212265649825
ex_Confusion Metric: 
 [[3093  239   32  568   33  219   85]
 [ 227 1708   64  142   28   30   39]
 [   9   31  321    1    0    1    3]
 [ 246   84    6 1241   17   25   18]
 [  66   62    3   94  116    7   13]
 [  18    9    4   13    3  175   20]
 [   9    6    1    7    1   13  291]]
np.mean(reliability_np):  0.7665781868109384
np.median(reliability_np):  0.8211359679698944
np.mean(c_reliability_np):  0.7950367241733103
np.median(c_reliability_np):  0.8597179055213928
np.mean(w_reliability_np):  0.5977654650401419
np.median(w_reliability_np):  0.5748989284038544
self.threshold:  0.8597179055213928
Accuracy:  0.8030928927020443
Confusion Metric: 
 [[3727  165    8  300   17   29   23]
 [ 383 1692   28   90   32    0   13]
 [  18   40  306    0    0    0    2]
 [ 257   18    3 1345    6    5    3]
 [ 142   46    1   88   79    1    4]
 [  52    5    1    3    1  170   10]
 [  34    7    0   15    3    6  263]]
Micro Precision/Recall/F-score:  (0.8030928927020443, 0.8030928927020443, 0.8030928927020443, None)
Macro Precision/Recall/F-score:  (0.783304568011549, 0.7157008604956806, 0.7365770930142482, None)


epoch 2/40
model.reset
self.reset_num:  2
self.cheat:  True
self.mask_p:  0.75
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.7392225399851711
ex_Confusion Metric: 
 [[3041  272   30  606   67  186   67]
 [ 185 1757   67  127   47   24   31]
 [   8   29  325    2    0    0    2]
 [ 232   90    6 1245   27   21   16]
 [  56   57    6   78  148    8    8]
 [  20   10    3   12    4  177   16]
 [  10    7    1   11    3   10  286]]
np.mean(reliability_np):  0.7402567532569856
np.median(reliability_np):  0.7802760004997253
np.mean(c_reliability_np):  0.7822992390587228
np.median(c_reliability_np):  0.8401675820350647
np.mean(w_reliability_np):  0.5833069545154064
np.median(w_reliability_np):  0.559823215007782
self.threshold:  0.8401675820350647
Accuracy:  0.8145323588602902
Confusion Metric: 
 [[3833  176    9  188   18   22   23]
 [ 345 1773   24   66    9    3   18]
 [  20   41  300    1    1    0    3]
 [ 320   39    4 1253   12    4    5]
 [ 159   63    1   45   85    4    4]
 [  46    6    3    5    0  173    9]
 [  36    7    1    7    1    3  273]]
Micro Precision/Recall/F-score:  (0.8145323588602902, 0.8145323588602902, 0.8145323588602901, None)
Macro Precision/Recall/F-score:  (0.806116185147796, 0.7225486303602026, 0.7479293176244971, None)


epoch 3/40
model.reset
self.reset_num:  3
self.cheat:  True
self.mask_p:  0.75
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.7448363520813474
ex_Confusion Metric: 
 [[3144  301   27  534   63  105   95]
 [ 182 1789   65  102   48   13   39]
 [   9   29  323    2    1    0    2]
 [ 293   96    7 1167   40   13   21]
 [  53   68    5   70  149    6   10]
 [  22   10    2   11    4  169   24]
 [  11   10    1    9    2    4  291]]
np.mean(reliability_np):  0.7264215321461837
np.median(reliability_np):  0.756332129240036
np.mean(c_reliability_np):  0.7649293398109516
np.median(c_reliability_np):  0.8116523325443268
np.mean(w_reliability_np):  0.5657870900388474
np.median(w_reliability_np):  0.5395791530609131
self.threshold:  0.8116523325443268
Accuracy:  0.7928185573562123
Confusion Metric: 
 [[3630  109   10  431   26   30   33]
 [ 415 1560   28  167   42    5   21]
 [  20   35  305    1    3    0    2]
 [ 184   15    1 1428    5    2    2]
 [ 102   29    1  111  112    2    4]
 [  39    4    3   12    0  177    7]
 [  27    2    0   14    5    7  273]]
Micro Precision/Recall/F-score:  (0.7928185573562123, 0.7928185573562123, 0.7928185573562123, None)
Macro Precision/Recall/F-score:  (0.7742606826894475, 0.7324284675044348, 0.7433802389884375, None)


epoch 4/40
model.reset
self.reset_num:  4
self.cheat:  True
self.mask_p:  0.75
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.7294778095540727
ex_Confusion Metric: 
 [[3027  222   27  723   54  145   71]
 [ 220 1665   58  184   59   20   32]
 [  12   26  323    3    0    0    2]
 [ 234   65    6 1266   31   16   19]
 [  62   50    2   88  143    7    9]
 [  22    8    2   14    3  174   19]
 [  12    5    0   14    4    4  289]]
np.mean(reliability_np):  0.707313898767567
np.median(reliability_np):  0.7238481044769287
np.mean(c_reliability_np):  0.7402317029126102
np.median(c_reliability_np):  0.7733293175697327
np.mean(w_reliability_np):  0.5546811114509496
np.median(w_reliability_np):  0.5296560823917389
self.threshold:  0.7733293175697327
Accuracy:  0.8111428874059952
Confusion Metric: 
 [[3797  153    6  231   32   20   30]
 [ 376 1693   20   82   47    7   13]
 [  20   41  297    3    2    0    3]
 [ 286   27    5 1294   15    2    8]
 [ 132   43    0   42  140    1    3]
 [  52    4    4    5    1  164   12]
 [  38    6    0    7    2    2  273]]
Micro Precision/Recall/F-score:  (0.8111428874059952, 0.8111428874059952, 0.8111428874059952, None)
Macro Precision/Recall/F-score:  (0.7944827108248512, 0.7350964149269071, 0.7596128347849879, None)


epoch 5/40
model.reset
self.reset_num:  5
self.cheat:  True
self.mask_p:  0.75
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.7375278042580236
ex_Confusion Metric: 
 [[3051  271   28  664   80   96   79]
 [ 191 1739   53  148   61   13   33]
 [   9   29  323    3    0    0    2]
 [ 254   79    6 1234   36   12   16]
 [  51   58    2   81  155    6    8]
 [  21   11    2   13    3  168   24]
 [  13    7    0   12    2    1  293]]
np.mean(reliability_np):  0.6938686278486178
np.median(reliability_np):  0.7066658139228821
np.mean(c_reliability_np):  0.738854226621081
np.median(c_reliability_np):  0.7756163477897644
np.mean(w_reliability_np):  0.5483748597228979
np.median(w_reliability_np):  0.5225140452384949
self.threshold:  0.7756163477897644
Accuracy:  0.8092363097129541
Confusion Metric: 
 [[3560  204   11  401   41   28   24]
 [ 273 1792   27   84   40    7   15]
 [  17   42  303    2    0    0    2]
 [ 184   34    2 1398   13    1    5]
 [  81   48    0   86  141    3    2]
 [  38    9    2   11    2  170   10]
 [  26    9    0   15    0    2  276]]
Micro Precision/Recall/F-score:  (0.8092363097129541, 0.8092363097129541, 0.8092363097129541, None)
Macro Precision/Recall/F-score:  (0.7850467304707418, 0.7501469171068551, 0.7627853218993235, None)


epoch 6/40
model.reset
self.reset_num:  6
self.cheat:  True
self.mask_p:  0.75
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.7041626946298062
ex_Confusion Metric: 
 [[2601  341   36  948   88  157   98]
 [ 130 1783   78  147   45   16   39]
 [   6   27  327    3    1    0    2]
 [ 164   87    7 1316   34   13   16]
 [  35   61    6   91  154    6    8]
 [  13    9    3   17    4  171   25]
 [   7    7    0   12    3    3  296]]
np.mean(reliability_np):  0.678971470140749
np.median(reliability_np):  0.685956597328186
np.mean(c_reliability_np):  0.7124638955627717
np.median(c_reliability_np):  0.7357256710529327
np.mean(w_reliability_np):  0.5402704415795541
np.median(w_reliability_np):  0.509259819984436
self.threshold:  0.7357256710529327
Accuracy:  0.8066942061222329
Confusion Metric: 
 [[3787  213    8  139   45   47   30]
 [ 317 1802   21   33   36   15   14]
 [  25   39  296    0    2    1    3]
 [ 413   54    2 1125   26   11    6]
 [ 116   59    0   28  151    4    3]
 [  28    8    2    8    2  183   11]
 [  34   11    0    6    1    4  272]]
Micro Precision/Recall/F-score:  (0.8066942061222329, 0.8066942061222329, 0.8066942061222329, None)
Macro Precision/Recall/F-score:  (0.7762304128275268, 0.741714470827263, 0.7552199660452513, None)


epoch 7/40
model.reset
self.reset_num:  7
self.cheat:  True
self.mask_p:  0.75
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.7247113653214702
ex_Confusion Metric: 
 [[2942  308   37  528  106  219  129]
 [ 150 1784   78  105   45   31   45]
 [  10   22  329    1    1    1    2]
 [ 254  105    8 1158   53   32   27]
 [  43   68    7   63  156    9   15]
 [  11   13    2   11    4  174   27]
 [   9    6    0    7    3    4  299]]
np.mean(reliability_np):  0.6668913029297564
np.median(reliability_np):  0.6706214845180511
np.mean(c_reliability_np):  0.7070921129195602
np.median(c_reliability_np):  0.7351709604263306
np.mean(w_reliability_np):  0.5167872003004064
np.median(w_reliability_np):  0.48030370473861694
self.threshold:  0.7351709604263306
Accuracy:  0.8034106556508844
Confusion Metric: 
 [[3733  141   10  258   33   60   34]
 [ 413 1656   21   79   44   11   14]
 [  20   35  301    1    4    2    3]
 [ 271   30    0 1309   15    8    4]
 [ 128   45    0   47  133    6    2]
 [  32    5    2    5    1  190    7]
 [  39    3    1   14    0    8  263]]
Micro Precision/Recall/F-score:  (0.8034106556508844, 0.8034106556508844, 0.8034106556508844, None)
Macro Precision/Recall/F-score:  (0.7688349672337622, 0.7416860256628732, 0.7500525072816085, None)


epoch 8/40
model.reset
self.reset_num:  8
self.cheat:  True
self.mask_p:  0.75
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.7170850545493063
ex_Confusion Metric: 
 [[2858  267   35  748   53  195  113]
 [ 181 1714   71  159   32   33   48]
 [   9   25  325    3    1    1    2]
 [ 209   73    8 1272   31   24   20]
 [  53   62    6   95  124    9   12]
 [  15   10    2   11    3  179   22]
 [  11    4    0   10    1    4  298]]
np.mean(reliability_np):  0.6566522440149732
np.median(reliability_np):  0.6558868885040283
np.mean(c_reliability_np):  0.6823023304387245
np.median(c_reliability_np):  0.6910612881183624
np.mean(w_reliability_np):  0.5051712096574288
np.median(w_reliability_np):  0.4741523861885071
self.threshold:  0.6910612881183624
Accuracy:  0.8106132824912615
Confusion Metric: 
 [[3801  203   10  145   70   23   17]
 [ 333 1771   17   42   62    3   10]
 [  21   39  300    0    4    0    2]
 [ 369   41    1 1170   52    1    3]
 [  87   56    1   29  184    2    2]
 [  48    7    2    5    3  168    9]
 [  38   12    0    7    9    3  259]]
Micro Precision/Recall/F-score:  (0.8106132824912615, 0.8106132824912615, 0.8106132824912614, None)
Macro Precision/Recall/F-score:  (0.7944461028963291, 0.7442346422148789, 0.7667361261186608, None)


epoch 9/40
model.reset
self.reset_num:  9
self.cheat:  True
self.mask_p:  0.75
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.7204745260036013
ex_Confusion Metric: 
 [[2856  312   38  727   53  206   77]
 [ 164 1779   67  144   27   23   34]
 [   9   28  323    2    1    1    2]
 [ 219   93    8 1254   27   20   16]
 [  46   73    5   98  119    9   11]
 [  17   11    2   10    3  179   20]
 [  15    8    0    8    0    5  292]]
np.mean(reliability_np):  0.6421552365687723
np.median(reliability_np):  0.6370366811752319
np.mean(c_reliability_np):  0.6744563449584923
np.median(c_reliability_np):  0.685276448726654
np.mean(w_reliability_np):  0.4941822082064015
np.median(w_reliability_np):  0.46583864092826843
self.threshold:  0.685276448726654
Accuracy:  0.7897468488507573
Confusion Metric: 
 [[3941  149    8   67   55   28   21]
 [ 483 1630   32   27   49    3   14]
 [  26   21  314    0    3    0    2]
 [ 537   48    3  977   57    9    6]
 [ 137   42    0   20  156    3    3]
 [  44    4    2    1    3  181    7]
 [  49    5    1    7    2    7  257]]
Micro Precision/Recall/F-score:  (0.7897468488507573, 0.7897468488507573, 0.7897468488507573, None)
Macro Precision/Recall/F-score:  (0.7810793917645441, 0.72426375307992, 0.7462707469093895, None)


epoch 10/40
model.reset
self.reset_num:  10
self.cheat:  True
self.mask_p:  0.75
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.7212159728842283
ex_Confusion Metric: 
 [[2959  352   40  469   96  225  128]
 [ 173 1780   65   98   45   32   45]
 [   6   26  329    0    1    2    2]
 [ 299  108    7 1102   63   31   27]
 [  43   71    7   54  159    9   18]
 [  15    8    4    9    4  182   20]
 [   9    5    0    6    4    6  298]]
np.mean(reliability_np):  0.6322672158016127
np.median(reliability_np):  0.6221743524074554
np.mean(c_reliability_np):  0.6637296110286571
np.median(c_reliability_np):  0.6736842393875122
np.mean(w_reliability_np):  0.47229132858475836
np.median(w_reliability_np):  0.4390885531902313
self.threshold:  0.6736842393875122
Accuracy:  0.7823323800444868
Confusion Metric: 
 [[3833  166   13  177   23   40   17]
 [ 454 1668   35   40   23    8   10]
 [  31   29  303    1    1    0    1]
 [ 486   57    1 1076   10    5    2]
 [ 126   56    2   84   89    3    1]
 [  48    7    1    6    1  170    9]
 [  53   11    1    8    1    7  247]]
Micro Precision/Recall/F-score:  (0.7823323800444868, 0.7823323800444868, 0.7823323800444867, None)
Macro Precision/Recall/F-score:  (0.7734414656176157, 0.6900587101515144, 0.7187326199099129, None)


epoch 11/40
model.reset
self.reset_num:  11
self.cheat:  True
self.mask_p:  0.75
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.62165024891431
ex_Confusion Metric: 
 [[1761  424   71 1387   56  400  170]
 [  69 1812  108  137   19   39   54]
 [   0   26  336    1    0    1    2]
 [  45  106   13 1378   22   41   32]
 [  26   79    9  117   96   13   21]
 [   5   10    5   15    1  183   23]
 [   2    8    0    9    1    5  303]]
np.mean(reliability_np):  0.6243657848615057
np.median(reliability_np):  0.610436350107193
np.mean(c_reliability_np):  0.6736193043899447
np.median(c_reliability_np):  0.6907224059104919
np.mean(w_reliability_np):  0.5045538100164721
np.median(w_reliability_np):  0.47066521644592285
self.threshold:  0.6907224059104919
Accuracy:  0.7866751403453024
Confusion Metric: 
 [[3926  165    9   45   56   39   29]
 [ 447 1667   33   23   46    6   16]
 [  28   29  306    0    0    1    2]
 [ 588   68    3  915   48    6    9]
 [ 124   53    2   17  157    5    3]
 [  38    7    1    0    2  184   10]
 [  40    6    0    4    1    5  272]]
Micro Precision/Recall/F-score:  (0.7866751403453024, 0.7866751403453024, 0.7866751403453024, None)
Macro Precision/Recall/F-score:  (0.7742474830896463, 0.7262902268019442, 0.7422531651335296, None)


epoch 12/40
model.reset
self.reset_num:  12
self.cheat:  True
self.mask_p:  0.75
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.6979133566359496
ex_Confusion Metric: 
 [[2563  385   49  832   68  228  144]
 [ 120 1826   76  120   23   28   45]
 [   4   27  330    2    0    1    2]
 [ 149  117    9 1269   35   31   27]
 [  44   87    6   77  122    8   17]
 [  11   10    3   13    4  175   26]
 [   6    7    0    8    0    3  304]]
np.mean(reliability_np):  0.6175611747686638
np.median(reliability_np):  0.602555900812149
np.mean(c_reliability_np):  0.6522166404806983
np.median(c_reliability_np):  0.6568605899810791
np.mean(w_reliability_np):  0.46995015975302096
np.median(w_reliability_np):  0.43432335555553436
self.threshold:  0.6568605899810791
Accuracy:  0.786463298379409
Confusion Metric: 
 [[3946  152    7   61   63   16   24]
 [ 500 1620   13   29   63    2   11]
 [  32   47  281    0    4    0    2]
 [ 537   51    0  978   66    1    4]
 [ 120   45    1   23  165    2    5]
 [  59    9    0    1    2  161   10]
 [  35    8    0    8    2    1  274]]
Micro Precision/Recall/F-score:  (0.786463298379409, 0.786463298379409, 0.786463298379409, None)
Macro Precision/Recall/F-score:  (0.7964058065171048, 0.7101587940048173, 0.7441254131923667, None)


epoch 13/40
model.reset
self.reset_num:  13
self.cheat:  True
self.mask_p:  0.75
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.7129541362143841
ex_Confusion Metric: 
 [[2747  355   38  805   81  136  107]
 [ 151 1802   64  134   28   16   43]
 [   6   30  326    1    0    1    2]
 [ 191  108    7 1249   45   15   22]
 [  42   86    5   74  134    6   14]
 [  15    9    3   14    2  172   27]
 [   8    8    0    8    1    2  301]]
np.mean(reliability_np):  0.6131647120846888
np.median(reliability_np):  0.5977573692798615
np.mean(c_reliability_np):  0.6469631995316725
np.median(c_reliability_np):  0.6534236073493958
np.mean(w_reliability_np):  0.4648677479901877
np.median(w_reliability_np):  0.4340049624443054
self.threshold:  0.6534236073493958
Accuracy:  0.7932422412879991
Confusion Metric: 
 [[3932  188    8   50   52   15   24]
 [ 404 1739   12   25   43    2   13]
 [  24   58  278    0    3    0    3]
 [ 567   64    0  938   59    3    6]
 [ 116   56    1   20  160    2    6]
 [  52    8    1    1    2  168   10]
 [  35    7    0    6    1    5  274]]
Micro Precision/Recall/F-score:  (0.7932422412879991, 0.7932422412879991, 0.7932422412879991, None)
Macro Precision/Recall/F-score:  (0.7989084499093011, 0.7147783025649662, 0.747779098916371, None)


epoch 14/40
model.reset
self.reset_num:  14
self.cheat:  True
self.mask_p:  0.75
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.7144370299756382
ex_Confusion Metric: 
 [[2779  390   40  715   71  154  120]
 [ 137 1809   78  114   28   20   52]
 [   7   26  328    1    1    1    2]
 [ 202  122    8 1225   41   17   22]
 [  43   91    6   66  131    6   18]
 [  16   10    2   13    3  170   28]
 [   9    6    0    7    0    3  303]]
np.mean(reliability_np):  0.606312500783972
np.median(reliability_np):  0.5900604128837585
np.mean(c_reliability_np):  0.6411424058070441
np.median(c_reliability_np):  0.6459606885910034
np.mean(w_reliability_np):  0.4627780522211546
np.median(w_reliability_np):  0.4316957890987396
self.threshold:  0.6459606885910034
Accuracy:  0.7992797373159622
Confusion Metric: 
 [[3528  278    9  250   83   64   57]
 [ 246 1862   10   46   51    6   17]
 [  18   65  273    0    7    1    2]
 [ 269   64    0 1240   48    4   12]
 [  63   71    0   37  179    4    7]
 [  28   12    0    2    3  182   15]
 [  23    9    0    7    2    5  282]]
Micro Precision/Recall/F-score:  (0.7992797373159622, 0.7992797373159622, 0.7992797373159622, None)
Macro Precision/Recall/F-score:  (0.7479884741906846, 0.7527811185122244, 0.7475977419567142, None)


epoch 15/40
model.reset
self.reset_num:  15
self.cheat:  True
self.mask_p:  0.75
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.6944179641987077
ex_Confusion Metric: 
 [[2539  419   39  837   74  200  161]
 [ 107 1822   72  136   24   20   57]
 [   4   32  324    2    1    1    2]
 [ 161  107    7 1261   46   29   26]
 [  36   93    4   74  129    7   18]
 [  12   10    2   13    2  174   29]
 [   5    7    0    6    0    3  307]]
np.mean(reliability_np):  0.6007282668115719
np.median(reliability_np):  0.582586407661438
np.mean(c_reliability_np):  0.6371869249195496
np.median(c_reliability_np):  0.6364986598491669
np.mean(w_reliability_np):  0.46328248275731215
np.median(w_reliability_np):  0.4295947551727295
self.threshold:  0.6364986598491669
Accuracy:  0.7923948734244254
Confusion Metric: 
 [[3718  265   13  117   45   83   28]
 [ 278 1846   12   32   44   11   15]
 [  16   58  285    0    4    1    2]
 [ 438   77    0 1050   44   18   10]
 [ 140   70    5   15  121    4    6]
 [  27   11    1    1    1  191   10]
 [  26   13    2    6    4    7  270]]
Micro Precision/Recall/F-score:  (0.7923948734244254, 0.7923948734244254, 0.7923948734244254, None)
Macro Precision/Recall/F-score:  (0.7434365189962554, 0.7233551867463948, 0.7271102131799524, None)


epoch 16/40
model.reset
self.reset_num:  16
self.cheat:  True
self.mask_p:  0.75
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.6968541468064824
ex_Confusion Metric: 
 [[2790  389   61  432   25  446  126]
 [ 123 1818   87  105   12   42   51]
 [   5   25  332    1    0    1    2]
 [ 283  120   11 1069   25  100   29]
 [  66  100    7   65   83   15   25]
 [  12   11    2    7    2  183   25]
 [   5    7    0    8    0    4  304]]
np.mean(reliability_np):  0.6100137774166571
np.median(reliability_np):  0.594812273979187
np.mean(c_reliability_np):  0.6652093069778784
np.median(c_reliability_np):  0.6756146550178528
np.mean(w_reliability_np):  0.4810257540569282
np.median(w_reliability_np):  0.4477028101682663
self.threshold:  0.6756146550178528
Accuracy:  0.8005507891113229
Confusion Metric: 
 [[3634  254    6  258   75   21   21]
 [ 271 1821    3   63   65    4   11]
 [  22   81  251    1    7    1    3]
 [ 276   55    0 1260   38    1    7]
 [  80   62    0   53  158    3    5]
 [  43   10    0    9    2  167   11]
 [  29   14    0   11    2    5  267]]
Micro Precision/Recall/F-score:  (0.8005507891113229, 0.8005507891113229, 0.8005507891113229, None)
Macro Precision/Recall/F-score:  (0.7796475455162101, 0.7231713328429173, 0.7470863735772806, None)


epoch 17/40
model.reset
self.reset_num:  17
self.cheat:  True
self.mask_p:  0.75
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.7015146700561381
ex_Confusion Metric: 
 [[2557  457   36  882   58  155  124]
 [  91 1867   62  133   18   17   50]
 [   4   37  318    3    1    1    2]
 [ 157  114    6 1298   27   11   24]
 [  36   91    4   91  107    8   24]
 [  14   11    1   15    2  170   29]
 [   3    9    0    8    0    2  306]]
np.mean(reliability_np):  0.6068092704941443
np.median(reliability_np):  0.5920756757259369
np.mean(c_reliability_np):  0.6476722792067702
np.median(c_reliability_np):  0.6486715078353882
np.mean(w_reliability_np):  0.47608786871071146
np.median(w_reliability_np):  0.44434206187725067
self.threshold:  0.6486715078353882
Accuracy:  0.7832856688910073
Confusion Metric: 
 [[3658  211    7  236  131   15   11]
 [ 330 1695    5   54  146    2    6]
 [  22   90  231    2   18    2    1]
 [ 311   41    0 1206   75    1    3]
 [  75   43    0   35  206    1    1]
 [  53   13    0   12    3  153    8]
 [  50   11    0   13    5    3  246]]
Micro Precision/Recall/F-score:  (0.7832856688910073, 0.7832856688910073, 0.7832856688910073, None)
Macro Precision/Recall/F-score:  (0.7788307704486394, 0.7049967665601572, 0.7299361303113322, None)


epoch 18/40
model.reset
self.reset_num:  18
self.cheat:  True
self.mask_p:  0.75
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.700773223175511
ex_Confusion Metric: 
 [[2591  405   42  928   81  137   85]
 [ 114 1821   66  154   29   14   40]
 [   6   34  319    3    1    1    2]
 [ 158  102    6 1308   35   13   15]
 [  37   88    5   90  119    8   14]
 [  18   10    2   16    2  167   27]
 [  16    5    0   12    2    2  291]]
np.mean(reliability_np):  0.5931211083394433
np.median(reliability_np):  0.5728188157081604
np.mean(c_reliability_np):  0.6293191380433946
np.median(c_reliability_np):  0.6262818872928619
np.mean(w_reliability_np):  0.46069969565467495
np.median(w_reliability_np):  0.42989471554756165
self.threshold:  0.6262818872928619
Accuracy:  0.7862514564135156
Confusion Metric: 
 [[3528  286    4  267   88   73   23]
 [ 290 1827    4   38   59   11    9]
 [  26  102  223    2    7    3    3]
 [ 279   70    0 1226   48    9    5]
 [  66   64    0   56  168    5    2]
 [  29   11    0    6    5  181   10]
 [  27   10    0    9    3    9  270]]
Micro Precision/Recall/F-score:  (0.7862514564135156, 0.7862514564135156, 0.7862514564135156, None)
Macro Precision/Recall/F-score:  (0.7480907840228364, 0.7196394433275727, 0.7271369819255885, None)


epoch 19/40
model.reset
self.reset_num:  19
self.cheat:  True
self.mask_p:  0.75
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.6868975744094905
ex_Confusion Metric: 
 [[2468  391   32  910   81  270  117]
 [ 122 1802   61  141   31   34   47]
 [   5   35  320    2    1    1    2]
 [ 143  111    6 1291   33   33   20]
 [  35   81    4   89  124   15   13]
 [  11   10    2   13    2  177   27]
 [   6    5    0   10    2    2  303]]
np.mean(reliability_np):  0.5852578761042231
np.median(reliability_np):  0.5628037452697754
np.mean(c_reliability_np):  0.6196319007193389
np.median(c_reliability_np):  0.6106090545654297
np.mean(w_reliability_np):  0.44728172280610173
np.median(w_reliability_np):  0.4132562726736069
self.threshold:  0.6106090545654297
Accuracy:  0.7925007944073721
Confusion Metric: 
 [[3627  342    7  158   70   43   22]
 [ 233 1913    5   37   35    5   10]
 [  17  100  242    0    4    1    2]
 [ 374   92    0 1119   44    3    5]
 [  80   88    0   31  153    4    5]
 [  41   15    0    5    1  171    9]
 [  38   11    0    9    2   11  257]]
Micro Precision/Recall/F-score:  (0.7925007944073721, 0.7925007944073721, 0.7925007944073721, None)
Macro Precision/Recall/F-score:  (0.7697490808624858, 0.7090193006784203, 0.7336514587583643, None)


epoch 20/40
model.reset
self.reset_num:  20
self.cheat:  True
self.mask_p:  0.75
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.6891219150513717
ex_Confusion Metric: 
 [[2465  531   37  806   61  262  107]
 [  75 1894   62  123   16   23   45]
 [   2   39  320    1    1    1    2]
 [ 161  142    6 1246   29   33   20]
 [  29  109    4   82  111   11   15]
 [  14   11    2   14    2  170   29]
 [   7    8    0    9    0    4  300]]
np.mean(reliability_np):  0.5803608474052121
np.median(reliability_np):  0.555845707654953
np.mean(c_reliability_np):  0.620011128480622
np.median(c_reliability_np):  0.6092236042022705
np.mean(w_reliability_np):  0.44818093793964875
np.median(w_reliability_np):  0.41391387581825256
self.threshold:  0.6092236042022705
Accuracy:  0.7808494862832327
Confusion Metric: 
 [[3730  349    9   69   56   37   19]
 [ 229 1950    9   12   25    6    7]
 [  15   83  263    0    2    1    2]
 [ 533  160    0  855   74    8    7]
 [  90  102    1   20  139    3    6]
 [  38   17    0    1    1  177    8]
 [  40   14    0    4    2   10  258]]
Micro Precision/Recall/F-score:  (0.7808494862832327, 0.7808494862832327, 0.7808494862832326, None)
Macro Precision/Recall/F-score:  (0.7694048644240766, 0.6984232273072118, 0.7232905087250303, None)


epoch 21/40
model.reset
self.reset_num:  21
self.cheat:  True
self.mask_p:  0.75
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.6839317868869823
ex_Confusion Metric: 
 [[2474  571   47  632   69  356  120]
 [  73 1913   78   79   15   37   43]
 [   3   32  326    1    1    1    2]
 [ 180  178    7 1152   36   59   25]
 [  32  113    5   65  115   12   19]
 [  11   12    2    9    2  179   27]
 [   6    9    0    8    0    7  298]]
np.mean(reliability_np):  0.5787240748828815
np.median(reliability_np):  0.5536358058452606
np.mean(c_reliability_np):  0.6226164072553532
np.median(c_reliability_np):  0.6149185299873352
np.mean(w_reliability_np):  0.4446572089622711
np.median(w_reliability_np):  0.41119861602783203
self.threshold:  0.6149185299873352
Accuracy:  0.7754475161529499
Confusion Metric: 
 [[3323  233   12  514  153   24   10]
 [ 230 1752   14  100  134    3    5]
 [  12   80  258    2   11    1    2]
 [ 169   38    0 1379   44    3    4]
 [  45   44    0   73  197    1    1]
 [  38   12    0   17    2  164    9]
 [  38   10    0   15   11    6  248]]
Micro Precision/Recall/F-score:  (0.7754475161529499, 0.7754475161529499, 0.7754475161529499, None)
Macro Precision/Recall/F-score:  (0.7560734880968505, 0.726863828414806, 0.7332080673957789, None)


epoch 22/40
model.reset
self.reset_num:  22
self.cheat:  True
self.mask_p:  0.75
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.6613706175193306
ex_Confusion Metric: 
 [[2145  472   45 1141   85  290   91]
 [  83 1820   81  165   24   28   37]
 [   2   31  327    2    1    1    2]
 [ 100  101    8 1348   33   31   16]
 [  26   90    6   87  127   13   12]
 [  13   11    2   16    2  176   22]
 [   5    5    0   11    1    5  301]]
np.mean(reliability_np):  0.5734335404258182
np.median(reliability_np):  0.5442488789558411
np.mean(c_reliability_np):  0.6175780389446008
np.median(c_reliability_np):  0.6050190925598145
np.mean(w_reliability_np):  0.45340171584513994
np.median(w_reliability_np):  0.4195638597011566
self.threshold:  0.6050190925598145
Accuracy:  0.743035695371253
Confusion Metric: 
 [[2971  233   12  750  238   49   16]
 [ 178 1729   32  109  172    8   10]
 [  11   56  286    1    9    1    2]
 [ 114   41    1 1384   90    3    4]
 [  33   42    0   62  221    1    2]
 [  19    9    2   24    3  175   10]
 [  31   10    1   20    6   11  249]]
Micro Precision/Recall/F-score:  (0.743035695371253, 0.743035695371253, 0.743035695371253, None)
Macro Precision/Recall/F-score:  (0.7143333290884745, 0.7414081826792039, 0.7145850291597633, None)


epoch 23/40
model.reset
self.reset_num:  23
self.cheat:  True
self.mask_p:  0.75
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.6349962927655969
ex_Confusion Metric: 
 [[1911  450   54 1311  126  325   92]
 [  65 1771   95  195   38   34   40]
 [   1   30  330    1    1    1    2]
 [  72   98   10 1376   42   26   13]
 [  19   83    6   95  133   15   10]
 [   5   11    2   22    3  180   19]
 [   4    5    1   11    3   10  294]]
np.mean(reliability_np):  0.5683162907603618
np.median(reliability_np):  0.5377503037452698
np.mean(c_reliability_np):  0.6001919822557654
np.median(c_reliability_np):  0.5797057151794434
np.mean(w_reliability_np):  0.4398557880219857
np.median(w_reliability_np):  0.4043562263250351
self.threshold:  0.5797057151794434
Accuracy:  0.7854040885499417
Confusion Metric: 
 [[3496  312    9  283   60   86   23]
 [ 240 1872    9   60   35   12   10]
 [  15   78  265    1    4    1    2]
 [ 289   76    0 1237   19   11    5]
 [  86   83    1   65  115    6    5]
 [  25   12    0   13    1  184    7]
 [  32   16    0    9    1   24  246]]
Micro Precision/Recall/F-score:  (0.7854040885499417, 0.7854040885499417, 0.7854040885499418, None)
Macro Precision/Recall/F-score:  (0.7368041477874118, 0.7091389580995144, 0.7160053765459625, None)


epoch 24/40
model.reset
self.reset_num:  24
self.cheat:  True
self.mask_p:  0.75
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.662747590297638
ex_Confusion Metric: 
 [[2183  524   46 1003   55  360   98]
 [  74 1842   77  158   14   32   41]
 [   1   32  327    1    1    2    2]
 [ 123  106    8 1323   25   37   15]
 [  29   97    7   95  102   16   15]
 [  13   12    2   15    2  181   17]
 [   4    7    0    9    0    9  299]]
np.mean(reliability_np):  0.5671459312524529
np.median(reliability_np):  0.535238116979599
np.mean(c_reliability_np):  0.608407611799865
np.median(c_reliability_np):  0.5937116146087646
np.mean(w_reliability_np):  0.4417899705647449
np.median(w_reliability_np):  0.41259562969207764
self.threshold:  0.5937116146087646
Accuracy:  0.786463298379409
Confusion Metric: 
 [[3593  271    9  316   43   26   11]
 [ 281 1826    9   75   33    7    7]
 [  20   82  256    2    4    1    1]
 [ 322   61    0 1231   18    2    3]
 [  82   71    0   86  116    4    2]
 [  38   14    0   13    1  169    7]
 [  43   18    0   11    2   20  234]]
Micro Precision/Recall/F-score:  (0.786463298379409, 0.786463298379409, 0.786463298379409, None)
Macro Precision/Recall/F-score:  (0.7713782665017562, 0.6917266329207544, 0.7238157260943492, None)


epoch 25/40
model.reset
self.reset_num:  25
self.cheat:  True
self.mask_p:  0.75
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.6767291600466052
ex_Confusion Metric: 
 [[2321  459   38 1134   55  187   75]
 [ 104 1835   62  172   16   16   33]
 [   3   36  323    1    0    1    2]
 [ 127  101    8 1347   23   16   15]
 [  39   92    6  103   97   13   11]
 [  14   11    2   20    2  175   18]
 [  10   10    0   11    1    5  291]]
np.mean(reliability_np):  0.5717099627198008
np.median(reliability_np):  0.5429096817970276
np.mean(c_reliability_np):  0.6157861633733845
np.median(c_reliability_np):  0.6051855087280273
np.mean(w_reliability_np):  0.45355034023913926
np.median(w_reliability_np):  0.4250957816839218
self.threshold:  0.6051855087280273
Accuracy:  0.7815909331638597
Confusion Metric: 
 [[3594  217   12  329   57   39   21]
 [ 338 1712   23   90   51    6   18]
 [  16   57  285    2    4    1    1]
 [ 314   42    0 1250   23    3    5]
 [  92   59    0   86  114    4    6]
 [  37   10    0   13    1  172    9]
 [  43   10    0   13    2    8  252]]
Micro Precision/Recall/F-score:  (0.7815909331638597, 0.7815909331638597, 0.7815909331638597, None)
Macro Precision/Recall/F-score:  (0.7447208245035538, 0.706279783777458, 0.7227862939504774, None)


epoch 26/40
model.reset
self.reset_num:  26
self.cheat:  True
self.mask_p:  0.75
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.6628535112805847
ex_Confusion Metric: 
 [[2200  473   47 1114   55  273  107]
 [  86 1802   81  176   16   27   50]
 [   3   28  329    2    1    1    2]
 [ 107   98    9 1353   23   24   23]
 [  33   93    6  104   95   12   18]
 [  10   11    2   16    2  178   23]
 [   5    9    0    9    0    4  301]]
np.mean(reliability_np):  0.5704992706228026
np.median(reliability_np):  0.5415630340576172
np.mean(c_reliability_np):  0.6142549060044596
np.median(c_reliability_np):  0.6009221076965332
np.mean(w_reliability_np):  0.45244287571422415
np.median(w_reliability_np):  0.42173466086387634
self.threshold:  0.6009221076965332
Accuracy:  0.7884757970553967
Confusion Metric: 
 [[3687  272    9  198   68   19   16]
 [ 279 1818   24   49   51    9    8]
 [  20   54  285    0    4    1    2]
 [ 412   76    1 1099   41    3    5]
 [  91   72    0   48  144    2    4]
 [  46   13    0    8    2  164    9]
 [  45   14    0    8    5    9  247]]
Micro Precision/Recall/F-score:  (0.7884757970553967, 0.7884757970553967, 0.7884757970553968, None)
Macro Precision/Recall/F-score:  (0.7657200897604687, 0.7079522855524424, 0.7341855795835315, None)


epoch 27/40
model.reset
self.reset_num:  27
self.cheat:  True
self.mask_p:  0.75
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.6913462556932528
ex_Confusion Metric: 
 [[2522  462   41  874   65  226   79]
 [  96 1837   84  143   19   20   39]
 [   3   29  328    2    1    1    2]
 [ 169  119    8 1259   36   28   18]
 [  43   95    6   87  107   10   13]
 [  14   12    2   14    2  178   20]
 [  10    8    0    8    1    5  296]]
np.mean(reliability_np):  0.5670846355594781
np.median(reliability_np):  0.5392926037311554
np.mean(c_reliability_np):  0.6076967343585276
np.median(c_reliability_np):  0.5967690348625183
np.mean(w_reliability_np):  0.43778382174737174
np.median(w_reliability_np):  0.4056975394487381
self.threshold:  0.5967690348625183
Accuracy:  0.7832856688910073
Confusion Metric: 
 [[3371  458   14  311   66   29   20]
 [ 166 1930   32   52   41    6   11]
 [  12   55  294    1    2    1    1]
 [ 271   91    1 1222   42    3    7]
 [  62  103    2   46  143    2    3]
 [  36   14    0   10    1  172    9]
 [  31   14    0   11    3    6  263]]
Micro Precision/Recall/F-score:  (0.7832856688910073, 0.7832856688910073, 0.7832856688910073, None)
Macro Precision/Recall/F-score:  (0.7538678258011365, 0.7300692184051935, 0.7399101476522151, None)


epoch 28/40
model.reset
self.reset_num:  28
self.cheat:  True
self.mask_p:  0.75
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.6734456095752569
ex_Confusion Metric: 
 [[2267  541   53 1008   58  207  135]
 [  64 1857   91  136   15   24   51]
 [   3   28  331    1    0    1    2]
 [ 114  118    9 1319   30   25   22]
 [  33  104    6   87  103    8   20]
 [  11   12    2   14    2  178   23]
 [   3    8    0   10    0    4  303]]
np.mean(reliability_np):  0.5628274283803338
np.median(reliability_np):  0.5327200889587402
np.mean(c_reliability_np):  0.6030263627787625
np.median(c_reliability_np):  0.5857088565826416
np.mean(w_reliability_np):  0.44128337195563
np.median(w_reliability_np):  0.40935030579566956
self.threshold:  0.5857088565826416
Accuracy:  0.7859336934646753
Confusion Metric: 
 [[3720  243    8  178   47   59   14]
 [ 338 1773   20   44   44   12    7]
 [  22   64  275    0    3    1    1]
 [ 423   62    1 1109   30    8    4]
 [ 108   71    1   47  125    7    2]
 [  32    9    0    8    0  185    8]
 [  54   13    0    8    3   17  233]]
Micro Precision/Recall/F-score:  (0.7859336934646753, 0.7859336934646753, 0.7859336934646753, None)
Macro Precision/Recall/F-score:  (0.7549737643662804, 0.7019339418120581, 0.7227428836208716, None)


epoch 29/40
model.reset
self.reset_num:  29
self.cheat:  True
self.mask_p:  0.75
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.6853087596652897
ex_Confusion Metric: 
 [[2506  391   53  801   75  348   95]
 [  98 1786   92  151   23   44   44]
 [   3   29  329    1    0    2    2]
 [ 163  103    7 1244   33   64   23]
 [  37   88    6   80  118   12   20]
 [  10    9    2   10    2  190   19]
 [   6    7    0    8    2    8  297]]
np.mean(reliability_np):  0.5639475838427609
np.median(reliability_np):  0.5358350872993469
np.mean(c_reliability_np):  0.599846510156137
np.median(c_reliability_np):  0.5846866965293884
np.mean(w_reliability_np):  0.4345692521050818
np.median(w_reliability_np):  0.40493306517601013
self.threshold:  0.5846866965293884
Accuracy:  0.7885817180383434
Confusion Metric: 
 [[3631  279    8  274   34   27   16]
 [ 296 1829   10   61   27    6    9]
 [  23   84  252    3    1    2    1]
 [ 345   61    0 1209   15    2    5]
 [ 100   77    1   69  105    5    4]
 [  39   11    0   12    1  170    9]
 [  51   14    0    7    1    6  249]]
Micro Precision/Recall/F-score:  (0.7885817180383434, 0.7885817180383434, 0.7885817180383433, None)
Macro Precision/Recall/F-score:  (0.7794099755096059, 0.6924790199771159, 0.7260833180194174, None)


epoch 30/40
model.reset
self.reset_num:  30
self.cheat:  True
self.mask_p:  0.75
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.6836140239381422
ex_Confusion Metric: 
 [[2386  449   36 1025   59  218   96]
 [  84 1834   66  163   19   26   46]
 [   3   34  324    2    0    1    2]
 [ 124  101    7 1343   23   18   21]
 [  37   97    4  102   94    9   18]
 [  11   11    2   16    2  175   25]
 [   6    8    0   10    1    5  298]]
np.mean(reliability_np):  0.5596321037377762
np.median(reliability_np):  0.5289466381072998
np.mean(c_reliability_np):  0.6037616555027486
np.median(c_reliability_np):  0.5874972343444824
np.mean(w_reliability_np):  0.44520601227126233
np.median(w_reliability_np):  0.4144163727760315
self.threshold:  0.5874972343444824
Accuracy:  0.77576527910179
Confusion Metric: 
 [[3642  192    8  329   56   25   17]
 [ 381 1653   22   96   69    7   10]
 [  27   59  270    2    4    2    2]
 [ 344   40    1 1230   17    1    4]
 [  87   59    2  100  110    2    1]
 [  38   10    0   11    1  174    8]
 [  53    7    1   12    4    6  245]]
Micro Precision/Recall/F-score:  (0.77576527910179, 0.77576527910179, 0.77576527910179, None)
Macro Precision/Recall/F-score:  (0.7530045260198982, 0.6930687289936646, 0.7192607312506751, None)


epoch 31/40
model.reset
self.reset_num:  31
self.cheat:  True
self.mask_p:  0.75
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.6889100730854782
ex_Confusion Metric: 
 [[2481  387   39 1022   60  201   79]
 [ 108 1791   71  186   16   27   39]
 [   3   33  326    1    0    1    2]
 [ 142   94    9 1332   28   18   14]
 [  40   85    6  107  103    8   12]
 [  13   11    2   14    2  178   22]
 [  11    9    0   10    1    4  293]]
np.mean(reliability_np):  0.5606801824780964
np.median(reliability_np):  0.5325197577476501
np.mean(c_reliability_np):  0.5964970018137316
np.median(c_reliability_np):  0.5798964500427246
np.mean(w_reliability_np):  0.44140754821737244
np.median(w_reliability_np):  0.4095975458621979
self.threshold:  0.5798964500427246
Accuracy:  0.7734350174769622
Confusion Metric: 
 [[3704  168    7  326   36   13   15]
 [ 430 1616   11  113   55    5    8]
 [  28   73  251    4    7    2    1]
 [ 352   35    1 1234   12    1    2]
 [ 110   58    0   95   92    3    3]
 [  47   10    1   16    0  161    7]
 [  55    7    0   15    4    3  244]]
Micro Precision/Recall/F-score:  (0.7734350174769622, 0.7734350174769622, 0.7734350174769622, None)
Macro Precision/Recall/F-score:  (0.7700475367928166, 0.6704819190580114, 0.7105245945683087, None)


epoch 32/40
model.reset
self.reset_num:  32
self.cheat:  True
self.mask_p:  0.75
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.6822370511598348
ex_Confusion Metric: 
 [[2418  369   34 1159   47  170   72]
 [ 102 1779   66  213   17   24   37]
 [   3   33  322    4    1    1    2]
 [ 121   90    7 1363   20   18   18]
 [  42   85    6  115   91    9   13]
 [  11    9    2   19    2  179   20]
 [  14    9    0   10    1    5  289]]
np.mean(reliability_np):  0.5674100049519516
np.median(reliability_np):  0.5385794043540955
np.mean(c_reliability_np):  0.6102297124822323
np.median(c_reliability_np):  0.5991983413696289
np.mean(w_reliability_np):  0.45684822460015617
np.median(w_reliability_np):  0.42794470489025116
self.threshold:  0.5991983413696289
Accuracy:  0.7827560639762737
Confusion Metric: 
 [[3586  234   10  327   69   28   15]
 [ 317 1765   20   69   53    7    7]
 [  21   56  277    2    7    2    1]
 [ 304   51    2 1231   44    2    3]
 [  76   73    1   76  131    3    1]
 [  42    9    1   13    2  168    7]
 [  58   11    0   12    4   11  232]]
Micro Precision/Recall/F-score:  (0.7827560639762737, 0.7827560639762737, 0.7827560639762737, None)
Macro Precision/Recall/F-score:  (0.7534393361346948, 0.7002698180728185, 0.7241937597169787, None)


epoch 33/40
model.reset
self.reset_num:  33
self.cheat:  True
self.mask_p:  0.75
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.6685732443597077
ex_Confusion Metric: 
 [[2264  433   49 1097   68  284   74]
 [  87 1798   89  175   20   30   39]
 [   2   30  328    2    1    1    2]
 [ 113  100    7 1343   30   28   16]
 [  31   97    6   99  104   12   12]
 [  12   10    2   11    2  189   16]
 [  10   11    0   12    1    8  286]]
np.mean(reliability_np):  0.5588652847012017
np.median(reliability_np):  0.5269434452056885
np.mean(c_reliability_np):  0.5984966843748991
np.median(c_reliability_np):  0.5790480077266693
np.mean(w_reliability_np):  0.4411670954540234
np.median(w_reliability_np):  0.40790683031082153
self.threshold:  0.5790480077266693
Accuracy:  0.7850863256011016
Confusion Metric: 
 [[3690  229   15  226   68   23   18]
 [ 356 1711   45   57   53    5   11]
 [  14   39  307    0    3    1    2]
 [ 393   49    3 1134   53    2    3]
 [  90   69    2   52  144    3    1]
 [  43    9    1   11    1  171    6]
 [  44    8    1   10    4    6  255]]
Micro Precision/Recall/F-score:  (0.7850863256011016, 0.7850863256011016, 0.7850863256011017, None)
Macro Precision/Recall/F-score:  (0.7574146615881913, 0.7204805602859964, 0.7374465578091186, None)


epoch 34/40
model.reset
self.reset_num:  34
self.cheat:  True
self.mask_p:  0.75
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.6862620485118102
ex_Confusion Metric: 
 [[2469  423   56  997   54  179   91]
 [ 105 1793  106  150   20   23   41]
 [   3   28  331    1    0    1    2]
 [ 137  108   11 1312   32   16   21]
 [  40   96    6   96  103   10   10]
 [  11    9    3   19    2  176   22]
 [   6    9    0   11    1    6  295]]
np.mean(reliability_np):  0.5580370272508053
np.median(reliability_np):  0.5263699889183044
np.mean(c_reliability_np):  0.5977106885508745
np.median(c_reliability_np):  0.5812661051750183
np.mean(w_reliability_np):  0.4409102074635906
np.median(w_reliability_np):  0.409925177693367
self.threshold:  0.5812661051750183
Accuracy:  0.7879461921406631
Confusion Metric: 
 [[3672  264   11  214   60   27   21]
 [ 294 1815   21   56   37    5   10]
 [  15   58  284    1    4    1    3]
 [ 400   76    3 1105   43    5    5]
 [  78   83    2   50  143    3    2]
 [  42   10    1    9    1  171    8]
 [  51    7    0    7    5    9  249]]
Micro Precision/Recall/F-score:  (0.7879461921406631, 0.7879461921406631, 0.7879461921406632, None)
Macro Precision/Recall/F-score:  (0.7624341007439396, 0.7119997016308087, 0.7350041996878455, None)


epoch 35/40
model.reset
self.reset_num:  35
self.cheat:  True
self.mask_p:  0.75
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.6674081135472937
ex_Confusion Metric: 
 [[2255  450   45 1019   56  362   82]
 [  78 1827   80  170   14   33   36]
 [   2   31  328    2    0    1    2]
 [ 120  111    6 1312   28   46   14]
 [  30  104    6   98   98   12   13]
 [  10    8    1   12    2  193   16]
 [   6   10    0   12    1   11  288]]
np.mean(reliability_np):  0.5586458212319201
np.median(reliability_np):  0.5265780985355377
np.mean(c_reliability_np):  0.6029918138691592
np.median(c_reliability_np):  0.5844303965568542
np.mean(w_reliability_np):  0.44283282765347487
np.median(w_reliability_np):  0.41223056614398956
self.threshold:  0.5844303965568542
Accuracy:  0.7625251562334499
Confusion Metric: 
 [[3757  173   13  128   77  101   20]
 [ 465 1591   42   45   65   22    8]
 [  22   36  301    0    2    4    1]
 [ 532   43    3  963   68   23    5]
 [  99   57    3   28  162    9    3]
 [  25    5    3    4    2  197    6]
 [  57    9    1    6    3   24  228]]
Micro Precision/Recall/F-score:  (0.7625251562334499, 0.7625251562334499, 0.76252515623345, None)
Macro Precision/Recall/F-score:  (0.717004086849242, 0.7085098258244814, 0.7029902907759931, None)


epoch 36/40
model.reset
self.reset_num:  36
self.cheat:  True
self.mask_p:  0.75
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.668043639444974
ex_Confusion Metric: 
 [[2313  419   55  920   54  409   99]
 [  83 1794   96  157   16   50   42]
 [   2   25  335    1    0    1    2]
 [ 137  107   11 1284   29   52   17]
 [  39   99    8   86  103   13   13]
 [  11    9    2   11    2  191   16]
 [  10    9    1   10    1   10  287]]
np.mean(reliability_np):  0.5509296337619531
np.median(reliability_np):  0.5174926221370697
np.mean(c_reliability_np):  0.5819259899574923
np.median(c_reliability_np):  0.558159589767456
np.mean(w_reliability_np):  0.42658691637897916
np.median(w_reliability_np):  0.3957526683807373
self.threshold:  0.558159589767456
Accuracy:  0.7865692193623557
Confusion Metric: 
 [[3698  247   12  213   51   22   26]
 [ 315 1804   22   46   31    7   13]
 [  15   57  288    1    1    1    3]
 [ 395   88    3 1101   34    6   10]
 [  92   81    2   58  121    3    4]
 [  50    9    0    6    1  166   10]
 [  39   13    0   10    4   14  248]]
Micro Precision/Recall/F-score:  (0.7865692193623557, 0.7865692193623557, 0.7865692193623556, None)
Macro Precision/Recall/F-score:  (0.7545181563630189, 0.7012867042473945, 0.7243094658389834, None)


epoch 37/40
model.reset
self.reset_num:  37
self.cheat:  True
self.mask_p:  0.75
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.6876390212901176
ex_Confusion Metric: 
 [[2463  421   47  984   56  187  111]
 [  91 1812   90  149   20   27   49]
 [   3   26  332    2    0    1    2]
 [ 154  102   11 1296   29   21   24]
 [  41   92    6   88  110    9   15]
 [  11    9    4   16    2  182   18]
 [   8    8    1    8    1    5  297]]
np.mean(reliability_np):  0.5560349871498701
np.median(reliability_np):  0.5245402753353119
np.mean(c_reliability_np):  0.5951228878120545
np.median(c_reliability_np):  0.5765177011489868
np.mean(w_reliability_np):  0.4386923198489344
np.median(w_reliability_np):  0.40621209144592285
self.threshold:  0.5765177011489868
Accuracy:  0.7841330367545811
Confusion Metric: 
 [[3810  199    9  156   36   32   27]
 [ 394 1723   21   40   39    7   14]
 [  25   55  282    0    1    1    2]
 [ 476   66    2 1055   28    4    6]
 [ 131   68    2   43  106    3    8]
 [  49    9    1    5    1  167   10]
 [  42   12    0    8    1    5  260]]
Micro Precision/Recall/F-score:  (0.7841330367545811, 0.7841330367545811, 0.7841330367545811, None)
Macro Precision/Recall/F-score:  (0.7622710635459623, 0.6933888967792796, 0.7211496749346941, None)


epoch 38/40
model.reset
self.reset_num:  38
self.cheat:  True
self.mask_p:  0.75
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.6817074462451012
ex_Confusion Metric: 
 [[2410  397   38 1073   49  212   90]
 [  96 1806   72  181   21   22   40]
 [   5   28  327    3    0    1    2]
 [ 139   96    5 1336   24   20   17]
 [  45   91    6  100   95   10   14]
 [   9   11    3   18    2  173   26]
 [  14    9    0   12    1    3  289]]
np.mean(reliability_np):  0.5467479953937651
np.median(reliability_np):  0.5130272805690765
np.mean(c_reliability_np):  0.5854073173885689
np.median(c_reliability_np):  0.5627343356609344
np.mean(w_reliability_np):  0.4324945587782614
np.median(w_reliability_np):  0.4057880640029907
self.threshold:  0.5627343356609344
Accuracy:  0.7790488295731385
Confusion Metric: 
 [[3672  229    7  283   57   12    9]
 [ 341 1769    9   63   48    1    7]
 [  24   88  246    0    6    1    1]
 [ 364   63    0 1158   49    1    2]
 [ 104   63    0   62  129    2    1]
 [  59   11    0    7    3  156    6]
 [  64   10    0    9    9   11  225]]
Micro Precision/Recall/F-score:  (0.7790488295731385, 0.7790488295731385, 0.7790488295731385, None)
Macro Precision/Recall/F-score:  (0.7756238664597744, 0.6740085200804083, 0.717001536627885, None)


epoch 39/40
model.reset
self.reset_num:  39
self.cheat:  True
self.mask_p:  0.75
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.6825548141086749
ex_Confusion Metric: 
 [[2433  392   34 1095   50  199   66]
 [ 106 1799   52  203   21   21   36]
 [   5   36  320    2    0    1    2]
 [ 134  102    8 1335   27   18   13]
 [  42   98    5  104   95    8    9]
 [  11   10    2   16    2  184   17]
 [  17   12    0   11    3    7  278]]
np.mean(reliability_np):  0.5532676023296748
np.median(reliability_np):  0.5226210057735443
np.mean(c_reliability_np):  0.5987801156882578
np.median(c_reliability_np):  0.5792084634304047
np.mean(w_reliability_np):  0.4447456261228234
np.median(w_reliability_np):  0.4148179590702057
self.threshold:  0.5792084634304047
Accuracy:  0.7824383010274335
Confusion Metric: 
 [[3584  280    9  275   74   31   16]
 [ 269 1830   15   51   55    8   10]
 [  16   73  271    0    3    2    1]
 [ 351   80    0 1151   46    3    6]
 [  81   68    1   56  147    5    3]
 [  45   11    1   13    2  164    6]
 [  50   11    0    9    8   10  240]]
Micro Precision/Recall/F-score:  (0.7824383010274335, 0.7824383010274335, 0.7824383010274335, None)
Macro Precision/Recall/F-score:  (0.7529948326211329, 0.7024833347400282, 0.7253996429337011, None)
best_epoch:  8 0.7667361261186608 0.8106132824912615


test print 
Accuracy:  0.7482349974785678
Confusion Metric: 
 [[2936  225    3  276   70   14   16]
 [ 243 1353   14   59   48   12    4]
 [  19   72  221    1    6    2    2]
 [ 400   83    2 1040   40    6    6]
 [  95   66    0   55   90    3    7]
 [  53    4    0    9    3  131    7]
 [  34    7    0   23    1    7  164]]
Micro Precision/Recall/F-score:  (0.7482349974785678, 0.7482349974785678, 0.7482349974785677, None)
Macro Precision/Recall/F-score:  (0.7213514206035515, 0.6523388240022892, 0.6823957065609567, None)
test f1:   0.6823957065609567 [0.6823957065609567]
test ass:  0.7482349974785678 [0.7482349974785678]
valid f1:  0.7667361261186608 [0.7667361261186608]
valid acc: 0.8106132824912615 [0.8106132824912615]
