['/home/lizhuoqun/SE_type_code', '/home/lizhuoqun/anconda/envs/py38/lib/python38.zip', '/home/lizhuoqun/anconda/envs/py38/lib/python3.8', '/home/lizhuoqun/anconda/envs/py38/lib/python3.8/lib-dynload', '/home/lizhuoqun/anconda/envs/py38/lib/python3.8/site-packages', '/home/lizhuoqun/SE_type_code/data', '/home/lizhuoqun/SE_type_code/models', '/home/lizhuoqun/SE_type_code/tools', '/home/lizhuoqun/SE_type_code/resource', '/home/lizhuoqun/SE_type_code/pre_train']
sentence level BiLSTM extra
___________****************************************** 300 ********************************************************************************
paragraph level BiLSTM label embedding MLP pre
Namespace(BATCH_SIZE=128, DROPOUT=0.5, EPOCHs=40, LEARN_RATE=0.001, WEIGHT_DECAY=0.0001, cheat='True', fold_num=0, mask_p=0.5)




time= 0
self.BiLSTM_1_require_grad:  True
self.cheat:  True
self.mask_p:  0.5
self.threshold:  0.8
start to get stanford
already get stanford
start get bert_tokenizer
get bert tokenizer
if_do_embedding:  True
start read data catalogue
start get train data
already deal 10 file
already deal 20 file
already deal 30 file
already deal 40 file
already deal 50 file
already deal 60 file
already deal 70 file
already deal 80 file
already deal 90 file
already deal 100 file
already deal 110 file
already deal 120 file
already deal 130 file
already deal 140 file
already deal 150 file
already deal 160 file
already deal 170 file
already deal 180 file
already deal 190 file
already deal 200 file
already deal 210 file
already deal 220 file
already deal 230 file
already deal 240 file
already deal 250 file
already deal 260 file
already deal 270 file
already deal 280 file
len(train_valid_data_list):  3368
already deal 10 file
already deal 20 file
already deal 30 file
already deal 40 file
already deal 50 file
already deal 60 file
already deal 70 file
already deal 80 file
complete get data, len(test_data_list):  919


start sentence level BiLSTM  extra


epoch 0/4


epoch 1/4


epoch 2/4


epoch 3/4
sentence level BiLSTM  extra best_epoch:  3 -1 -1
sentence level BiLSTM  extra end

********************************************


epoch 0/40
model.reset
self.reset_num:  0
self.cheat:  True
self.mask_p:  0.5
self.valid_flag:  False
self.BiLSTM_1_require_grad:  True
Accuracy:  0.8136986301369863
Confusion Metric: 
 [[3806  106   10  240   41  162   11]
 [ 292 1622   33   93   60   27   12]
 [  13    8  243    2    5   10    3]
 [ 196   23    1 1519   14   26    2]
 [ 111   22    1   69  157   19    5]
 [  16    3    0    4    0  154    1]
 [  13    3    0   21    2   88  221]]
Micro Precision/Recall/F-score:  (0.8136986301369863, 0.8136986301369863, 0.8136986301369863, None)
Macro Precision/Recall/F-score:  (0.7333302283070715, 0.7493782775297076, 0.7176913256624288, None)


epoch 1/40
model.reset
self.reset_num:  1
self.cheat:  True
self.mask_p:  0.5
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.7317175974710222
ex_Confusion Metric: 
 [[3081  313   39  660   49  154   80]
 [ 161 1702   78  129   21   18   30]
 [   3   13  266    0    0    0    2]
 [ 261   99   10 1319   49   21   22]
 [  74   63    5   89  135    2   16]
 [  16    4    3    4    1  137   13]
 [  14    7    1   16    2    4  304]]
np.mean(reliability_np):  0.7688872856788204
np.median(reliability_np):  0.8261343240737915
np.mean(c_reliability_np):  0.804372232033944
np.median(c_reliability_np):  0.876556783914566
np.mean(w_reliability_np):  0.608906354693709
np.median(w_reliability_np):  0.5863029956817627
self.threshold:  0.876556783914566
Accuracy:  0.8483667017913593
Confusion Metric: 
 [[3925  147    4  178   38   75    9]
 [ 215 1796   10   55   48   12    3]
 [  12   26  239    0    2    3    2]
 [ 213   24    0 1515   16   12    1]
 [ 126   34    0   48  170    4    2]
 [  14    6    2    4    0  148    4]
 [  32   13    0   14    1   30  258]]
Micro Precision/Recall/F-score:  (0.8483667017913593, 0.8483667017913593, 0.8483667017913593, None)
Macro Precision/Recall/F-score:  (0.7970550030240696, 0.7777608364044786, 0.7783280829475219, None)


epoch 2/40
model.reset
self.reset_num:  2
self.cheat:  True
self.mask_p:  0.5
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.7475237091675447
ex_Confusion Metric: 
 [[3211  269   23  652  108   71   42]
 [ 182 1696   44  119   67   15   16]
 [   3   22  256    0    1    0    2]
 [ 271   70    8 1343   66   10   13]
 [  75   46    0   84  168    2    9]
 [  18    6    3    6    5  129   11]
 [  23    5    1   17    6    5  291]]
np.mean(reliability_np):  0.7583256941050578
np.median(reliability_np):  0.8095455765724182
np.mean(c_reliability_np):  0.7992844512580581
np.median(c_reliability_np):  0.8636118173599243
np.mean(w_reliability_np):  0.6061638570911498
np.median(w_reliability_np):  0.5836100280284882
self.threshold:  0.8636118173599243
Accuracy:  0.8442571127502634
Confusion Metric: 
 [[3925   82   12  215   76   54   12]
 [ 293 1638   19   76   97    8    8]
 [  10   18  250    0    2    2    2]
 [ 188   11    0 1532   41    4    5]
 [  72   13    1   47  247    1    3]
 [  16    3    2    4    4  147    2]
 [  39    2    0    6    4   24  273]]
Micro Precision/Recall/F-score:  (0.8442571127502634, 0.8442571127502634, 0.8442571127502634, None)
Macro Precision/Recall/F-score:  (0.7883049798300537, 0.808106208563536, 0.7933332328986672, None)


epoch 3/40
model.reset
self.reset_num:  3
self.cheat:  True
self.mask_p:  0.5
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.730663856691254
ex_Confusion Metric: 
 [[3057  236   25  755  184   70   49]
 [ 204 1621   54  126   95   16   23]
 [   4   16  260    0    1    0    3]
 [ 228   75    8 1371   79    9   11]
 [  54   41    0   83  198    1    7]
 [  16    4    3    6    7  131   11]
 [  16    4    1   20    6    5  296]]
np.mean(reliability_np):  0.7361499552619409
np.median(reliability_np):  0.7708006799221039
np.mean(c_reliability_np):  0.7688843579922556
np.median(c_reliability_np):  0.8165552616119385
np.mean(w_reliability_np):  0.576510314924383
np.median(w_reliability_np):  0.5519673824310303
self.threshold:  0.8165552616119385
Accuracy:  0.8331928345626975
Confusion Metric: 
 [[3847   80    7  281   62   93    6]
 [ 351 1565   31   92   80   14    6]
 [  13   10  247    0    7    5    2]
 [ 140   12    0 1588   29   11    1]
 [  80   11    0   42  245    4    2]
 [  15    0    2    4    1  151    5]
 [  23    2    0   11    3   45  264]]
Micro Precision/Recall/F-score:  (0.8331928345626975, 0.8331928345626975, 0.8331928345626975, None)
Macro Precision/Recall/F-score:  (0.7720358838841836, 0.8024388575031856, 0.7757727053241155, None)


epoch 4/40
model.reset
self.reset_num:  4
self.cheat:  True
self.mask_p:  0.5
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.7258166491043203
ex_Confusion Metric: 
 [[3001  255   31  817   81  146   45]
 [ 202 1649   55  137   51   20   25]
 [   4   16  258    0    1    2    3]
 [ 214   87    7 1377   66   20   10]
 [  67   44    1   88  174    2    8]
 [  14    4    3    5    2  141    9]
 [  13    5    1   24    4   13  288]]
np.mean(reliability_np):  0.7246215268860675
np.median(reliability_np):  0.7538829743862152
np.mean(c_reliability_np):  0.7671335646504067
np.median(c_reliability_np):  0.8162992596626282
np.mean(w_reliability_np):  0.578054457095428
np.median(w_reliability_np):  0.5545265972614288
self.threshold:  0.8162992596626282
Accuracy:  0.8418335089567967
Confusion Metric: 
 [[3930   81   14  218   92   27   14]
 [ 302 1570   14   86  155    5    7]
 [  10   19  246    0    5    0    4]
 [ 174    9    0 1551   39    5    3]
 [  73    8    0   43  257    2    1]
 [  23    4    2    3    2  139    5]
 [  36    0    0    3    7    6  296]]
Micro Precision/Recall/F-score:  (0.8418335089567967, 0.8418335089567967, 0.8418335089567967, None)
Macro Precision/Recall/F-score:  (0.8017529755810929, 0.8099812795662281, 0.8011880472916563, None)


epoch 5/40
model.reset
self.reset_num:  5
self.cheat:  True
self.mask_p:  0.5
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.7297154899894626
ex_Confusion Metric: 
 [[3013  259   33  759  140  127   45]
 [ 178 1650   46  144   81   19   21]
 [   3   16  261    0    1    0    3]
 [ 216   70    6 1374   91   14   10]
 [  63   38    0   79  195    2    7]
 [  13    4    3    4    3  140   11]
 [  20    4    1   18   10    3  292]]
np.mean(reliability_np):  0.7095228391997158
np.median(reliability_np):  0.7329730987548828
np.mean(c_reliability_np):  0.7432811614429907
np.median(c_reliability_np):  0.7843865752220154
np.mean(w_reliability_np):  0.5539279639314257
np.median(w_reliability_np):  0.528621256351471
self.threshold:  0.7843865752220154
Accuracy:  0.8363540569020022
Confusion Metric: 
 [[3990   77   11  149   83   52   14]
 [ 358 1546   27   62  128    9    9]
 [  13    8  256    1    3    0    3]
 [ 235   16    0 1476   47    7    0]
 [  97   11    0   28  247    0    1]
 [  17    2    2    1    1  149    6]
 [  29    4    1    5    4   32  273]]
Micro Precision/Recall/F-score:  (0.8363540569020022, 0.8363540569020022, 0.8363540569020022, None)
Macro Precision/Recall/F-score:  (0.780309136359328, 0.8042151658636785, 0.7851353003130094, None)


epoch 6/40
model.reset
self.reset_num:  6
self.cheat:  True
self.mask_p:  0.5
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.729504741833509
ex_Confusion Metric: 
 [[3006  272   32  743  142  132   49]
 [ 179 1670   46  132   72   15   25]
 [   3   19  258    0    1    0    3]
 [ 236   76    6 1337   98   17   11]
 [  51   44    0   71  209    2    7]
 [  11    7    3    4    2  142    9]
 [  14    4    1   15    7    6  301]]
np.mean(reliability_np):  0.695541802583278
np.median(reliability_np):  0.7127003967761993
np.mean(c_reliability_np):  0.7336191412071676
np.median(c_reliability_np):  0.7688882350921631
np.mean(w_reliability_np):  0.5464443007261316
np.median(w_reliability_np):  0.5154629349708557
self.threshold:  0.7688882350921631
Accuracy:  0.8343519494204426
Confusion Metric: 
 [[3881  103    5  270   42   52   23]
 [ 382 1561   15   99   65    9    8]
 [   5   21  248    0    6    1    3]
 [ 143   13    0 1590   25    9    1]
 [  91   13    0   69  207    0    4]
 [  15    4    1    3    3  148    4]
 [  28    5    1    8    2   21  283]]
Micro Precision/Recall/F-score:  (0.8343519494204426, 0.8343519494204426, 0.8343519494204426, None)
Macro Precision/Recall/F-score:  (0.7908527804102482, 0.7952001641523642, 0.7883995117109676, None)


epoch 7/40
model.reset
self.reset_num:  7
self.cheat:  True
self.mask_p:  0.5
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.7216016859852477
ex_Confusion Metric: 
 [[2908  266   39  874  107  115   67]
 [ 177 1649   45  168   54   17   29]
 [   2   17  259    1    1    1    3]
 [ 196   71    7 1412   72   13   10]
 [  60   43    1   87  181    3    9]
 [  13    6    3    5    3  136   12]
 [  15    6    1   15    5    3  303]]
np.mean(reliability_np):  0.684652230437107
np.median(reliability_np):  0.6967371106147766
np.mean(c_reliability_np):  0.7116783903889949
np.median(c_reliability_np):  0.7390828430652618
np.mean(w_reliability_np):  0.5305246535595577
np.median(w_reliability_np):  0.5048502087593079
self.threshold:  0.7390828430652618
Accuracy:  0.8290832455216017
Confusion Metric: 
 [[3759  144   10  267   64  119   13]
 [ 276 1710   20   59   52   19    3]
 [   4   20  252    1    3    1    3]
 [ 179   26    1 1523   32   19    1]
 [ 103   20    0   39  215    5    2]
 [  14    3    3    6    3  149    0]
 [  18    7    1    9    3   50  260]]
Micro Precision/Recall/F-score:  (0.8290832455216017, 0.8290832455216017, 0.8290832455216017, None)
Macro Precision/Recall/F-score:  (0.7627202143603672, 0.7921435821597894, 0.765293776618843, None)


epoch 8/40
model.reset
self.reset_num:  8
self.cheat:  True
self.mask_p:  0.5
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.6993677555321391
ex_Confusion Metric: 
 [[2692  361   47  796  122  299   59]
 [ 114 1724   49  154   37   32   29]
 [   2   17  259    1    1    1    3]
 [ 206   91   11 1329   76   50   18]
 [  46   54    2   70  191    8   13]
 [   7    8    3    4    2  144   10]
 [  10    6    1   10    7   16  298]]
np.mean(reliability_np):  0.6691747470042758
np.median(reliability_np):  0.6747991740703583
np.mean(c_reliability_np):  0.7135912869437121
np.median(c_reliability_np):  0.7476539015769958
np.mean(w_reliability_np):  0.5276947079825058
np.median(w_reliability_np):  0.49255797266960144
self.threshold:  0.7476539015769958
Accuracy:  0.8436248682824026
Confusion Metric: 
 [[3806  175   19  220   37   66   53]
 [ 222 1763   25   58   46   14   11]
 [   6   17  256    0    1    1    3]
 [ 187   24    1 1538   16    8    7]
 [  72   42    2   65  183    8   12]
 [  18    3    2    2    0  148    5]
 [  14    2    0    3    2   15  312]]
Micro Precision/Recall/F-score:  (0.8436248682824026, 0.8436248682824026, 0.8436248682824026, None)
Macro Precision/Recall/F-score:  (0.7700777010599833, 0.809072018451844, 0.7833285454920932, None)


epoch 9/40
model.reset
self.reset_num:  9
self.cheat:  True
self.mask_p:  0.5
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.7022128556375131
ex_Confusion Metric: 
 [[2690  333   53  871   78  236  115]
 [ 111 1693   67  160   31   31   46]
 [   1   16  262    0    1    1    3]
 [ 170   83   11 1412   44   29   32]
 [  52   58    3   97  150    8   16]
 [   9    6    3    4    2  140   14]
 [   9    4    1    9    4    4  317]]
np.mean(reliability_np):  0.6578886683748618
np.median(reliability_np):  0.6601147055625916
np.mean(c_reliability_np):  0.6960969277057184
np.median(c_reliability_np):  0.7222306132316589
np.mean(w_reliability_np):  0.509122240405216
np.median(w_reliability_np):  0.4760269969701767
self.threshold:  0.7222306132316589
Accuracy:  0.843940990516333
Confusion Metric: 
 [[3798  148   13  300   49   59    9]
 [ 220 1734   25   91   49   14    6]
 [   8   19  253    1    0    0    3]
 [ 147   23    1 1583   24    3    0]
 [  64   30    0   55  227    6    2]
 [  17    3    1    5    1  148    3]
 [  29    7    0   14    2   30  266]]
Micro Precision/Recall/F-score:  (0.843940990516333, 0.843940990516333, 0.843940990516333, None)
Macro Precision/Recall/F-score:  (0.7914627493572545, 0.8064601410631561, 0.7934094416986875, None)


epoch 10/40
model.reset
self.reset_num:  10
self.cheat:  True
self.mask_p:  0.5
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.7024236037934668
ex_Confusion Metric: 
 [[2731  275   49 1030   79  146   66]
 [ 152 1612   58  202   51   25   39]
 [   3   15  259    1    1    2    3]
 [ 158   65    8 1469   52   13   16]
 [  58   42    3  110  156    4   11]
 [  13    4    2    6    4  138   11]
 [  16    5    1   19    3    3  301]]
np.mean(reliability_np):  0.6588876262610162
np.median(reliability_np):  0.661311686038971
np.mean(c_reliability_np):  0.7058853553694682
np.median(c_reliability_np):  0.7338587641716003
np.mean(w_reliability_np):  0.5226290615396865
np.median(w_reliability_np):  0.49321354925632477
self.threshold:  0.7338587641716003
Accuracy:  0.8471022128556375
Confusion Metric: 
 [[3774  198   16  234   37   77   40]
 [ 187 1812   25   60   26   14   15]
 [   4   17  260    0    0    0    3]
 [ 170   31    0 1538   25   10    7]
 [  86   40    0   47  194    5   12]
 [  13    4    2    1    1  149    8]
 [  16    4    0    1    2   13  312]]
Micro Precision/Recall/F-score:  (0.8471022128556375, 0.8471022128556375, 0.8471022128556375, None)
Macro Precision/Recall/F-score:  (0.7781001378913961, 0.8182068190993217, 0.7914704460548261, None)


epoch 11/40
model.reset
self.reset_num:  11
self.cheat:  True
self.mask_p:  0.5
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.7124341412012645
ex_Confusion Metric: 
 [[2808  351   52  796   76  181  112]
 [ 107 1722   74  135   29   24   48]
 [   2   16  261    0    1    1    3]
 [ 198   87   11 1374   60   21   30]
 [  57   65    2   88  150    6   16]
 [  10    7    3    5    2  131   20]
 [  12    5    1    9    4    2  315]]
np.mean(reliability_np):  0.6531804400008241
np.median(reliability_np):  0.6533811986446381
np.mean(c_reliability_np):  0.6801861485328887
np.median(c_reliability_np):  0.6931634545326233
np.mean(w_reliability_np):  0.49779739670152406
np.median(w_reliability_np):  0.4675460159778595
self.threshold:  0.6931634545326233
Accuracy:  0.8396206533192835
Confusion Metric: 
 [[3875  166   16  239   18   37   25]
 [ 288 1721   14   70   29    7   10]
 [  13   19  247    0    0    2    3]
 [ 190   25    0 1532   27    4    3]
 [ 114   32    0   65  162    1   10]
 [  29    5    1    2    1  136    4]
 [  33    6    1    3    0   10  295]]
Micro Precision/Recall/F-score:  (0.8396206533192835, 0.8396206533192835, 0.8396206533192835, None)
Macro Precision/Recall/F-score:  (0.8041025978228209, 0.7790891100381451, 0.7865110151875533, None)


epoch 12/40
model.reset
self.reset_num:  12
self.cheat:  True
self.mask_p:  0.5
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.7103266596417281
ex_Confusion Metric: 
 [[2740  351   51  875   58  211   90]
 [ 110 1748   52  143   20   27   39]
 [   2   19  258    0    1    1    3]
 [ 178   87   10 1420   38   23   25]
 [  69   69    3  102  121    4   16]
 [   9    8    3    4    2  138   14]
 [  11    5    1    9    3    3  316]]
np.mean(reliability_np):  0.6445963332087299
np.median(reliability_np):  0.6417140960693359
np.mean(c_reliability_np):  0.6733877737339801
np.median(c_reliability_np):  0.6840505599975586
np.mean(w_reliability_np):  0.5058722630679803
np.median(w_reliability_np):  0.47657454013824463
self.threshold:  0.6840505599975586
Accuracy:  0.8279241306638567
Confusion Metric: 
 [[3591  266   14  388   47   54   16]
 [ 173 1835   18   71   31    7    4]
 [   4   24  251    0    1    1    3]
 [ 130   42    2 1570   27    8    2]
 [  71   44    0   72  192    0    5]
 [  22    6    1    2    2  139    6]
 [  24   16    1   12    5   11  279]]
Micro Precision/Recall/F-score:  (0.8279241306638567, 0.8279241306638567, 0.8279241306638567, None)
Macro Precision/Recall/F-score:  (0.782868909493161, 0.7894918582042642, 0.7825592696344812, None)


epoch 13/40
model.reset
self.reset_num:  13
self.cheat:  True
self.mask_p:  0.5
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.6922023182297155
ex_Confusion Metric: 
 [[2518  449   45 1024  105  163   72]
 [  92 1795   49  128   29   18   28]
 [   2   22  255    0    1    1    3]
 [ 160  115   11 1417   50   11   17]
 [  57   74    3   95  141    4   10]
 [   8    9    3    6    2  137   13]
 [   9    9    1   16    5    2  306]]
np.mean(reliability_np):  0.6343194988764742
np.median(reliability_np):  0.6248475909233093
np.mean(c_reliability_np):  0.662311830244701
np.median(c_reliability_np):  0.6641292572021484
np.mean(w_reliability_np):  0.4945796641563561
np.median(w_reliability_np):  0.46738576889038086
self.threshold:  0.6641292572021484
Accuracy:  0.8231822971548999
Confusion Metric: 
 [[3522  341   13  356   74   32   38]
 [ 146 1874   14   59   35    4    7]
 [   6   33  240    0    1    1    3]
 [ 136   37    1 1561   39    4    3]
 [  65   44    0   68  198    1    8]
 [  27   11    1    6    3  121    9]
 [  19   16    0   10    2    5  296]]
Micro Precision/Recall/F-score:  (0.8231822971548999, 0.8231822971548999, 0.8231822971548999, None)
Macro Precision/Recall/F-score:  (0.7770773444792612, 0.7783534637182842, 0.7760749941046212, None)


epoch 14/40
model.reset
self.reset_num:  14
self.cheat:  True
self.mask_p:  0.5
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.6971548998946259
ex_Confusion Metric: 
 [[2578  464   49  911  109  150  115]
 [  79 1800   46  126   32   20   36]
 [   1   21  257    1    1    0    3]
 [ 174  105   11 1384   70   15   22]
 [  52   78    3   79  154    4   14]
 [  10   10    3    4    2  131   18]
 [  10    8    1   10    6    1  312]]
np.mean(reliability_np):  0.6249197406312602
np.median(reliability_np):  0.6130021810531616
np.mean(c_reliability_np):  0.6522658883065814
np.median(c_reliability_np):  0.6528458595275879
np.mean(w_reliability_np):  0.47729279746923003
np.median(w_reliability_np):  0.4444267600774765
self.threshold:  0.6528458595275879
Accuracy:  0.8255005268703899
Confusion Metric: 
 [[3745  266   24  201   63   54   23]
 [ 209 1763   49   56   46    7    9]
 [   2   14  264    0    0    1    3]
 [ 233   38    1 1458   40    9    2]
 [  93   43    4   48  186    2    8]
 [  24    7    3    4    3  131    6]
 [  29   11    2    2    3   14  287]]
Micro Precision/Recall/F-score:  (0.8255005268703899, 0.8255005268703899, 0.8255005268703899, None)
Macro Precision/Recall/F-score:  (0.7524924054556535, 0.7818975269733125, 0.7647287890498359, None)


epoch 15/40
model.reset
self.reset_num:  15
self.cheat:  True
self.mask_p:  0.5
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.7067439409905163
ex_Confusion Metric: 
 [[2740  358   57  800   77  255   89]
 [ 110 1738   65  136   21   31   38]
 [   1   13  265    0    1    1    3]
 [ 187   96   13 1373   57   27   28]
 [  61   74    5   84  140    5   15]
 [   8    7    3    3    2  140   15]
 [  12    5    2    9    5    4  311]]
np.mean(reliability_np):  0.6172005826026531
np.median(reliability_np):  0.6044975519180298
np.mean(c_reliability_np):  0.6496064614321838
np.median(c_reliability_np):  0.6496256589889526
np.mean(w_reliability_np):  0.47978068554075853
np.median(w_reliability_np):  0.44814008474349976
self.threshold:  0.6496256589889526
Accuracy:  0.8199157007376185
Confusion Metric: 
 [[3439  377   13  423   19   64   41]
 [ 124 1908   13   67    7   12    8]
 [   5   30  245    0    1    0    3]
 [ 121   36    0 1608    9    6    1]
 [  74   69    0   90  140    0   11]
 [  21   10    1    3    0  134    9]
 [  13    7    2    9    2    8  307]]
Micro Precision/Recall/F-score:  (0.8199157007376185, 0.8199157007376185, 0.8199157007376184, None)
Macro Precision/Recall/F-score:  (0.7866200601840109, 0.7775712814412253, 0.7671049802855734, None)


epoch 16/40
model.reset
self.reset_num:  16
self.cheat:  True
self.mask_p:  0.5
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.6545837723919916
ex_Confusion Metric: 
 [[2154  453   39 1273   35  340   82]
 [  53 1781   41  179    6   40   39]
 [   1   28  251    0    0    1    3]
 [  99   98    9 1501   22   32   20]
 [  40   89    2  154   78    7   14]
 [   4    8    2    7    2  142   13]
 [   6    9    1   18    1    8  305]]
np.mean(reliability_np):  0.6152050065834419
np.median(reliability_np):  0.5999180972576141
np.mean(c_reliability_np):  0.6713877305968953
np.median(c_reliability_np):  0.6854442656040192
np.mean(w_reliability_np):  0.5005887396829095
np.median(w_reliability_np):  0.4682907909154892
self.threshold:  0.6854442656040192
Accuracy:  0.820758693361433
Confusion Metric: 
 [[3682  328   12  266    7   53   28]
 [ 193 1859    9   57    2   11    8]
 [   7   52  221    0    0    1    3]
 [ 185   45    1 1529   10    6    5]
 [ 107  105    0   89   76    3    4]
 [  25    7    1    3    0  137    5]
 [  25   12    0    7    1   18  285]]
Micro Precision/Recall/F-score:  (0.820758693361433, 0.820758693361433, 0.820758693361433, None)
Macro Precision/Recall/F-score:  (0.7951784503041479, 0.7333894234060505, 0.7358958836604603, None)


epoch 17/40
model.reset
self.reset_num:  17
self.cheat:  True
self.mask_p:  0.5
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.6816649104320337
ex_Confusion Metric: 
 [[2399  477   38 1057   28  286   91]
 [  74 1838   46  117    4   27   33]
 [   2   25  253    0    0    1    3]
 [ 125  123   10 1456   20   25   22]
 [  66  104    3  116   74    7   14]
 [   6    8    2    5    1  143   13]
 [   6   12    1   16    2    5  306]]
np.mean(reliability_np):  0.6182847384090808
np.median(reliability_np):  0.6045494079589844
np.mean(c_reliability_np):  0.6584495701014416
np.median(c_reliability_np):  0.659973680973053
np.mean(w_reliability_np):  0.4913715120874782
np.median(w_reliability_np):  0.4627058506011963
self.threshold:  0.659973680973053
Accuracy:  0.8172813487881981
Confusion Metric: 
 [[3643  310   13  299   25   58   28]
 [ 189 1819   26   80   16    6    3]
 [   4   29  247    0    1    1    2]
 [ 208   34    2 1497   30    8    2]
 [ 107   70    0   70  126    4    7]
 [  19    9    1    3    2  138    6]
 [  27   17    2    8    3    5  286]]
Micro Precision/Recall/F-score:  (0.8172813487881981, 0.8172813487881981, 0.8172813487881981, None)
Macro Precision/Recall/F-score:  (0.7687159772116839, 0.7597707319694823, 0.7561750078765747, None)


epoch 18/40
model.reset
self.reset_num:  18
self.cheat:  True
self.mask_p:  0.5
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.6748155953635405
ex_Confusion Metric: 
 [[2352  429   49 1087   69  304   86]
 [  70 1769   55  164   20   32   29]
 [   1   22  257    0    1    0    3]
 [ 128   89   10 1466   44   25   19]
 [  53   84    2  113  114    6   12]
 [   6   10    3    4    1  141   13]
 [   4   10    2   14    5    8  305]]
np.mean(reliability_np):  0.6085849087465358
np.median(reliability_np):  0.5921664237976074
np.mean(c_reliability_np):  0.6407646432933138
np.median(c_reliability_np):  0.6347468495368958
np.mean(w_reliability_np):  0.4768439427365827
np.median(w_reliability_np):  0.44611693918704987
self.threshold:  0.6347468495368958
Accuracy:  0.81159114857745
Confusion Metric: 
 [[3856  176   14  248   34   34   14]
 [ 321 1656   25   75   56    4    2]
 [   8   24  247    0    1    1    3]
 [ 298   27    3 1417   30    6    0]
 [ 123   44    0   73  137    5    2]
 [  37    7    2    3    2  123    4]
 [  45    9    1    5    3   19  266]]
Micro Precision/Recall/F-score:  (0.81159114857745, 0.81159114857745, 0.81159114857745, None)
Macro Precision/Recall/F-score:  (0.76778243608583, 0.7332645999806193, 0.7467911767932177, None)


epoch 19/40
model.reset
self.reset_num:  19
self.cheat:  True
self.mask_p:  0.5
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.7030558482613277
ex_Confusion Metric: 
 [[2687  334   50  974   69  185   77]
 [ 110 1732   59  147   31   29   31]
 [   2   18  260    0    1    0    3]
 [ 163   87   13 1430   47   22   19]
 [  66   71    3  107  121    5   11]
 [  11    6    3    5    2  139   12]
 [  11    8    2   14    6    4  303]]
np.mean(reliability_np):  0.6037233764019726
np.median(reliability_np):  0.5861969888210297
np.mean(c_reliability_np):  0.6338769777899058
np.median(c_reliability_np):  0.6303224861621857
np.mean(w_reliability_np):  0.4725321416337918
np.median(w_reliability_np):  0.4475695341825485
self.threshold:  0.6303224861621857
Accuracy:  0.8085353003161222
Confusion Metric: 
 [[3832  179   17  266   16   33   33]
 [ 323 1641   30   96   36    4    9]
 [  13   20  245    0    1    2    3]
 [ 288   19    2 1433   31    4    4]
 [ 151   51    0   74   97    3    8]
 [  35    4    1    1    3  127    7]
 [  37    8    0    1    2    2  298]]
Micro Precision/Recall/F-score:  (0.8085353003161222, 0.8085353003161222, 0.8085353003161222, None)
Macro Precision/Recall/F-score:  (0.7628013836553146, 0.7332222637678179, 0.7407078493995243, None)


epoch 20/40
model.reset
self.reset_num:  20
self.cheat:  True
self.mask_p:  0.5
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.7065331928345627
ex_Confusion Metric: 
 [[2755  317   47  899   67  199   92]
 [ 116 1716   53  154   31   29   40]
 [   5   19  255    0    1    1    3]
 [ 182   86   11 1408   47   25   22]
 [  79   70    2   93  122    5   13]
 [  10    6    3    5    2  138   14]
 [  11    6    1   12    4    3  311]]
np.mean(reliability_np):  0.5976317802286026
np.median(reliability_np):  0.5789349973201752
np.mean(c_reliability_np):  0.6288044655194129
np.median(c_reliability_np):  0.6254281997680664
np.mean(w_reliability_np):  0.47039989496261897
np.median(w_reliability_np):  0.44211655855178833
self.threshold:  0.6254281997680664
Accuracy:  0.8130663856691254
Confusion Metric: 
 [[3865  222    8  212   49    7   13]
 [ 297 1728   11   59   40    1    3]
 [  10   48  223    0    1    0    2]
 [ 299   32    2 1393   51    3    1]
 [ 141   53    0   39  146    1    4]
 [  55   10    2    4    3   95    9]
 [  51   19    1    7    3    1  266]]
Micro Precision/Recall/F-score:  (0.8130663856691254, 0.8130663856691254, 0.8130663856691255, None)
Macro Precision/Recall/F-score:  (0.8033540370766505, 0.7052458533036781, 0.7456056165373798, None)


epoch 21/40
model.reset
self.reset_num:  21
self.cheat:  True
self.mask_p:  0.5
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.7106427818756585
ex_Confusion Metric: 
 [[2768  346   43  921   94  110   94]
 [ 113 1760   46  134   32   20   34]
 [   1   24  255    0    1    0    3]
 [ 203   87   11 1382   63   14   21]
 [  71   75    2   80  142    3   11]
 [  14    7    3    5    2  128   19]
 [  12   10    1    9    5    2  309]]
np.mean(reliability_np):  0.5947059050658676
np.median(reliability_np):  0.5747507810592651
np.mean(c_reliability_np):  0.6242341522463241
np.median(c_reliability_np):  0.618666023015976
np.mean(w_reliability_np):  0.4648198870275894
np.median(w_reliability_np):  0.44133447110652924
self.threshold:  0.618666023015976
Accuracy:  0.815595363540569
Confusion Metric: 
 [[3758  213   13  301   51   17   23]
 [ 271 1712   11   94   44    3    4]
 [  10   34  237    0    1    0    2]
 [ 216   31    1 1478   50    3    2]
 [ 113   48    0   71  145    2    5]
 [  26    6    2    7    4  125    8]
 [  34   15    1    7    4    2  285]]
Micro Precision/Recall/F-score:  (0.815595363540569, 0.815595363540569, 0.815595363540569, None)
Macro Precision/Recall/F-score:  (0.786133272292499, 0.7460491314139107, 0.7639179925665892, None)


epoch 22/40
model.reset
self.reset_num:  22
self.cheat:  True
self.mask_p:  0.5
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.7073761854583772
ex_Confusion Metric: 
 [[2742  368   47  892   95  147   85]
 [ 111 1756   50  127   38   23   34]
 [   1   20  259    0    1    0    3]
 [ 192   97   10 1378   67   16   21]
 [  70   76    3   84  138    4    9]
 [   9    7    3    5    2  136   16]
 [  12   11    2   11    6    2  304]]
np.mean(reliability_np):  0.5879854172818353
np.median(reliability_np):  0.5665629208087921
np.mean(c_reliability_np):  0.6191633462830413
np.median(c_reliability_np):  0.6116006374359131
np.mean(w_reliability_np):  0.4590979032929441
np.median(w_reliability_np):  0.4326297640800476
self.threshold:  0.6116006374359131
Accuracy:  0.8133825079030559
Confusion Metric: 
 [[3710  317   12  167  123   16   31]
 [ 168 1815   19   36   97    2    2]
 [   4   39  237    0    2    0    2]
 [ 302   61    2 1328   81    3    4]
 [  80   44    1   27  226    0    6]
 [  34    8    1    5    6  117    7]
 [  30   24    1    3    3    1  286]]
Micro Precision/Recall/F-score:  (0.8133825079030559, 0.8133825079030559, 0.8133825079030559, None)
Macro Precision/Recall/F-score:  (0.7811015909189374, 0.7634533195984395, 0.7679320498814575, None)


epoch 23/40
model.reset
self.reset_num:  23
self.cheat:  True
self.mask_p:  0.5
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.7026343519494205
ex_Confusion Metric: 
 [[2721  427   60  740  133  190  105]
 [  86 1753   72  119   45   26   38]
 [   3   15  262    0    1    0    3]
 [ 207  108   15 1320   81   23   27]
 [  54   78    4   66  166    3   13]
 [  10    7    3    4    2  135   17]
 [  10   11    1    9    5    1  311]]
np.mean(reliability_np):  0.5852762328298202
np.median(reliability_np):  0.5643838942050934
np.mean(c_reliability_np):  0.6119850006537768
np.median(c_reliability_np):  0.6010852158069611
np.mean(w_reliability_np):  0.4443958608247472
np.median(w_reliability_np):  0.41546666622161865
self.threshold:  0.6010852158069611
Accuracy:  0.8095890410958904
Confusion Metric: 
 [[3759  297    6  227   71    8    8]
 [ 201 1814    6   53   62    1    2]
 [  11   74  193    0    4    0    2]
 [ 311   47    0 1354   64    3    2]
 [  88   53    0   38  202    0    3]
 [  52    8    0    5    5  102    6]
 [  43   26    0    9    7    4  259]]
Micro Precision/Recall/F-score:  (0.8095890410958904, 0.8095890410958904, 0.8095890410958902, None)
Macro Precision/Recall/F-score:  (0.8054651631422699, 0.7128880374937128, 0.7502374853053199, None)


epoch 24/40
model.reset
self.reset_num:  24
self.cheat:  True
self.mask_p:  0.5
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.7049525816649105
ex_Confusion Metric: 
 [[2689  416   47  860  145  160   59]
 [  94 1795   49  112   47   23   19]
 [   3   21  255    0    1    1    3]
 [ 178  115   10 1359   85   18   16]
 [  56   82    3   73  159    3    8]
 [  11    7    3    7    2  134   14]
 [  12   11    2   12   10    2  299]]
np.mean(reliability_np):  0.5823477612250211
np.median(reliability_np):  0.5596970617771149
np.mean(c_reliability_np):  0.6116794221047507
np.median(c_reliability_np):  0.5991902351379395
np.mean(w_reliability_np):  0.4455310434688415
np.median(w_reliability_np):  0.41656528413295746
self.threshold:  0.5991902351379395
Accuracy:  0.8169652265542676
Confusion Metric: 
 [[3791  290    8  185   75   10   17]
 [ 214 1819    9   44   47    3    3]
 [   5   46  227    0    4    0    2]
 [ 331   49    2 1327   67    3    2]
 [ 106   45    0   25  202    1    5]
 [  47    7    1    2    4  108    9]
 [  42   17    0    3    4    3  279]]
Micro Precision/Recall/F-score:  (0.8169652265542676, 0.8169652265542676, 0.8169652265542676, None)
Macro Precision/Recall/F-score:  (0.8024090934826643, 0.7422291192226815, 0.7681262351606, None)


epoch 25/40
model.reset
self.reset_num:  25
self.cheat:  True
self.mask_p:  0.5
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.7141201264488936
ex_Confusion Metric: 
 [[2814  373   49  816  100  143   81]
 [ 113 1767   47  127   33   22   30]
 [   1   19  260    0    1    0    3]
 [ 200  109   12 1356   65   20   19]
 [  60   83    3   86  138    3   11]
 [  10    8    3    5    2  135   15]
 [  12   11    1   11    5    1  307]]
np.mean(reliability_np):  0.5864827675912945
np.median(reliability_np):  0.5646874904632568
np.mean(c_reliability_np):  0.613846833395082
np.median(c_reliability_np):  0.6044532060623169
np.mean(w_reliability_np):  0.4466062502649232
np.median(w_reliability_np):  0.41854503750801086
self.threshold:  0.6044532060623169
Accuracy:  0.7985247629083245
Confusion Metric: 
 [[3594  225    9  393  109   13   33]
 [ 214 1672   15   90  142    0    6]
 [   8   26  234    2   12    0    2]
 [ 221   25    0 1483   46    2    4]
 [  75   27    0   82  192    0    8]
 [  38    5    1    8    8  109    9]
 [  27    9    0    6   11    1  294]]
Micro Precision/Recall/F-score:  (0.7985247629083245, 0.7985247629083245, 0.7985247629083245, None)
Macro Precision/Recall/F-score:  (0.7700150990423635, 0.7452543910993523, 0.7518903208012092, None)


epoch 26/40
model.reset
self.reset_num:  26
self.cheat:  True
self.mask_p:  0.5
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.6956796628029505
ex_Confusion Metric: 
 [[2567  360   47 1064  137  115   86]
 [  89 1760   47  148   50   14   31]
 [   2   20  258    0    1    0    3]
 [ 148   94   10 1438   62   11   18]
 [  45   81    2   96  147    3   10]
 [  12    6    3    9    2  129   17]
 [  10   11    0   17    6    1  303]]
np.mean(reliability_np):  0.5871675658563299
np.median(reliability_np):  0.5660582482814789
np.mean(c_reliability_np):  0.6124619371089853
np.median(c_reliability_np):  0.6023776531219482
np.mean(w_reliability_np):  0.4565947518536919
np.median(w_reliability_np):  0.4271848648786545
self.threshold:  0.6023776531219482
Accuracy:  0.8025289778714436
Confusion Metric: 
 [[3548  383   20  352   28   20   25]
 [ 152 1880   29   59   12    2    5]
 [   2   22  257    0    1    0    2]
 [ 257   73    1 1414   31    2    3]
 [  89   91    0   74  122    2    6]
 [  36   10    2    5    3  115    7]
 [  33   22    2    7    2    2  280]]
Micro Precision/Recall/F-score:  (0.8025289778714436, 0.8025289778714436, 0.8025289778714435, None)
Macro Precision/Recall/F-score:  (0.7795377860554366, 0.7367057865351774, 0.748949799696905, None)


epoch 27/40
model.reset
self.reset_num:  27
self.cheat:  True
self.mask_p:  0.5
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.6963119072708114
ex_Confusion Metric: 
 [[2613  437   70  925   56  180   95]
 [  82 1794   75  119   13   22   34]
 [   1   15  264    0    1    0    3]
 [ 175  125   13 1388   40   19   21]
 [  54  108    5  100  102    3   12]
 [   9    5    3    5    2  138   16]
 [   7   13    2   12    3    2  309]]
np.mean(reliability_np):  0.5873601642038918
np.median(reliability_np):  0.5676263868808746
np.mean(c_reliability_np):  0.6128585911051485
np.median(c_reliability_np):  0.6028002798557281
np.mean(w_reliability_np):  0.45012226129967997
np.median(w_reliability_np):  0.42122194170951843
self.threshold:  0.6028002798557281
Accuracy:  0.7963119072708114
Confusion Metric: 
 [[3514  280   12  488   33   21   28]
 [ 206 1773   13  106   33    4    4]
 [   5   31  243    1    1    1    2]
 [ 200   44    2 1504   25    3    3]
 [  93   68    0   95  120    2    6]
 [  33    7    1    7    2  120    8]
 [  33   17    0   10    2    3  283]]
Micro Precision/Recall/F-score:  (0.7963119072708114, 0.7963119072708114, 0.7963119072708114, None)
Macro Precision/Recall/F-score:  (0.774010782454722, 0.7331267650283417, 0.7466012103378555, None)


epoch 28/40
model.reset
self.reset_num:  28
self.cheat:  True
self.mask_p:  0.5
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.6793466807165437
ex_Confusion Metric: 
 [[2432  392   48 1103   61  254   86]
 [  79 1752   60  165   20   27   36]
 [   1   17  261    0    1    1    3]
 [ 137   96   10 1452   44   20   22]
 [  53   93    3  114  104    5   12]
 [   9    6    3    5    2  139   14]
 [   7   10    0   17    2    5  307]]
np.mean(reliability_np):  0.583230625410311
np.median(reliability_np):  0.5600651204586029
np.mean(c_reliability_np):  0.6218328133690019
np.median(c_reliability_np):  0.6131493449211121
np.mean(w_reliability_np):  0.4658030223002216
np.median(w_reliability_np):  0.4323703944683075
self.threshold:  0.6131493449211121
Accuracy:  0.8047418335089568
Confusion Metric: 
 [[3713  245   21  302   35   30   30]
 [ 273 1690   55   66   42    7    6]
 [   7   11  261    2    0    1    2]
 [ 271   35    3 1437   28    4    3]
 [ 102   60    0   89  122    3    8]
 [  31    4    2    5    2  127    7]
 [  32   12    1    8    1    7  287]]
Micro Precision/Recall/F-score:  (0.8047418335089568, 0.8047418335089568, 0.8047418335089568, None)
Macro Precision/Recall/F-score:  (0.7500389737668913, 0.7457641273816746, 0.7428385848657998, None)


epoch 29/40
model.reset
self.reset_num:  29
self.cheat:  True
self.mask_p:  0.5
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.686722866174921
ex_Confusion Metric: 
 [[2524  409   70  973   66  250   84]
 [  84 1752   77  137   23   29   37]
 [   0   15  264    0    1    1    3]
 [ 153  111   12 1415   48   20   22]
 [  54   97    4   96  114    4   15]
 [  10    6    3    5    2  139   13]
 [   6   12    3   12    3    3  309]]
np.mean(reliability_np):  0.5838243911249418
np.median(reliability_np):  0.5596236884593964
np.mean(c_reliability_np):  0.6148959144261674
np.median(c_reliability_np):  0.6043286323547363
np.mean(w_reliability_np):  0.45767374781298387
np.median(w_reliability_np):  0.43163833022117615
self.threshold:  0.6043286323547363
Accuracy:  0.7796628029504742
Confusion Metric: 
 [[3263  377   19  612   43   32   30]
 [ 149 1842   26   91   22    4    5]
 [   5   28  245    3    1    0    2]
 [ 167   57    2 1531   18    3    3]
 [  65   85    0  112  111    1   10]
 [  24    9    2    9    2  125    7]
 [  26   16    1   14    3    6  282]]
Micro Precision/Recall/F-score:  (0.7796628029504742, 0.7796628029504742, 0.7796628029504742, None)
Macro Precision/Recall/F-score:  (0.7484267287121323, 0.7329668860026113, 0.7311893300635297, None)


epoch 30/40
model.reset
self.reset_num:  30
self.cheat:  True
self.mask_p:  0.5
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.6667017913593256
ex_Confusion Metric: 
 [[2255  452   59 1224   68  235   83]
 [  65 1769   61  166   16   28   34]
 [   1   17  261    0    1    1    3]
 [ 103  106    9 1492   34   18   19]
 [  46   98    3  115  103    5   14]
 [   8    6    3    7    2  138   14]
 [   6   12    2   15    2    2  309]]
np.mean(reliability_np):  0.5858966330147741
np.median(reliability_np):  0.564181387424469
np.mean(c_reliability_np):  0.6200939707489814
np.median(c_reliability_np):  0.6115676164627075
np.mean(w_reliability_np):  0.46566063974086824
np.median(w_reliability_np):  0.43704697489738464
self.threshold:  0.6115676164627075
Accuracy:  0.7984193888303477
Confusion Metric: 
 [[3572  212   10  511   36    5   30]
 [ 228 1740   16  105   42    2    6]
 [   9   32  233    4    3    0    3]
 [ 217   21    0 1511   25    2    5]
 [  79   50    0  125  122    1    7]
 [  44    5    2   12    2  101   12]
 [  25    9    0   14    2    0  298]]
Micro Precision/Recall/F-score:  (0.7984193888303477, 0.7984193888303477, 0.7984193888303478, None)
Macro Precision/Recall/F-score:  (0.7875536209379522, 0.7200004308172775, 0.7424384901855012, None)


epoch 31/40
model.reset
self.reset_num:  31
self.cheat:  True
self.mask_p:  0.5
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.6840885142255005
ex_Confusion Metric: 
 [[2475  337   50 1172   57  155  130]
 [  85 1714   53  195   19   22   51]
 [   3   20  257    0    1    0    3]
 [ 136   69    9 1495   34   11   27]
 [  54   73    4  124  102    6   21]
 [   9    5    3    9    2  129   21]
 [   3    9    0   12    2    2  320]]
np.mean(reliability_np):  0.5790803545865285
np.median(reliability_np):  0.5529966652393341
np.mean(c_reliability_np):  0.6077120078547421
np.median(c_reliability_np):  0.5893811881542206
np.mean(w_reliability_np):  0.45416640140379644
np.median(w_reliability_np):  0.42441052198410034
self.threshold:  0.5893811881542206
Accuracy:  0.7979978925184404
Confusion Metric: 
 [[3583  261    8  449   38   16   21]
 [ 225 1775    9  105   18    4    3]
 [  10   54  213    4    1    0    2]
 [ 229   28    0 1500   18    3    3]
 [  97   63    0  117  103    0    4]
 [  35    6    1    7    2  120    7]
 [  37   14    0   13    2    3  279]]
Micro Precision/Recall/F-score:  (0.7979978925184404, 0.7979978925184404, 0.7979978925184404, None)
Macro Precision/Recall/F-score:  (0.7891740775742236, 0.7121350539687729, 0.7392850976632417, None)


epoch 32/40
model.reset
self.reset_num:  32
self.cheat:  True
self.mask_p:  0.5
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.6961011591148577
ex_Confusion Metric: 
 [[2629  330   41 1051   75  157   93]
 [  97 1723   45  170   33   26   45]
 [   2   19  259    0    1    0    3]
 [ 178   81   10 1431   43   18   20]
 [  57   71    2  111  123    5   15]
 [  13    5    2    5    2  134   17]
 [   8    7    0   18    6    2  307]]
np.mean(reliability_np):  0.5678049925795016
np.median(reliability_np):  0.5400335490703583
np.mean(c_reliability_np):  0.5973425249989525
np.median(c_reliability_np):  0.5811399817466736
np.mean(w_reliability_np):  0.44401285085367265
np.median(w_reliability_np):  0.4187089651823044
self.threshold:  0.5811399817466736
Accuracy:  0.801159114857745
Confusion Metric: 
 [[3598  300   11  371   51   26   19]
 [ 226 1778   17   77   34    5    2]
 [   6   37  238    1    0    0    2]
 [ 245   35    1 1469   24    4    3]
 [  90   69    0   95  125    0    5]
 [  26   10    1    8    2  125    6]
 [  31   24    0   18    3    2  270]]
Micro Precision/Recall/F-score:  (0.801159114857745, 0.801159114857745, 0.8011591148577449, None)
Macro Precision/Recall/F-score:  (0.7748542805815514, 0.7314167704147055, 0.7484324621613483, None)


epoch 33/40
model.reset
self.reset_num:  33
self.cheat:  True
self.mask_p:  0.5
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.6829293993677555
ex_Confusion Metric: 
 [[2483  377   56  983   76  314   87]
 [  82 1762   57  136   26   38   38]
 [   1   18  260    0    1    1    3]
 [ 165   97   12 1404   47   34   22]
 [  58   78    4  100  126    5   13]
 [   8    4    3    6    2  141   14]
 [   7   10    1   14    6    5  305]]
np.mean(reliability_np):  0.56761127548957
np.median(reliability_np):  0.5398560464382172
np.mean(c_reliability_np):  0.5968427342583856
np.median(c_reliability_np):  0.5811095237731934
np.mean(w_reliability_np):  0.44208332721915267
np.median(w_reliability_np):  0.4146096408367157
self.threshold:  0.5811095237731934
Accuracy:  0.8056902002107481
Confusion Metric: 
 [[3657  350   10  246   56   26   31]
 [ 194 1824   22   48   37    7    7]
 [   4   35  243    0    0    0    2]
 [ 313   50    1 1354   54    4    5]
 [  93   79    1   48  153    2    8]
 [  33    8    1    2    4  124    6]
 [  24   16    1    7    2    7  291]]
Micro Precision/Recall/F-score:  (0.8056902002107481, 0.8056902002107481, 0.8056902002107481, None)
Macro Precision/Recall/F-score:  (0.7635842531535122, 0.7479405837550627, 0.7545347830225296, None)


epoch 34/40
model.reset
self.reset_num:  34
self.cheat:  True
self.mask_p:  0.5
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.6776606954689146
ex_Confusion Metric: 
 [[2424  399   70  963   92  309  119]
 [  68 1768   63  125   31   38   46]
 [   0   15  264    0    1    1    3]
 [ 155  103   13 1394   54   33   29]
 [  53   85    4   95  123    7   17]
 [   4    4    3    6    2  142   17]
 [   3    8    1    9    5    6  316]]
np.mean(reliability_np):  0.5634585730359548
np.median(reliability_np):  0.5347131192684174
np.mean(c_reliability_np):  0.5931782548506548
np.median(c_reliability_np):  0.5749823451042175
np.mean(w_reliability_np):  0.4342765636150258
np.median(w_reliability_np):  0.40498822927474976
self.threshold:  0.5749823451042175
Accuracy:  0.8079030558482613
Confusion Metric: 
 [[3644  314   12  322   51   21   12]
 [ 179 1810   23   75   48    2    2]
 [   6   35  238    2    1    0    2]
 [ 228   49    1 1459   39    3    2]
 [  98   61    0   73  147    2    3]
 [  40    6    1    7    3  115    6]
 [  45   28    0    9    3    9  254]]
Micro Precision/Recall/F-score:  (0.8079030558482613, 0.8079030558482613, 0.8079030558482613, None)
Macro Precision/Recall/F-score:  (0.774870869121278, 0.7278442277805909, 0.7477963383259251, None)


epoch 35/40
model.reset
self.reset_num:  35
self.cheat:  True
self.mask_p:  0.5
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.6939936775553214
ex_Confusion Metric: 
 [[2591  371   49  961   96  227   81]
 [  90 1757   50  143   30   34   35]
 [   1   19  259    0    1    1    3]
 [ 172  104    9 1397   54   24   21]
 [  56   75    4  101  133    5   10]
 [   7    6    2    4    2  141   16]
 [   5   10    0   15    7    3  308]]
np.mean(reliability_np):  0.5601601696171888
np.median(reliability_np):  0.5303173363208771
np.mean(c_reliability_np):  0.5896491589374793
np.median(c_reliability_np):  0.5707476437091827
np.mean(w_reliability_np):  0.4323109639526317
np.median(w_reliability_np):  0.4050978571176529
self.threshold:  0.5707476437091827
Accuracy:  0.8087460484720759
Confusion Metric: 
 [[3841  252   11  221   22   14   15]
 [ 284 1742   19   60   28    3    3]
 [   8   32  240    2    0    0    2]
 [ 349   37    1 1360   29    3    2]
 [ 123   66    0   85  105    0    5]
 [  44    9    1    4    2  110    8]
 [  47   11    1    6    2    4  277]]
Micro Precision/Recall/F-score:  (0.8087460484720759, 0.8087460484720759, 0.8087460484720759, None)
Macro Precision/Recall/F-score:  (0.7939137032018689, 0.7126028415073298, 0.743663228880964, None)


epoch 36/40
model.reset
self.reset_num:  36
self.cheat:  True
self.mask_p:  0.5
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.6932560590094836
ex_Confusion Metric: 
 [[2599  324   49  992   89  239   84]
 [ 105 1715   65  145   36   35   38]
 [   1   17  261    0    1    1    3]
 [ 161   94   10 1413   59   21   23]
 [  53   73    4   95  141    5   13]
 [   8    4    3    6    2  140   15]
 [   8    5    1   11    8    5  310]]
np.mean(reliability_np):  0.5623663237449256
np.median(reliability_np):  0.536125659942627
np.mean(c_reliability_np):  0.5859124367111884
np.median(c_reliability_np):  0.5645896196365356
np.mean(w_reliability_np):  0.43308881540472094
np.median(w_reliability_np):  0.4108007550239563
self.threshold:  0.5645896196365356
Accuracy:  0.812118018967334
Confusion Metric: 
 [[3837  198   12  273   24   13   19]
 [ 308 1656   22  105   43    1    4]
 [  10   40  232    0    0    0    2]
 [ 242   22    1 1486   23    2    5]
 [ 129   57    0   87  106    1    4]
 [  45    7    1    5    2  112    6]
 [  43   17    1    2    4    3  278]]
Micro Precision/Recall/F-score:  (0.812118018967334, 0.812118018967334, 0.812118018967334, None)
Macro Precision/Recall/F-score:  (0.7899551041390694, 0.7151987932146391, 0.7439290939979626, None)


epoch 37/40
model.reset
self.reset_num:  37
self.cheat:  True
self.mask_p:  0.5
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.6946259220231823
ex_Confusion Metric: 
 [[2625  389   50  926   77  200  109]
 [  98 1754   57  139   22   25   44]
 [   2   17  260    0    1    0    4]
 [ 181  111   10 1378   50   24   27]
 [  55   85    3  104  122    4   11]
 [   5    7    3    5    2  139   17]
 [  11    6    1    7    7    2  314]]
np.mean(reliability_np):  0.5600937331138656
np.median(reliability_np):  0.5330784618854523
np.mean(c_reliability_np):  0.5923936151926523
np.median(c_reliability_np):  0.5750982463359833
np.mean(w_reliability_np):  0.43445398239451
np.median(w_reliability_np):  0.40565645694732666
self.threshold:  0.5750982463359833
Accuracy:  0.8044257112750264
Confusion Metric: 
 [[3729  285   10  282   28   17   25]
 [ 243 1798   20   55   18    3    2]
 [   8   30  243    0    0    1    2]
 [ 311   62    1 1365   37    3    2]
 [  98   90    0   73  120    1    2]
 [  36    9    1    5    2  118    7]
 [  40   28    0   15    1    3  261]]
Micro Precision/Recall/F-score:  (0.8044257112750264, 0.8044257112750264, 0.8044257112750264, None)
Macro Precision/Recall/F-score:  (0.7883082074939339, 0.7200294713399179, 0.7465169717365805, None)


epoch 38/40
model.reset
self.reset_num:  38
self.cheat:  True
self.mask_p:  0.5
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.6856691253951528
ex_Confusion Metric: 
 [[2466  454   54  991   57  265   89]
 [  70 1806   70  117   12   29   35]
 [   0   17  262    0    1    1    3]
 [ 153  127   10 1411   36   23   21]
 [  49   94    5  102  115    8   11]
 [   5    5    3    7    2  140   16]
 [   6   11    0   15    3    6  307]]
np.mean(reliability_np):  0.5616488650778637
np.median(reliability_np):  0.5322571098804474
np.mean(c_reliability_np):  0.5959022598885273
np.median(c_reliability_np):  0.5785034894943237
np.mean(w_reliability_np):  0.4421720720959957
np.median(w_reliability_np):  0.41545525193214417
self.threshold:  0.5785034894943237
Accuracy:  0.8070600632244468
Confusion Metric: 
 [[3746  301   14  236   26   20   33]
 [ 219 1818   19   47   29    1    6]
 [  11   31  238    1    0    1    2]
 [ 314   63    1 1344   51    3    5]
 [ 119   86    1   56  116    2    4]
 [  38   12    1    5    2  114    6]
 [  31   23    1    4    3    3  283]]
Micro Precision/Recall/F-score:  (0.8070600632244468, 0.8070600632244468, 0.8070600632244467, None)
Macro Precision/Recall/F-score:  (0.7731791745093556, 0.7220534772822866, 0.7422812487384297, None)


epoch 39/40
model.reset
self.reset_num:  39
self.cheat:  True
self.mask_p:  0.5
self.valid_flag:  True
self.BiLSTM_1_require_grad:  True
ex_acc:  0.6917808219178082
ex_Confusion Metric: 
 [[2505  409   55 1058   44  208   97]
 [  82 1804   62  119   10   21   41]
 [   0   19  260    0    1    1    3]
 [ 140  110   11 1452   32   16   20]
 [  54   95    5  114   97    7   12]
 [   8    5    3    6    2  138   16]
 [   5   14    2   12    2    4  309]]
np.mean(reliability_np):  0.5645927719637601
np.median(reliability_np):  0.5365435481071472
np.mean(c_reliability_np):  0.5996349349220745
np.median(c_reliability_np):  0.5861952304840088
np.mean(w_reliability_np):  0.4480108146025584
np.median(w_reliability_np):  0.4221802353858948
self.threshold:  0.5861952304840088
Accuracy:  0.8076923076923077
Confusion Metric: 
 [[3674  319   10  264   47   27   35]
 [ 205 1822   13   51   39    3    6]
 [   7   34  239    0    0    2    2]
 [ 281   64    2 1360   63    4    7]
 [  95   74    1   44  161    2    7]
 [  33   10    1    3    2  122    7]
 [  28   23    1    4    2    3  287]]
Micro Precision/Recall/F-score:  (0.8076923076923077, 0.8076923076923077, 0.8076923076923077, None)
Macro Precision/Recall/F-score:  (0.769780413542537, 0.7465602012127491, 0.7569028315114783, None)
best_epoch:  4 0.8011880472916563 0.8418335089567967


test print 
Accuracy:  0.7739536056480081
Confusion Metric: 
 [[2910  284    8  218   50   31   39]
 [ 182 1445   17   39   28    9   13]
 [  12   81  224    1    1    3    1]
 [ 308   80    2 1131   36    5   15]
 [  93   74    2   32  100    5   10]
 [  48    9    1    3    0  135   11]
 [  20    4    0    9    3    6  194]]
Micro Precision/Recall/F-score:  (0.7739536056480081, 0.7739536056480081, 0.7739536056480081, None)
Macro Precision/Recall/F-score:  (0.7223706269859697, 0.693884940070013, 0.7029372561533261, None)
test f1:   0.7029372561533261 [0.7029372561533261]
test ass:  0.7739536056480081 [0.7739536056480081]
valid f1:  0.8011880472916563 [0.8011880472916563]
valid acc: 0.8418335089567967 [0.8418335089567967]
